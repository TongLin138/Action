var c=(p,i,n)=>new Promise((u,e)=>{var d=r=>{try{o(n.next(r))}catch(a){e(a)}},l=r=>{try{o(n.throw(r))}catch(a){e(a)}},o=r=>r.done?u(r.value):Promise.resolve(r.value).then(d,l);o((n=n.apply(p,i)).next())});import{u as w,_ as f}from"./useForm-iP7AqTJg.js";import{y as _,c as y,a as P,O as h}from"./index-YWZYq8iG.js";import{G as b,h as v,aL as I,a6 as N,aI as q,M as E,as as k,a9 as B,u as S}from"./vendor-tP7MJkVm.js";const V={class:"grid grid-cols-1 grid-flow-row-dense md:grid-cols-[450px_1fr] gap-4"},D=b({__name:"PasswordChange",setup(p){const i=_(),n=v(()=>i.getUserInfo),{message:u}=y(),{t:e}=P(),d=[{field:"username",component:"NInput",label:e("setting.identity.username"),required:!0,componentProps:{placeholder:e("setting.identity.placeholder.userName")},defaultValue:n.value.username,rules:[{required:!0,validator(t,s){return s?!0:new Error(e("setting.identity.error.userNameEmpty"))},trigger:["input","blur"]}]},{field:"password",component:"NInput",label:e("setting.identity.newPassword"),required:!0,componentProps:{placeholder:e("setting.identity.placeholder.newPassword"),type:"password",showPasswordOn:"click"},rules:[{required:!0,validator(t,s){return s?!0:new Error(e("setting.identity.error.newPasswordEmpty"))},trigger:["input","blur"]}]},{field:"confirmPassword",component:"NInput",label:e("setting.identity.confirmnewPassword"),required:!0,componentProps:{type:"password",placeholder:e("setting.identity.placeholder.confirmnewPassword"),showPasswordOn:"click"},rules:[{required:!0,validator(t,s){return r().password!==s?new Error(e("setting.identity.error.confirmnewPasswordDiff")):!0},trigger:["input","blur"]}]}],[l,{setFieldsValue:o,getFieldsValue:r,validate:a}]=w({schemas:d,labelPlacement:"top",gridProps:{cols:3,xGap:6},giProps:{span:2},submitButtonText:e("setting.identity.button.confirm")}),m=t=>c(this,null,function*(){yield a(),yield h({username:t.username,password:t.password}),u.warning(e("setting.identity.message.msgOk"));try{setTimeout(()=>{i.logout(!0)},2e3)}catch(s){}});return I(()=>c(this,null,function*(){o({})})),(t,s)=>{const g=f;return N(),q("div",null,[E(t.$slots,"title"),k("div",V,[B(g,{onRegister:S(l),onSubmit:m},null,8,["onRegister"])])])}}});export{D as _};
