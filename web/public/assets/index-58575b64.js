import{a6 as g,aH as Z,as as L,G as _e,x as s,C as G,aL as fe,aM as me,a7 as k,at as ge,u as e,a8 as t,a9 as n,aD as z,aB as u,ax as ve,aN as H,aI as V,aJ as J,al as _,aO as he,aC as ye,bs as be,bt as we,am as xe,aP as ke,aQ as ze,aR as Ce,aS as Se,aK as $e}from"./vendor-339b2486.js";import{_ as Be}from"./PageWrapper.vue_vue_type_style_index_0_lang-ebcdd68c.js";import{a as De,c as Ne,L as Pe}from"./index-b98e63e9.js";import{_ as Ve,a as Ie,b as Ee,c as Oe}from"./index.vue_vue_type_style_index_0_lang-f5024cf5.js";import{_ as Te,f as He}from"./folderDisable-3ec899af.js";import{_ as Le,f as Me}from"./filePrefix-033be9bb.js";import{_ as Fe}from"./swap-outlined-206b9abd.js";import{u as Ue}from"./useAppInject-25d4ad8f.js";import{u as We}from"./useTransition-0172c80f.js";import{s as je,g as K,a as Re}from"./file-1f2fda02.js";import{f as Q,a as Ae,b as qe}from"./index-02fa18bb.js";import"./sharp-arrow-back-ios-59e3289b.js";import"./useDesign-d1f0a28d.js";import"./propTypes-8a448afd.js";const Ge={style:{display:"inline-block"},viewBox:"0 0 2048 2048",width:"1em",height:"1em"},Je=L("path",{fill:"currentColor",d:"M1792 0v2048H256V0h1536zM384 128v384h1280V128H384zm1280 1408H384v384h1280v-384zm0-256V640H384v640h1280z"},null,-1),Ke=[Je];function Qe(M,f){return g(),Z("svg",Ge,[...Ke])}const Ze={name:"fluent-mdl2-diff-inline",render:Qe},Xe={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"},Ye=L("path",{fill:"currentColor",d:"M10 18H6v-2h4v2m0-4H6v-2h4v2m0-13v1H6c-1.11 0-2 .89-2 2v16a2 2 0 0 0 2 2h4v1h2V1h-2m10 7v12c0 1.11-.89 2-2 2h-4v-2h4v-9h-4V9h4.5L14 4.5V2l6 6m-4 6h-2v-2h2v2m0 4h-2v-2h2v2Z"},null,-1),en=[Ye];function nn(M,f){return g(),Z("svg",Xe,[...en])}const tn={name:"mdi-file-compare",render:nn},hn=_e({__name:"index",setup(M){const{getIsMobile:f}=Ue(),{t:c}=De(),{message:F}=Ne(),U=s("fade-slide");We(U);const y=s(),I=s([]),E=s([]),W=s({}),C=s({content:"",language:""}),b=s(""),S=s(!f.value),$=s(f.value?13:15),B=s(f.value?"on":"off"),p=s(""),m=s(""),O=s(!1),T=s(!1),v=s(!1),h=s(!1),D=async o=>{switch(o){case"showEditorShortcutsInfo":y.value.showShortCuts();break;case"wordWrap":B.value=B.value==="on"?"off":"on",h.value=!1;break;case"renderSideBySide":S.value=!S.value,h.value=!1;break;case"save":O.value=!0;const a=e(y).getValue();try{await je({content:a,path:p.value}),F.success(c("editor.main.savedSuccess"))}finally{O.value=!1}break}},X=async()=>{v.value=!0;const o=await K({}),a=j(o);I.value=a;const l=await K({}),i=j(l);E.value=i,v.value=!1},j=o=>{const a=l=>{l.length&&l.forEach(i=>{if(i.type===0)Object.assign(i,{key:i.path,label:i.title,disabled:!0,prefix:()=>_(u,null,{default:()=>_(Q)})}),a(i.children),i.children.length||(Object.assign(i,{children:null,disabled:!0}),i.prefix=()=>_(u,null,{default:()=>_(He)}));else{const d=i.name;if(d){const P=d.substring(d.lastIndexOf(".")+1),w=qe[P]||{};Object.assign(i,{key:i.path,label:d,language:w.language||"plaintext",disabled:w.disabled||!1,prefix:()=>_(u,null,{default:()=>_(w.icon||Me)})})}}})};return a(o),o},N=(o,a,l)=>{if(l.node)switch(l.action){case"expand":l.node.prefix=()=>_(u,null,{default:()=>_(Ae)});break;case"collapse":l.node.prefix=()=>_(u,null,{default:()=>_(Q)});break}},R=async(o,a)=>{T.value=!0;const l=await Re({path:encodeURI(o.key)});if(l)switch(a){case"config":C.value={content:l,language:o.language};break;case"sample":b.value=l;break}else{switch(a){case"config":break;case"sample":b.value="";break}F.info(c("page.diff.fileContentIsEmptyMsg"))}T.value=!1},A=({option:o})=>({async onClick(){!o.children&&!o.disabled&&(W.value=o,await R(o,"config"))}}),q=({option:o})=>({async onClick(){!o.children&&!o.disabled&&(W.value=o,await R(o,"sample"))}});return G(p,o=>{o||(C.value={content:"",language:""})}),G(m,o=>{o||(b.value="")}),fe(async()=>{await X()}),me(()=>{y.value&&y.value.dispose()}),(o,a)=>{const l=he,i=tn,d=ye,P=be,w=we,Y=Ie,x=xe,ee=Ee,ne=ke,te=Fe,ae=Ze,oe=ze,le=Le,se=Ce,ie=Te,re=Oe,ce=Se,de=Pe,ue=$e,pe=Be;return g(),k(pe,{ref:"pageWrapper","content-full":!0,title:e(c)("routes.main.page.diff")},ge({extra:t(()=>[e(p)&&e(m)?(g(),k(ve,{key:0,name:e(U),mode:"out-in",appear:""},{default:t(()=>[n(d,null,{default:t(()=>[n(d,{style:{gap:"0"}},{default:t(()=>[n(oe,{trigger:"manual",style:{padding:"8px"},show:e(h),"show-arrow":!1,placement:"bottom"},{trigger:t(()=>[n(x,{strong:"",quaternary:"",size:"small",type:e(h)?"primary":"tertiary",style:{padding:"6px"},focusable:!1,onClick:a[4]||(a[4]=r=>h.value=!e(h))},{default:t(()=>[n(e(u),{size:"18"},{default:t(()=>[n(Y,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1},8,["type"])]),default:t(()=>[n(d,{vertical:""},{default:t(()=>[n(d,{size:"small"},{default:t(()=>[n(e(u),{size:20},{default:t(()=>[n(ee,{style:{"vertical-align":"-0.4em"}})]),_:1}),n(ne,{value:e($),"onUpdate:value":a[5]||(a[5]=r=>z($)?$.value=r:null),min:12,max:40,"button-placement":"both",size:"small",class:"max-w-94px",style:{"text-align":"center"}},null,8,["value"])]),_:1}),n(d,{size:"small"},{default:t(()=>[n(e(u),{size:20,color:e(B)==="on"?"var(--app-primary-color)":void 0},{default:t(()=>[n(te,{style:{"vertical-align":"-0.4em"}})]),_:1},8,["color"]),n(x,{strong:"",secondary:"",size:"small",style:{width:"94px"},onClick:a[6]||(a[6]=r=>D("wordWrap"))},{default:t(()=>[H(V(e(c)("editor.switch.wordWrapBtn")),1)]),_:1})]),_:1}),n(d,{size:"small"},{default:t(()=>[n(e(u),{size:20,color:e(S)?void 0:"var(--app-primary-color)"},{default:t(()=>[n(ae,{style:{"vertical-align":"-0.4em"}})]),_:1},8,["color"]),n(x,{strong:"",secondary:"",size:"small",style:{width:"94px"},onClick:a[7]||(a[7]=r=>D("renderSideBySide"))},{default:t(()=>[H(V(e(c)("editor.switch.inlineModeTips")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["show"]),e(f)?J("",!0):(g(),k(se,{key:0,placement:"bottom",trigger:"hover",delay:500},{trigger:t(()=>[n(x,{strong:"",quaternary:"",size:"small",type:"tertiary",style:{padding:"6px"},focusable:!1,onClick:a[8]||(a[8]=r=>D("showEditorShortcutsInfo"))},{default:t(()=>[n(e(u),{size:"18"},{default:t(()=>[n(le,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1})]),default:t(()=>[L("span",null,V(e(c)("editor.switch.shortcutsTips")),1)]),_:1}))]),_:1}),n(x,{strong:"",type:"primary",size:"small",disabled:!e(p),loading:e(O),focusable:!1,onClick:a[9]||(a[9]=r=>D("save"))},{icon:t(()=>[n(ie)]),default:t(()=>[H(" "+V(e(c)("editor.main.saveButton")),1)]),_:1},8,["disabled","loading"])]),_:1})]),_:1},8,["name"])):J("",!0)]),default:t(()=>[n(ue,{bordered:!e(f),style:{height:"100%","word-break":"unset"},"content-style":"padding: 0"},{default:t(()=>[e(C).content||e(b)?(g(),k(Ve,{key:0,ref_key:"editor",ref:y,value:e(C),"origin-value":e(b),"diff-mode":!0,"word-wrap":e(B),"render-side-by-side":e(S),"font-size":e($)},null,8,["value","origin-value","word-wrap","render-side-by-side","font-size"])):(g(),k(ce,{key:1,class:"min-h-200px flex-jc-ac h-full",size:"huge",description:e(c)("common.selectFileEmptyDesc")},{icon:t(()=>[n(e(u),null,{default:t(()=>[n(re)]),_:1})]),_:1},8,["description"])),n(de,{show:e(T)},null,8,["show"])]),_:1},8,["bordered"])]),_:2},[e(f)?{name:"headerContent",fn:t(()=>[n(w,{"x-gap":12,cols:2},{default:t(()=>[n(P,null,{default:t(()=>[n(l,{value:e(m),"onUpdate:value":a[2]||(a[2]=r=>z(m)?m.value=r:null),size:"small",loading:e(v),"consistent-menu-width":!1,clearable:"",placement:"bottom-start",placeholder:e(c)("page.diff.selectSourceFilePlaceholder"),options:e(E),"node-props":q,"on-update:expanded-keys":N},null,8,["value","loading","placeholder","options"])]),_:1}),n(P,null,{default:t(()=>[n(l,{value:e(p),"onUpdate:value":a[3]||(a[3]=r=>z(p)?p.value=r:null),size:"small",loading:e(v),"consistent-menu-width":!1,clearable:"",placement:"bottom-end",placeholder:e(c)("page.diff.selectDestinationFilePlaceholder"),options:e(I),"node-props":A,"on-update:expanded-keys":N},null,8,["value","loading","placeholder","options"])]),_:1})]),_:1})]),key:"1"}:{name:"subtitle",fn:t(()=>[n(d,null,{default:t(()=>[n(l,{value:e(m),"onUpdate:value":a[0]||(a[0]=r=>z(m)?m.value=r:null),size:"small",style:{"min-width":"200px",width:"fit-content"},"show-path":"",loading:e(v),"consistent-menu-width":!1,clearable:"",placeholder:e(c)("page.diff.selectSourceFilePlaceholder"),options:e(E),"node-props":q,"on-update:expanded-keys":N},null,8,["value","loading","placeholder","options"]),n(e(u),{size:"24",depth:3},{default:t(()=>[n(i)]),_:1}),n(l,{value:e(p),"onUpdate:value":a[1]||(a[1]=r=>z(p)?p.value=r:null),size:"small",style:{"min-width":"200px",width:"fit-content"},"show-path":"",loading:e(v),"consistent-menu-width":!1,clearable:"",placeholder:e(c)("page.diff.selectDestinationFilePlaceholder"),options:e(I),"node-props":A,"on-update:expanded-keys":N},null,8,["value","loading","placeholder","options"])]),_:1})]),key:"0"}]),1032,["title"])}}});export{hn as default};
