import{_ as J,a as O}from"./zoom-out-line-0b17d5aa.js";import{c as P,_ as Q}from"./index-8f9a70dd.js";import{_ as q}from"./history-96443e50.js";import{c as K,a as W}from"./index-19149e19.js";import{u as X}from"./useAppInject-44f70e5f.js";import{j as Y,a as Z}from"./file-6440000a.js";import S from"./loading-2b111951.js";import{G as ee,x as T,r as oe,I as ne,u as n,a6 as s,a7 as l,a8 as e,a9 as o,aM as z,aI as r,as as y,aJ as F,aH as V,aD as L,aB as te,am as ae,aQ as se,bp as le,aC as re,bG as ie,bd as ce,bu as _e,by as ge,c5 as pe,c6 as ue}from"./vendor-3ca7b8d8.js";const fe={key:1},de={style:{"vertical-align":"-4px"}},me={key:1},Me=ee({__name:"historyModal",setup(ye,{expose:j}){const{message:k}=K(),{t:a}=W(),{getIsMobile:B}=X(),I=T(null),p=T(B.value?13:15),f=oe({show:!1,loading:!0,log:""}),{show:d,loading:h,log:v}=ne(f),A=async m=>{f.log="",f.loading=!0,f.show=!0;try{f.log=await G(m.logPath,m.running_status)}finally{f.loading=!1}},G=async(m,t)=>{const _=await Y({path:m});if(_.children&&_.children.length){_.children.sort((g,u)=>{const b=g.name.replace(".log","").replace(/-/g,"");return u.name.replace(".log","").replace(/-/g,"")-b});const i=t&&_.children[1]?_.children[1]:_.children[0];return await Z({path:i.path})}return k.warning(a("page.cron.historyModal.noLatestMsg")),""},w=async m=>{switch(m){case"copyContent":P(f.log)?k.success(a("common.copyOk")):k.error(a("common.copyFail"));break;case"enlarge":p.value<20?p.value+=1:p.value===20&&k.info(a("page.log.enlargeMaxMsg"));break;case"narrow":p.value>12?p.value-=1:p.value===12&&k.info(a("page.log.narrowMinMsg"));break}};return j({open:A}),(m,t)=>{const _=q,i=te,x=Q,g=ae,u=se,b=J,C=O,N=le,M=re,$=ie,D=ce,R=_e,U=ge,E=pe,H=ue;return n(B)?(s(),l(H,{key:1,show:n(d),"onUpdate:show":t[8]||(t[8]=c=>L(d)?d.value=c:null),height:"100vh",width:"100vw",placement:"right","auto-focus":!1,"mask-closable":!1},{default:e(()=>[o(E,{closable:"","header-style":"height: 60px; padding: 16px 12px","body-content-style":"padding: 4px 8px; overscroll-behavior: none","footer-style":"padding: 16px 24px"},{header:e(()=>[o(M,null,{default:e(()=>[o(i,{size:24,color:"var(--app-primary-color)"},{default:e(()=>[n(h)?(s(),l(S,{key:0,style:{"font-size":"24"}})):(s(),l(_,{key:1,style:{"font-size":"26","vertical-align":"0"}}))]),_:1}),y("span",de,r(n(a)("page.cron.table.history")),1),!n(h)&&n(v)?(s(),l(N,{key:0},{default:e(()=>[o(u,{"show-arrow":!1,trigger:"hover"},{trigger:e(()=>[o(g,{strong:"",secondary:"",size:"small",focusable:!1,onClick:t[4]||(t[4]=c=>w("copyContent"))},{icon:e(()=>[o(i,{size:16},{default:e(()=>[o(x,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1})]),default:e(()=>[y("span",null,r(n(a)("page.cron.historyModal.copyBtn")),1)]),_:1}),o(u,{"show-arrow":!1,trigger:"hover"},{trigger:e(()=>[o(g,{strong:"",secondary:"",size:"small",focusable:!1,onClick:t[5]||(t[5]=c=>w("narrow"))},{icon:e(()=>[o(i,{size:18},{default:e(()=>[o(b,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1})]),default:e(()=>[y("span",null,r(n(a)("page.cron.historyModal.narrowButtonTips")),1)]),_:1}),o(u,{"show-arrow":!1,trigger:"hover"},{trigger:e(()=>[o(g,{strong:"",secondary:"",size:"small",focusable:!1,onClick:t[6]||(t[6]=c=>w("enlarge"))},{icon:e(()=>[o(i,{size:18},{default:e(()=>[o(C,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1})]),default:e(()=>[y("span",null,r(n(a)("page.cron.historyModal.enlargeButtonTips")),1)]),_:1})]),_:1})):F("",!0)]),_:1})]),footer:e(()=>[o(M,null,{default:e(()=>[o(g,{type:"primary",focusable:!1,onClick:t[7]||(t[7]=c=>d.value=!1)},{default:e(()=>[z(r(n(a)("component.modal.close")),1)]),_:1})]),_:1})]),default:e(()=>[n(h)?(s(),l($,{key:0,text:"",repeat:30,height:"16px"})):(s(),V("div",me,[n(v)?(s(),l(R,{key:1,ref_key:"logInstRef",ref:I,log:n(v),"line-height":1.5,"font-size":n(p),language:"naive-log",style:{width:"100%",height:"100%"}},null,8,["log","line-height","font-size"])):(s(),l(D,{key:0},{default:e(()=>[z(r(n(a)("common.noData")),1)]),_:1}))]))]),_:1})]),_:1},8,["show"])):(s(),l(U,{key:0,show:n(d),"onUpdate:show":t[3]||(t[3]=c=>L(d)?d.value=c:null),preset:"dialog","auto-focus":!1,style:{width:"600px"}},{icon:e(()=>[o(i,null,{default:e(()=>[n(h)?(s(),l(S,{key:0})):(s(),l(_,{key:1,style:{"vertical-align":"0"}}))]),_:1})]),header:e(()=>[o(M,null,{default:e(()=>[z(r(n(a)("page.cron.table.history"))+" ",1),!n(h)&&n(v)?(s(),l(N,{key:0},{default:e(()=>[o(u,{"show-arrow":!1,trigger:"hover"},{trigger:e(()=>[o(g,{strong:"",secondary:"",size:"small",focusable:!1,onClick:t[0]||(t[0]=c=>w("copyContent"))},{icon:e(()=>[o(i,{size:16},{default:e(()=>[o(x,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1})]),default:e(()=>[y("span",null,r(n(a)("page.cron.historyModal.copyBtn")),1)]),_:1}),o(u,{"show-arrow":!1,trigger:"hover"},{trigger:e(()=>[o(g,{strong:"",secondary:"",size:"small",focusable:!1,onClick:t[1]||(t[1]=c=>w("narrow"))},{icon:e(()=>[o(i,{size:18},{default:e(()=>[o(b,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1})]),default:e(()=>[y("span",null,r(n(a)("page.cron.historyModal.narrowButtonTips")),1)]),_:1}),o(u,{"show-arrow":!1,trigger:"hover"},{trigger:e(()=>[o(g,{strong:"",secondary:"",size:"small",focusable:!1,onClick:t[2]||(t[2]=c=>w("enlarge"))},{icon:e(()=>[o(i,{size:18},{default:e(()=>[o(C,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1})]),default:e(()=>[y("span",null,r(n(a)("page.cron.historyModal.enlargeButtonTips")),1)]),_:1})]),_:1})):F("",!0)]),_:1})]),default:e(()=>[n(h)?(s(),l($,{key:0,text:"",repeat:27,height:"16px"})):(s(),V("div",fe,[n(v)?(s(),l(R,{key:1,ref_key:"logInstRef",ref:I,log:n(v),"line-height":1.5,"font-size":n(p),language:"naive-log",style:{"padding-top":"1em",width:"100%",height:"600px"}},null,8,["log","line-height","font-size"])):(s(),l(D,{key:0},{default:e(()=>[z(r(n(a)("common.noData")),1)]),_:1}))]))]),_:1},8,["show"]))}}});export{Me as _};
