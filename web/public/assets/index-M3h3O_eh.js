var w=(V,u,i)=>new Promise((I,C)=>{var h=p=>{try{y(i.next(p))}catch(m){C(m)}},S=p=>{try{y(i.throw(p))}catch(m){C(m)}},y=p=>p.done?I(p.value):Promise.resolve(p.value).then(h,S);y((i=i.apply(V,u)).next())});import{a6 as x,aI as Y,as as R,G as fe,x as r,C as K,aL as me,aM as ge,a7 as N,at as ve,u as e,a8 as t,a9 as n,aD as P,aB as d,ax as he,aN as j,aH as L,aJ as Q,al as f,aO as ye,aC as be,bq as we,br as xe,am as ke,aP as ze,aQ as Ce,aR as Se,aS as $e,aK as Be}from"./vendor-tP7MJkVm.js";import{_ as De}from"./PageWrapper.vue_vue_type_style_index_0_lang-_BQo_egP.js";import{a as Ne,c as Pe,L as Ve}from"./index-YWZYq8iG.js";import{_ as Ie,a as Ee,b as Oe,c as Te}from"./index.vue_vue_type_style_index_0_lang-DnSf_MPB.js";import{_ as Fe,f as He}from"./folderDisable-zmQ32rSn.js";import{_ as Le,f as Me}from"./filePrefix-MOkS9-Rv.js";import{_ as Ue}from"./swap-outlined-tp0eCcWN.js";import{u as We}from"./useAppInject-BuU8lio7.js";import{u as je}from"./useTransition-qMbJRxJj.js";import{s as Re,g as Z,a as qe}from"./file-myfSNQEg.js";import{f as X,a as Ae,b as Ge}from"./index-Fh6gHIZ9.js";import"./sharp-arrow-back-ios-o7qdCfpO.js";import"./useDesign-7GyM2Hwu.js";import"./propTypes-LGH0h7_d.js";const Je={style:{display:"inline-block"},viewBox:"0 0 2048 2048",width:"1em",height:"1em"},Ke=R("path",{fill:"currentColor",d:"M1792 0v2048H256V0h1536zM384 128v384h1280V128H384zm1280 1408H384v384h1280v-384zm0-256V640H384v640h1280z"},null,-1),Qe=[Ke];function Ze(V,u){return x(),Y("svg",Je,[...Qe])}const Xe={name:"fluent-mdl2-diff-inline",render:Ze},Ye={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"},en=R("path",{fill:"currentColor",d:"M10 18H6v-2h4v2m0-4H6v-2h4v2m0-13v1H6c-1.11 0-2 .89-2 2v16a2 2 0 0 0 2 2h4v1h2V1h-2m10 7v12c0 1.11-.89 2-2 2h-4v-2h4v-9h-4V9h4.5L14 4.5V2l6 6m-4 6h-2v-2h2v2m0 4h-2v-2h2v2Z"},null,-1),nn=[en];function tn(V,u){return x(),Y("svg",Ye,[...nn])}const an={name:"mdi-file-compare",render:tn},bn=fe({__name:"index",setup(V){const{getIsMobile:u}=We(),{t:i}=Ne(),{message:I}=Pe(),C=r("fade-slide");je(C);const h=r(),S=r([]),y=r([]),p=r({}),m=r({content:"",language:""}),$=r(""),E=r(!u.value),O=r(u.value?13:15),T=r(u.value?"on":"off"),_=r(""),g=r(""),M=r(!1),U=r(!1),k=r(!1),z=r(!1),F=o=>w(this,null,function*(){switch(o){case"showEditorShortcutsInfo":h.value.showShortCuts();break;case"wordWrap":T.value=T.value==="on"?"off":"on",z.value=!1;break;case"renderSideBySide":E.value=!E.value,z.value=!1;break;case"save":M.value=!0;const a=e(h).getValue();try{yield Re({content:a,path:_.value}),I.success(i("editor.main.savedSuccess"))}finally{M.value=!1}break}}),ee=()=>w(this,null,function*(){k.value=!0;const o=yield Z({}),a=q(o);S.value=a;const s=yield Z({}),v=q(s);y.value=v,k.value=!1}),q=o=>{const a=v=>{v.length&&v.forEach(l=>{if(l.type===0)Object.assign(l,{key:l.path,label:l.title,disabled:!0,prefix:()=>f(d,null,{default:()=>f(X)})}),a(l.children),l.children.length||(Object.assign(l,{children:null,disabled:!0}),l.prefix=()=>f(d,null,{default:()=>f(He)}));else{const b=l.name;if(b){const W=b.substring(b.lastIndexOf(".")+1),B=Ge[W]||{};Object.assign(l,{key:l.path,label:b,language:B.language||"plaintext",disabled:B.disabled||!1,prefix:()=>f(d,null,{default:()=>f(B.icon||Me)})})}}})};a(o);const s=v=>v.filter(l=>l.children?(l.children=s(l.children),!0):!l.disabled);return o=s(o),o},H=(o,a,s)=>{if(s.node)switch(s.action){case"expand":s.node.prefix=()=>f(d,null,{default:()=>f(Ae)});break;case"collapse":s.node.prefix=()=>f(d,null,{default:()=>f(X)});break}},A=(o,a)=>w(this,null,function*(){U.value=!0;const s=yield qe({path:encodeURI(o.key)});if(s)switch(a){case"config":m.value={content:s,language:o.language};break;case"sample":$.value=s;break}else{switch(a){case"config":break;case"sample":$.value="";break}I.info(i("page.diff.fileContentIsEmptyMsg"))}U.value=!1}),G=({option:o})=>({onClick(){return w(this,null,function*(){!o.children&&!o.disabled&&(p.value=o,yield A(o,"config"))})}}),J=({option:o})=>({onClick(){return w(this,null,function*(){!o.children&&!o.disabled&&(p.value=o,yield A(o,"sample"))})}});return K(_,o=>{o||(m.value={content:"",language:""})}),K(g,o=>{o||($.value="")}),me(()=>w(this,null,function*(){yield ee()})),ge(()=>{h.value&&h.value.dispose()}),(o,a)=>{const s=ye,v=an,l=be,b=we,W=xe,B=Ee,D=ke,ne=Oe,te=ze,ae=Ue,oe=Xe,le=Ce,se=Le,ie=Se,re=Fe,ce=Te,de=$e,ue=Ve,pe=Be,_e=De;return x(),N(_e,{ref:"pageWrapper","content-full":!0,title:e(i)("routes.main.page.diff")},ve({extra:t(()=>[e(_)&&e(g)?(x(),N(he,{key:0,name:e(C),mode:"out-in",appear:""},{default:t(()=>[n(l,null,{default:t(()=>[n(l,{style:{gap:"0"}},{default:t(()=>[n(le,{trigger:"manual",style:{padding:"8px"},show:e(z),"show-arrow":!1,placement:"bottom"},{trigger:t(()=>[n(D,{strong:"",quaternary:"",size:"small",type:e(z)?"primary":"tertiary",style:{padding:"6px"},focusable:!1,onClick:a[4]||(a[4]=c=>z.value=!e(z))},{default:t(()=>[n(e(d),{size:"18"},{default:t(()=>[n(B,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1},8,["type"])]),default:t(()=>[n(l,{vertical:""},{default:t(()=>[n(l,{size:"small"},{default:t(()=>[n(e(d),{size:20},{default:t(()=>[n(ne,{style:{"vertical-align":"-0.4em"}})]),_:1}),n(te,{value:e(O),"onUpdate:value":a[5]||(a[5]=c=>P(O)?O.value=c:null),min:12,max:40,"button-placement":"both",size:"small",class:"max-w-94px",style:{"text-align":"center"}},null,8,["value"])]),_:1}),n(l,{size:"small"},{default:t(()=>[n(e(d),{size:20,color:e(T)==="on"?"var(--app-primary-color)":void 0},{default:t(()=>[n(ae,{style:{"vertical-align":"-0.4em"}})]),_:1},8,["color"]),n(D,{strong:"",secondary:"",size:"small",style:{width:"94px"},onClick:a[6]||(a[6]=c=>F("wordWrap"))},{default:t(()=>[j(L(e(i)("editor.switch.wordWrapBtn")),1)]),_:1})]),_:1}),n(l,{size:"small"},{default:t(()=>[n(e(d),{size:20,color:e(E)?void 0:"var(--app-primary-color)"},{default:t(()=>[n(oe,{style:{"vertical-align":"-0.4em"}})]),_:1},8,["color"]),n(D,{strong:"",secondary:"",size:"small",style:{width:"94px"},onClick:a[7]||(a[7]=c=>F("renderSideBySide"))},{default:t(()=>[j(L(e(i)("editor.switch.inlineModeTips")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["show"]),e(u)?Q("",!0):(x(),N(ie,{key:0,placement:"bottom",trigger:"hover",delay:500},{trigger:t(()=>[n(D,{strong:"",quaternary:"",size:"small",type:"tertiary",style:{padding:"6px"},focusable:!1,onClick:a[8]||(a[8]=c=>F("showEditorShortcutsInfo"))},{default:t(()=>[n(e(d),{size:"18"},{default:t(()=>[n(se,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1})]),default:t(()=>[R("span",null,L(e(i)("editor.switch.shortcutsTips")),1)]),_:1}))]),_:1}),n(D,{strong:"",type:"primary",size:"small",disabled:!e(_),loading:e(M),focusable:!1,onClick:a[9]||(a[9]=c=>F("save"))},{icon:t(()=>[n(re)]),default:t(()=>[j(" "+L(e(i)("editor.main.saveButton")),1)]),_:1},8,["disabled","loading"])]),_:1})]),_:1},8,["name"])):Q("",!0)]),default:t(()=>[n(pe,{bordered:!e(u),style:{height:"100%","word-break":"unset"},"content-style":"padding: 0"},{default:t(()=>[e(m).content||e($)?(x(),N(Ie,{key:0,ref_key:"editor",ref:h,value:e(m),"origin-value":e($),"diff-mode":!0,"word-wrap":e(T),"render-side-by-side":e(E),"font-size":e(O)},null,8,["value","origin-value","word-wrap","render-side-by-side","font-size"])):(x(),N(de,{key:1,class:"min-h-200px flex-jc-ac h-full",size:"huge",description:e(i)("common.selectFileEmptyDesc")},{icon:t(()=>[n(e(d),null,{default:t(()=>[n(ce)]),_:1})]),_:1},8,["description"])),n(ue,{show:e(U)},null,8,["show"])]),_:1},8,["bordered"])]),_:2},[e(u)?{name:"headerContent",fn:t(()=>[n(W,{"x-gap":12,cols:2},{default:t(()=>[n(b,null,{default:t(()=>[n(s,{value:e(g),"onUpdate:value":a[2]||(a[2]=c=>P(g)?g.value=c:null),size:"small",loading:e(k),"consistent-menu-width":!1,clearable:"",placement:"bottom-start",placeholder:e(i)("page.diff.selectSourceFilePlaceholder"),options:e(y),"node-props":J,"on-update:expanded-keys":H},null,8,["value","loading","placeholder","options"])]),_:1}),n(b,null,{default:t(()=>[n(s,{value:e(_),"onUpdate:value":a[3]||(a[3]=c=>P(_)?_.value=c:null),size:"small",loading:e(k),"consistent-menu-width":!1,clearable:"",placement:"bottom-end",placeholder:e(i)("page.diff.selectDestinationFilePlaceholder"),options:e(S),"node-props":G,"on-update:expanded-keys":H},null,8,["value","loading","placeholder","options"])]),_:1})]),_:1})]),key:"1"}:{name:"subtitle",fn:t(()=>[n(l,null,{default:t(()=>[n(s,{value:e(g),"onUpdate:value":a[0]||(a[0]=c=>P(g)?g.value=c:null),size:"small",style:{"min-width":"200px",width:"fit-content"},"show-path":"",loading:e(k),"consistent-menu-width":!1,clearable:"",placeholder:e(i)("page.diff.selectSourceFilePlaceholder"),options:e(y),"node-props":J,"on-update:expanded-keys":H},null,8,["value","loading","placeholder","options"]),n(e(d),{size:"24",depth:3},{default:t(()=>[n(v)]),_:1}),n(s,{value:e(_),"onUpdate:value":a[1]||(a[1]=c=>P(_)?_.value=c:null),size:"small",style:{"min-width":"200px",width:"fit-content"},"show-path":"",loading:e(k),"consistent-menu-width":!1,clearable:"",placeholder:e(i)("page.diff.selectDestinationFilePlaceholder"),options:e(S),"node-props":G,"on-update:expanded-keys":H},null,8,["value","loading","placeholder","options"])]),_:1})]),key:"0"}]),1032,["title"])}}});export{bn as default};
