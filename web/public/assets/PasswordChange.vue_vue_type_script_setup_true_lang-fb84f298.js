import{u as g,_ as m}from"./useForm-2ed85117.js";import{w,c as P,a as h,O as f}from"./index-0513fac8.js";import{G as _,h as b,aL as v,a6 as y,aH as N,M as q,as as E,a9 as I,u as k}from"./vendor-3ca7b8d8.js";const B={class:"grid grid-cols-1 grid-flow-row-dense md:grid-cols-[450px_1fr] gap-4"},O=_({__name:"PasswordChange",setup(S){const t=w(),n=b(()=>t.getUserInfo),{message:o}=P(),{t:e}=h(),a=[{field:"username",component:"NInput",label:e("setting.changePwd.username"),required:!0,componentProps:{placeholder:e("setting.changePwd.placeholder.userName")},defaultValue:n.value.username,rules:[{required:!0,validator(r,s){return s?!0:new Error(e("setting.changePwd.error.userNameEmpty"))},trigger:["input","blur"]}]},{field:"password",component:"NInput",label:e("setting.changePwd.newPassword"),required:!0,componentProps:{placeholder:e("setting.changePwd.placeholder.newPassword"),type:"password",showPasswordOn:"click"},rules:[{required:!0,validator(r,s){return s?!0:new Error(e("setting.changePwd.error.newPasswordEmpty"))},trigger:["input","blur"]}]},{field:"confirmPassword",component:"NInput",label:e("setting.changePwd.confirmnewPassword"),required:!0,componentProps:{type:"password",placeholder:e("setting.changePwd.placeholder.confirmnewPassword"),showPasswordOn:"click"},rules:[{required:!0,validator(r,s){return c().password!==s?new Error(e("setting.changePwd.error.confirmnewPasswordDiff")):!0},trigger:["input","blur"]}]}],[u,{setFieldsValue:i,getFieldsValue:c,validate:d}]=g({schemas:a,labelPlacement:"top",gridProps:{cols:3,xGap:6},giProps:{span:2},submitButtonText:e("setting.changePwd.button.confirm")}),l=async r=>{await d(),await f({username:r.username,password:r.password}),o.warning(e("setting.changePwd.message.msgOk"));try{setTimeout(()=>{t.logout(!0)},2e3)}catch{}};return v(async()=>{i({})}),(r,s)=>{const p=m;return y(),N("div",null,[q(r.$slots,"title"),E("div",B,[I(p,{onRegister:k(u),onSubmit:l},null,8,["onRegister"])])])}}});export{O as _};
