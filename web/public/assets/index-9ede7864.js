import{G as oe,x as s,C as se,aL as le,aM as ie,a6 as x,a7 as b,a8 as a,a9 as n,u as e,aD as W,ax as re,aB as i,aN as $,aI as k,as as ue,aJ as j,al as c,aO as ce,am as pe,aP as _e,aC as de,aQ as fe,aR as me,aS as ge,aK as ve}from"./vendor-339b2486.js";import{_ as ye}from"./PageWrapper.vue_vue_type_style_index_0_lang-ebcdd68c.js";import{a as he,c as we,L as xe}from"./index-b98e63e9.js";import{_ as be,a as ke,b as ze,c as Ce}from"./index.vue_vue_type_style_index_0_lang-f5024cf5.js";import{_ as Ne,f as Be}from"./folderDisable-3ec899af.js";import{_ as Ie,f as Se}from"./filePrefix-033be9bb.js";import{_ as $e,a as Ee}from"./find-replace-019bb954.js";import{_ as Te}from"./swap-outlined-206b9abd.js";import{u as Oe}from"./useAppInject-25d4ad8f.js";import{u as Fe}from"./useTransition-0172c80f.js";import{F as De}from"./fileTreeEnum-b1a083a5.js";import{s as Le,g as Pe,a as Ve}from"./file-1f2fda02.js";import{f as M,a as We,b as je}from"./index-02fa18bb.js";import"./sharp-arrow-back-ios-59e3289b.js";import"./useDesign-d1f0a28d.js";import"./propTypes-8a448afd.js";const on=oe({__name:"index",setup(Me){const{getIsMobile:v}=Oe(),{t:u}=he(),{message:E}=we(),L=s("fade-slide");Fe(L);const z=s([]),g=s({}),y=s(),C=s({content:"",language:""}),d=s(""),N=s(!v.value),B=s(v.value?"on":"off"),T=s(!1),I=s(!0),O=s(!1),S=s(v.value?13:15),F=s(!1),f=s(!1),h=async o=>{switch(o){case"findBox":F.value=!F.value,f.value=!1;break;case"wordWrap":B.value=B.value==="on"?"off":"on",f.value=!1;break;case"minimap":N.value=!N.value,f.value=!1;break;case"showEditorShortcutsInfo":y.value.showShortCuts();break;case"save":T.value=!0;const t=e(y).getValue();try{await Le({content:t,path:g.value.path}),E.success(u("editor.main.savedSuccess"))}finally{T.value=!1,await P()}break}},P=async()=>{O.value=!0;const o=await Pe({type:De.CONFIG}),t=U(o);z.value=t,O.value=!1},U=o=>{const t=p=>{p.length&&p.forEach(l=>{if(l.type===0)Object.assign(l,{key:l.path,label:l.title,disabled:!0,prefix:()=>c(i,null,{default:()=>c(M)})}),t(l.children),l.children.length||(Object.assign(l,{children:null,disabled:!0}),l.prefix=()=>c(i,null,{default:()=>c(Be)}));else{const r=l.name;if(r){const D=r.substring(r.lastIndexOf(".")+1),w=je[D]||{};Object.assign(l,{key:l.path,label:r,language:w.language||"plaintext",disabled:w.disabled||!1,prefix:()=>c(i,null,{default:()=>c(w.icon||Se)})})}}})};return t(o),o},A=(o,t,p)=>{if(p.node)switch(p.action){case"expand":p.node.prefix=()=>c(i,null,{default:()=>c(We)});break;case"collapse":p.node.prefix=()=>c(i,null,{default:()=>c(M)});break}},R=({option:o})=>({async onClick(){!o.children&&!o.disabled&&(g.value=o,await V(o))}});async function V(o){I.value=!0;const t=await Ve({path:encodeURI(o.key)});t?C.value={content:t,language:o.language}:(C.value={content:"",language:""},E.info(u("page.config.fileContentIsEmptyMsg"))),I.value=!1}function q(){if(z.value.length){for(const o of z.value)if(o.type===1&&o.name==="config.sh")return o}return{}}return se(d,o=>{o||(C.value={content:"",language:""})}),le(async()=>{await P(),g.value=q(),g.value.path?(await V(g.value),d.value=g.value.path):E.error(u("page.config.mainConfigNotExistsMsg"),{keepAliveOnHover:!0}),I.value=!1}),ie(()=>{y.value&&y.value.dispose()}),(o,t)=>{const p=ce,l=ke,r=pe,D=ze,w=_e,m=de,G=$e,H=Te,J=Ee,K=fe,Q=Ie,X=me,Y=Ne,Z=Ce,ee=ge,ne=xe,ae=ve,te=ye;return x(),b(te,{ref:"pageWrapper","content-full":!0},{title:a(()=>[n(p,{value:e(d),"onUpdate:value":t[0]||(t[0]=_=>W(d)?d.value=_:null),size:"small",class:"min-w-190px",loading:e(O),"consistent-menu-width":!1,clearable:"",placeholder:e(u)("page.config.selectConfigFilePlaceholder"),options:e(z),"node-props":R,"on-update:expanded-keys":A},null,8,["value","loading","placeholder","options"])]),extra:a(()=>[e(d)?(x(),b(re,{key:0,name:e(L),mode:"out-in",appear:""},{default:a(()=>[n(m,{style:{width:"fix-content"}},{default:a(()=>[n(m,{style:{gap:"0"}},{default:a(()=>[n(K,{trigger:"manual",style:{padding:"8px"},show:e(f),"show-arrow":!1,placement:"bottom"},{trigger:a(()=>[n(r,{strong:"",quaternary:"",size:"small",type:e(f)?"primary":"tertiary",style:{padding:"6px"},focusable:!1,onClick:t[1]||(t[1]=_=>f.value=!e(f))},{default:a(()=>[n(e(i),{size:"18"},{default:a(()=>[n(l,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1},8,["type"])]),default:a(()=>[n(m,{vertical:""},{default:a(()=>[n(m,{size:"small"},{default:a(()=>[n(e(i),{size:20},{default:a(()=>[n(D,{style:{"vertical-align":"-0.4em"}})]),_:1}),n(w,{value:e(S),"onUpdate:value":t[2]||(t[2]=_=>W(S)?S.value=_:null),min:12,max:40,"button-placement":"both",size:"small",class:"max-w-94px",style:{"text-align":"center"}},null,8,["value"])]),_:1}),n(m,{size:"small"},{default:a(()=>[n(e(i),{size:20},{default:a(()=>[n(G,{style:{"vertical-align":"-0.4em"}})]),_:1}),n(r,{strong:"",secondary:"",size:"small",style:{width:"94px"},onClick:t[3]||(t[3]=_=>h("findBox"))},{default:a(()=>[$(k(e(u)("editor.switch.findBtn")),1)]),_:1})]),_:1}),n(m,{size:"small"},{default:a(()=>[n(e(i),{size:20,color:e(B)==="on"?"var(--app-primary-color)":void 0},{default:a(()=>[n(H,{style:{"vertical-align":"-0.4em"}})]),_:1},8,["color"]),n(r,{strong:"",secondary:"",size:"small",style:{width:"94px"},onClick:t[4]||(t[4]=_=>h("wordWrap"))},{default:a(()=>[$(k(e(u)("editor.switch.wordWrapBtn")),1)]),_:1})]),_:1}),n(m,{size:"small"},{default:a(()=>[n(e(i),{size:20,color:e(N)?"var(--app-primary-color)":void 0},{default:a(()=>[n(J,{style:{"vertical-align":"-0.4em"}})]),_:1},8,["color"]),n(r,{strong:"",secondary:"",size:"small",style:{width:"94px"},onClick:t[5]||(t[5]=_=>h("minimap"))},{default:a(()=>[$(k(e(u)("editor.switch.minimapBtn")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["show"]),e(v)?j("",!0):(x(),b(X,{key:0,placement:"bottom",trigger:"hover",delay:500},{trigger:a(()=>[n(r,{strong:"",quaternary:"",size:"small",type:"tertiary",style:{padding:"6px"},focusable:!1,onClick:t[6]||(t[6]=_=>h("showEditorShortcutsInfo"))},{default:a(()=>[n(e(i),{size:"18"},{default:a(()=>[n(Q,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1})]),default:a(()=>[ue("span",null,k(e(u)("editor.switch.shortcutsTips")),1)]),_:1}))]),_:1}),n(r,{strong:"",type:"primary",size:"small",loading:e(T),focusable:!1,onClick:t[7]||(t[7]=_=>h("save"))},{icon:a(()=>[n(Y)]),default:a(()=>[$(" "+k(e(u)("editor.main.saveButton")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["name"])):j("",!0)]),default:a(()=>[n(ae,{bordered:!e(v),style:{height:"100%","word-break":"unset"},"content-style":"padding: 0"},{default:a(()=>[e(d)?(x(),b(be,{key:0,ref_key:"editor",ref:y,value:e(C),"word-wrap":e(B),minimap:e(N),"font-size":e(S),"find-box":e(F)},null,8,["value","word-wrap","minimap","font-size","find-box"])):(x(),b(ee,{key:1,class:"min-h-200px flex-jc-ac h-full",size:"huge",description:e(u)("common.selectFileEmptyDesc")},{icon:a(()=>[n(e(i),null,{default:a(()=>[n(Z)]),_:1})]),_:1},8,["description"])),n(ne,{show:e(I)},null,8,["show"])]),_:1},8,["bordered"])]),_:1},512)}}});export{on as default};
