import{_ as v}from"./history-95e22cdb.js";import{c as D,b as C}from"./index-1a66f6b1.js";import{u as R}from"./useAppInject-27ca0bbd.js";import{j as z,a as B}from"./file-e78de043.js";import{G as L,x as M,r as j,I as A,a6 as s,a7 as i,a8 as r,ac as f,u as e,aJ as E,as as F,aL as S,aC as V,aw as y,aE as G,bD as J,bf as P,bI as T,bu as U}from"./vendor-95d24bd5.js";const $={key:1},Y=L({__name:"historyModal",setup(q,{expose:w}){const{message:x}=D(),{t:c}=C(),{getIsMobile:a}=R(),k=M(null),n=j({show:!1,loading:!0,log:""}),{show:_,loading:b,log:d}=A(n),I=async o=>{n.log="",n.loading=!0,n.show=!0;try{n.log=await N(o.logPath,o.running_status)}finally{n.loading=!1}},N=async(o,l)=>{const t=await z(o);if(t.children&&t.children.length){t.children.sort((g,u)=>{const m=g.name.replace(".log","").replace(/-/g,"");return u.name.replace(".log","").replace(/-/g,"")-m});const p=l&&t.children[1]?t.children[1]:t.children[0];return await B({path:p.path})}return x.warning(c("cron.task.message.no_latest_log")),""};return w({open:I}),(o,l)=>{const t=v,p=J,h=P,g=T,u=U;return s(),i(u,{show:e(_),"onUpdate:show":l[0]||(l[0]=m=>G(_)?_.value=m:null),preset:"dialog","auto-focus":!1,title:e(c)("cron.task.history"),style:y({width:e(a)?"100vw":"600px",padding:e(a)?"16px":""})},{icon:r(()=>[f(e(E),null,{default:r(()=>[f(t,{style:{"vertical-align":"0"}})]),_:1})]),default:r(()=>[e(b)?(s(),i(p,{key:0,text:"",repeat:27,height:"16px"})):(s(),F("div",$,[e(d)?(s(),i(g,{key:1,ref_key:"logInstRef",ref:k,log:e(d),"line-height":1.5,"font-size":e(a)?13:14,language:"naive-log",style:y(`padding-top: 1em; width: 100%; height: ${e(a)?"650px":"600px"}`)},null,8,["log","line-height","font-size","style"])):(s(),i(h,{key:0},{default:r(()=>[S(V(e(c)("common.noData")),1)]),_:1}))]))]),_:1},8,["show","title","style"])}}});export{Y as _};
