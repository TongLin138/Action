var b=(V,v,s)=>new Promise((x,k)=>{var w=r=>{try{f(s.next(r))}catch(p){k(p)}},g=r=>{try{f(s.throw(r))}catch(p){k(p)}},f=r=>r.done?x(r.value):Promise.resolve(r.value).then(w,g);f((s=s.apply(V,v)).next())});import{d as le,b as ie,z as re,r as l,A as ue,B as pe,C as ce,o as N,c as B,w as n,a as t,e,i as A,D as _e,E as F,t as E,v as fe,q as M,h as _,f as de,L as me,y as ge}from"./index-797c0a85.js";import{_ as ve}from"./PageWrapper.vue_vue_type_style_index_0_lang-f0d6bddb.js";import{_ as ye,a as he,b as we,c as be}from"./index.vue_vue_type_style_index_0_lang-50975d62.js";import{_ as xe,f as ke}from"./folderDisable-67c9a4f1.js";import{_ as ze,f as Ce}from"./filePrefix-28253f5c.js";import{_ as Ne,a as Be}from"./find-replace-a4b07bd8.js";import{_ as Ee}from"./swap-outlined-e52ae3c2.js";import{u as $e}from"./useAppInject-e4ee4e96.js";import{u as Ie}from"./useTransition-5809f8e4.js";import{F as Se}from"./fileTreeEnum-b1a083a5.js";import{s as Te,g as Fe,a as Oe}from"./file-6dbc6db3.js";import{f as U,a as De,b as Le}from"./index-9f937feb.js";import{N as Pe}from"./TreeSelect-10e2e39e.js";import{N as Ve}from"./InputNumber-d8e642e9.js";import{_ as We,a as je}from"./Tooltip-271e10cc.js";import{N as u}from"./Icon-abc31adc.js";import{N as Ae}from"./Space-3cb079f3.js";import{_ as Me}from"./Empty-aa248199.js";import"./monacoEditor-d72532b2.js";import"./sharp-arrow-back-ios-ca1144ee.js";import"./useDesign-a03ef768.js";import"./propTypes-69de8b77.js";import"./Tag-274eae2a.js";import"./Table-f28f3c40.js";import"./Tree-c1a4f7b1.js";import"./Checkbox-007ffc49.js";import"./FocusDetector-effeeed3.js";import"./use-locale-3967e664.js";import"./Selection-a7bafa19.js";import"./Input-c8aa899c.js";import"./attribute-2ee9e579.js";import"./use-resize-d169ca1a.js";import"./Remove-cd58428d.js";import"./Add-843bb42e.js";import"./on-fonts-ready-2684803e.js";const Ct=le({__name:"index",setup(V){const{getIsMobile:v}=$e(),{t:s}=ie(),{message:x}=re(),k=l("fade-slide");Ie(k);const w=l([]),g=l({}),f=l(),r=l({content:"",language:""}),p=l(""),$=l(!v.value),I=l(v.value?"on":"off"),O=l(!1),S=l(!0),D=l(!1),T=l(v.value?13:15),L=l(!1),y=l(!1),z=a=>b(this,null,function*(){switch(a){case"findBox":L.value=!L.value,y.value=!1;break;case"wordWrap":I.value=I.value==="on"?"off":"on",y.value=!1;break;case"minimap":$.value=!$.value,y.value=!1;break;case"showEditorShortcutsInfo":f.value.showShortCuts();break;case"save":O.value=!0;const o=e(f).getValue();try{yield Te({content:o,path:g.value.path}),x.success(s("editor.main.savedSuccess"))}finally{O.value=!1,yield W()}break}}),W=()=>b(this,null,function*(){D.value=!0;const a=yield Fe({type:Se.CONFIG}),o=q(a);w.value=o,D.value=!1}),q=a=>{const o=d=>{d.length&&d.forEach(i=>{if(i.type===0)Object.assign(i,{key:i.path,label:i.title,disabled:!0,prefix:()=>_(u,null,{default:()=>_(U)})}),o(i.children),i.children.length||(Object.assign(i,{children:null,disabled:!0}),i.prefix=()=>_(u,null,{default:()=>_(ke)}));else{const c=i.name;if(c){const P=c.substring(c.lastIndexOf(".")+1),C=Le[P]||{};Object.assign(i,{key:i.path,label:c,language:C.language||"plaintext",disabled:C.disabled||!1,prefix:()=>_(u,null,{default:()=>_(C.icon||Ce)})})}}})};return o(a),a},R=(a,o,d)=>{if(d.node)switch(d.action){case"expand":d.node.prefix=()=>_(u,null,{default:()=>_(De)});break;case"collapse":d.node.prefix=()=>_(u,null,{default:()=>_(U)});break}},G=({option:a})=>({onClick(){return b(this,null,function*(){!a.children&&!a.disabled&&(g.value=a,yield j(a))})}});function j(a){return b(this,null,function*(){S.value=!0;const o=yield Oe({path:encodeURI(a.key)});o?r.value={content:o,language:a.language}:(r.value={content:"",language:""},x.info(s("page.config.fileContentIsEmptyMsg"))),S.value=!1})}function H(){if(w.value.length){for(const a of w.value)if(a.type===1&&a.name==="config.sh")return a}return{}}return ue(p,a=>{a||(r.value={content:"",language:""})}),pe(()=>b(this,null,function*(){yield W(),g.value=H(),g.value.path?(yield j(g.value),p.value=g.value.path):x.error(s("page.config.mainConfigNotExistsMsg"),{keepAliveOnHover:!0}),S.value=!1})),ce(()=>{f.value&&f.value.dispose()}),(a,o)=>{const d=Pe,i=he,c=de,P=we,C=Ve,h=Ae,J=Ne,K=Ee,Q=Be,X=We,Y=ze,Z=je,ee=xe,te=be,ne=Me,oe=me,ae=ge,se=ve;return N(),B(se,{ref:"pageWrapper","content-full":!0},{title:n(()=>[t(d,{value:e(p),"onUpdate:value":o[0]||(o[0]=m=>A(p)?p.value=m:null),size:"small",class:"min-w-190px",loading:e(D),"consistent-menu-width":!1,clearable:"",placeholder:e(s)("page.config.selectConfigFilePlaceholder"),options:e(w),"node-props":G,"on-update:expanded-keys":R},null,8,["value","loading","placeholder","options"])]),extra:n(()=>[e(p)?(N(),B(_e,{key:0,name:e(k),mode:"out-in",appear:""},{default:n(()=>[t(h,{style:{width:"fix-content"}},{default:n(()=>[t(h,{style:{gap:"0"}},{default:n(()=>[t(X,{trigger:"manual",style:{padding:"8px"},show:e(y),"show-arrow":!1,placement:"bottom"},{trigger:n(()=>[t(c,{strong:"",quaternary:"",size:"small",type:e(y)?"primary":"tertiary",style:{padding:"6px"},focusable:!1,onClick:o[1]||(o[1]=m=>y.value=!e(y))},{default:n(()=>[t(e(u),{size:"18"},{default:n(()=>[t(i,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1},8,["type"])]),default:n(()=>[t(h,{vertical:""},{default:n(()=>[t(h,{size:"small"},{default:n(()=>[t(e(u),{size:20},{default:n(()=>[t(P,{style:{"vertical-align":"-0.4em"}})]),_:1}),t(C,{value:e(T),"onUpdate:value":o[2]||(o[2]=m=>A(T)?T.value=m:null),min:12,max:40,"button-placement":"both",size:"small",class:"max-w-94px",style:{"text-align":"center"}},null,8,["value"])]),_:1}),t(h,{size:"small"},{default:n(()=>[t(e(u),{size:20},{default:n(()=>[t(J,{style:{"vertical-align":"-0.4em"}})]),_:1}),t(c,{strong:"",secondary:"",size:"small",style:{width:"94px"},onClick:o[3]||(o[3]=m=>z("findBox"))},{default:n(()=>[F(E(e(s)("editor.switch.findBtn")),1)]),_:1})]),_:1}),t(h,{size:"small"},{default:n(()=>[t(e(u),{size:20,color:e(I)==="on"?"var(--app-primary-color)":void 0},{default:n(()=>[t(K,{style:{"vertical-align":"-0.4em"}})]),_:1},8,["color"]),t(c,{strong:"",secondary:"",size:"small",style:{width:"94px"},onClick:o[4]||(o[4]=m=>z("wordWrap"))},{default:n(()=>[F(E(e(s)("editor.switch.wordWrapBtn")),1)]),_:1})]),_:1}),t(h,{size:"small"},{default:n(()=>[t(e(u),{size:20,color:e($)?"var(--app-primary-color)":void 0},{default:n(()=>[t(Q,{style:{"vertical-align":"-0.4em"}})]),_:1},8,["color"]),t(c,{strong:"",secondary:"",size:"small",style:{width:"94px"},onClick:o[5]||(o[5]=m=>z("minimap"))},{default:n(()=>[F(E(e(s)("editor.switch.minimapBtn")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["show"]),e(v)?M("",!0):(N(),B(Z,{key:0,placement:"bottom",trigger:"hover",delay:500},{trigger:n(()=>[t(c,{strong:"",quaternary:"",size:"small",type:"tertiary",style:{padding:"6px"},focusable:!1,onClick:o[6]||(o[6]=m=>z("showEditorShortcutsInfo"))},{default:n(()=>[t(e(u),{size:"18"},{default:n(()=>[t(Y,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1})]),default:n(()=>[fe("span",null,E(e(s)("editor.switch.shortcutsTips")),1)]),_:1}))]),_:1}),t(c,{strong:"",type:"primary",size:"small",loading:e(O),focusable:!1,onClick:o[7]||(o[7]=m=>z("save"))},{icon:n(()=>[t(ee)]),default:n(()=>[F(" "+E(e(s)("editor.main.saveButton")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["name"])):M("",!0)]),default:n(()=>[t(ae,{bordered:!e(v),style:{height:"100%","word-break":"unset"},"content-style":"padding: 0"},{default:n(()=>[e(p)?(N(),B(ye,{key:0,ref_key:"editor",ref:f,value:e(r),"word-wrap":e(I),minimap:e($),"font-size":e(T),"find-box":e(L)},null,8,["value","word-wrap","minimap","font-size","find-box"])):(N(),B(ne,{key:1,class:"min-h-200px flex-jc-ac h-full",size:"huge",description:e(s)("common.selectFileEmptyDesc")},{icon:n(()=>[t(e(u),null,{default:n(()=>[t(te)]),_:1})]),_:1},8,["description"])),t(oe,{show:e(S)},null,8,["show"])]),_:1},8,["bordered"])]),_:1},512)}}});export{Ct as default};
