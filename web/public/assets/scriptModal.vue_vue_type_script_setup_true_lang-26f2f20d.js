import{_ as T}from"./swap-outlined-c2e90102.js";import{c as j,_ as J}from"./index-35fc6cad.js";import{a6 as a,as as U,aG as u,G as Z,r as q,I as K,a7 as c,a8 as t,ac as o,u as e,aJ as _,aL as Q,aC as p,aD as w,aE as X,aw as Y,am as ee,aS as te,aN as ne,bD as oe,br as se,bp as ae,aH as ce,bu as ie}from"./vendor-605eddea.js";import{_ as le}from"./description-outline-rounded-15b42bae.js";import{c as re,b as _e,H as pe,I as ue}from"./index-a28ae7ef.js";import{u as me}from"./useAppInject-bfcb44f9.js";import{f as de}from"./index-acb2c891.js";import{a as ge}from"./file-b1173af7.js";import fe from"./loading-8da2d8e0.js";const he={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"},ye=u("path",{fill:"currentColor",d:"M8 12h8v2H8v-2m2 8H6V4h7v5h5v3.1l2-2V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4v-2m-2-2h4.1l.9-.9V16H8v2m12.2-5c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1l-2.1-2.1l1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1l2.1 2.1Z"},null,-1),we=[ye];function be(x,b){return a(),U("svg",he,we)}const ke={name:"mdi-file-document-edit-outline",render:be},He=Z({__name:"scriptModal",setup(x,{expose:b}){const{message:m}=re(),{t:i}=_e(),{getIsMobile:k}=me(),v=pe(),n=q({title:i("cron.task.script"),path:"",show:!1,loading:!0,code:"",language:"",wordWrap:!0,showLineNumbers:!1}),{title:N,path:C,show:d,loading:l,code:E,language:I,wordWrap:B,showLineNumbers:M}=K(n),z=async s=>{n.title=s.scriptPath.split("/").pop(),n.path=s.scriptPath,n.code="",n.language="",n.loading=!0,n.show=!0;try{await H(s.scriptPath)}finally{n.code?n.loading=!1:m.warning(i("cron.task.message.no_script"))}},H=async s=>{const r=await ge({path:s}),g=s.substring(s.lastIndexOf(".")+1),f=de[g]||{};n.code=r,n.language=f.language||"plaintext"},L=()=>{j(n.code)?m.success(i("common.copyOk")):m.error(i("common.copyFail"))},V=()=>{n.wordWrap=!n.wordWrap,n.showLineNumbers=!n.showLineNumbers},S=()=>{v(`${ue.FILE_MANAGER_PAGE}?path=${C.value}`)};return b({open:z}),(s,r)=>{const g=le,f=ke,h=ee,y=te,W=J,$=T,A=ne,G=oe,P=se,D=ae,F=ce,R=ie;return a(),c(R,{show:e(d),"onUpdate:show":r[0]||(r[0]=O=>X(d)?d.value=O:null),preset:"dialog","auto-focus":!1,style:Y({width:e(k)?"100vw":"800px",padding:e(k)?"16px":""})},{icon:t(()=>[o(e(_),null,{default:t(()=>[e(l)?(a(),c(fe,{key:0})):(a(),c(g,{key:1,style:{"vertical-align":"0"}}))]),_:1})]),header:t(()=>[o(A,null,{default:t(()=>[Q(p(e(N))+" ",1),e(l)?w("",!0):(a(),c(y,{key:0,trigger:"hover"},{trigger:t(()=>[o(h,{text:"",size:"tiny",type:"primary",focusable:!1,onClick:S},{icon:t(()=>[o(e(_),{size:16},{default:t(()=>[o(f)]),_:1})]),_:1})]),default:t(()=>[u("span",null,p(e(i)("cron.task.scriptModal.goEditBtn")),1)]),_:1})),e(l)?w("",!0):(a(),c(y,{key:1,trigger:"hover"},{trigger:t(()=>[o(h,{text:"",size:"tiny",type:"primary",focusable:!1,onClick:L},{icon:t(()=>[o(e(_),null,{default:t(()=>[o(W)]),_:1})]),_:1})]),default:t(()=>[u("span",null,p(e(i)("cron.task.scriptModal.copyBtn")),1)]),_:1})),e(l)?w("",!0):(a(),c(y,{key:2,trigger:"hover"},{trigger:t(()=>[o(h,{text:"",size:"tiny",type:"primary",focusable:!1,onClick:V},{icon:t(()=>[o(e(_),{size:16},{default:t(()=>[o($)]),_:1})]),_:1})]),default:t(()=>[u("span",null,p(e(i)("cron.task.scriptModal.wordWrapBtn")),1)]),_:1}))]),_:1})]),default:t(()=>[e(l)?(a(),c(G,{key:0,text:"",repeat:27,height:"16px"})):(a(),c(F,{key:1,bordered:!1,style:{height:"100%","word-break":"unset"},"content-style":"height: 100%; padding: 0"},{default:t(()=>[o(D,{"x-scrollable":"",style:{"max-height":"600px",height:"100%"}},{default:t(()=>[o(P,{code:e(E),language:e(I),"show-line-numbers":e(M),"word-wrap":e(B),style:{"font-size":"15px",height:"100%",padding:"1em 0 1em 0"}},null,8,["code","language","show-line-numbers","word-wrap"])]),_:1})]),_:1}))]),_:1},8,["show","style"])}}});export{He as _};
