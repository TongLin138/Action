var c=(p,a,n)=>new Promise((u,e)=>{var d=r=>{try{o(n.next(r))}catch(i){e(i)}},l=r=>{try{o(n.throw(r))}catch(i){e(i)}},o=r=>r.done?u(r.value):Promise.resolve(r.value).then(d,l);o((n=n.apply(p,a)).next())});import{u as w,_ as f}from"./useForm-d8214575.js";import{d as _,bB as y,j as P,z as h,b,B as v,o as B,p as N,at as q,v as E,a as I,e as k,e6 as S}from"./index-797c0a85.js";const V={class:"grid grid-cols-1 grid-flow-row-dense md:grid-cols-[450px_1fr] gap-4"},C=_({__name:"PasswordChange",setup(p){const a=y(),n=P(()=>a.getUserInfo),{message:u}=h(),{t:e}=b(),d=[{field:"username",component:"NInput",label:e("setting.identity.username"),required:!0,componentProps:{placeholder:e("setting.identity.placeholder.userName")},defaultValue:n.value.username,rules:[{required:!0,validator(t,s){return s?!0:new Error(e("setting.identity.error.userNameEmpty"))},trigger:["input","blur"]}]},{field:"password",component:"NInput",label:e("setting.identity.newPassword"),required:!0,componentProps:{placeholder:e("setting.identity.placeholder.newPassword"),type:"password",showPasswordOn:"click"},rules:[{required:!0,validator(t,s){return s?!0:new Error(e("setting.identity.error.newPasswordEmpty"))},trigger:["input","blur"]}]},{field:"confirmPassword",component:"NInput",label:e("setting.identity.confirmnewPassword"),required:!0,componentProps:{type:"password",placeholder:e("setting.identity.placeholder.confirmnewPassword"),showPasswordOn:"click"},rules:[{required:!0,validator(t,s){return r().password!==s?new Error(e("setting.identity.error.confirmnewPasswordDiff")):!0},trigger:["input","blur"]}]}],[l,{setFieldsValue:o,getFieldsValue:r,validate:i}]=w({schemas:d,labelPlacement:"top",gridProps:{cols:3,xGap:6},giProps:{span:2},submitButtonText:e("setting.identity.button.confirm")}),m=t=>c(this,null,function*(){yield i(),yield S({username:t.username,password:t.password}),u.warning(e("setting.identity.message.msgOk"));try{setTimeout(()=>{a.logout(!0)},2e3)}catch(s){}});return v(()=>c(this,null,function*(){o({})})),(t,s)=>{const g=f;return B(),N("div",null,[q(t.$slots,"title"),E("div",V,[I(g,{onRegister:k(l),onSubmit:m},null,8,["onRegister"])])])}}});export{C as _};
