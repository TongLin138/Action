import{c as F,_ as L}from"./index-35fc6cad.js";import{_ as M}from"./history-a2e47617.js";import{c as V,b as $}from"./index-bbe7d773.js";import{u as j}from"./useAppInject-315274ec.js";import{j as A,a as E}from"./file-a0aae56a.js";import G from"./loading-ed142cca.js";import{G as H,x as J,r as O,I as P,a6 as o,a7 as a,a8 as t,ac as r,u as e,aJ as x,aL as b,aC as N,aD as T,as as U,aw as I,aE as q,am as K,aN as Q,bD as W,bf as X,bH as Y,bu as Z}from"./vendor-605eddea.js";const ee={key:1},_e=H({__name:"historyModal",setup(ne,{expose:C}){const{message:p}=V(),{t:l}=$(),{getIsMobile:i}=j(),v=J(null),s=O({show:!1,loading:!0,log:""}),{show:u,loading:m,log:y}=P(s),D=async c=>{s.log="",s.loading=!0,s.show=!0;try{s.log=await z(c.logPath,c.running_status)}finally{s.loading=!1}},z=async(c,_)=>{const n=await A(c);if(n.children&&n.children.length){n.children.sort((d,f)=>{const h=d.name.replace(".log","").replace(/-/g,"");return f.name.replace(".log","").replace(/-/g,"")-h});const g=_&&n.children[1]?n.children[1]:n.children[0];return await E({path:g.path})}return p.warning(l("cron.task.message.no_latest_log")),""},R=()=>{F(s.log)?p.success(l("common.copyOk")):p.error(l("common.copyFail"))};return C({open:D}),(c,_)=>{const n=M,g=L,k=K,d=Q,f=W,h=X,w=Y,S=Z;return o(),a(S,{show:e(u),"onUpdate:show":_[0]||(_[0]=B=>q(u)?u.value=B:null),preset:"dialog","auto-focus":!1,style:I({width:e(i)?"100vw":"600px",padding:e(i)?"16px":""})},{icon:t(()=>[r(e(x),null,{default:t(()=>[e(m)?(o(),a(G,{key:0})):(o(),a(n,{key:1,style:{"vertical-align":"0"}}))]),_:1})]),header:t(()=>[r(d,null,{default:t(()=>[b(N(e(l)("cron.task.history"))+" ",1),e(m)?T("",!0):(o(),a(k,{key:0,text:"",size:"tiny",type:"primary",focusable:!1,onClick:R},{icon:t(()=>[r(e(x),null,{default:t(()=>[r(g)]),_:1})]),_:1}))]),_:1})]),default:t(()=>[e(m)?(o(),a(f,{key:0,text:"",repeat:27,height:"16px"})):(o(),U("div",ee,[e(y)?(o(),a(w,{key:1,ref_key:"logInstRef",ref:v,log:e(y),"line-height":1.5,"font-size":e(i)?14:15,language:"naive-log",style:I(`padding-top: 1em; width: 100%; height: ${e(i)?"650px":"600px"}`)},null,8,["log","line-height","font-size","style"])):(o(),a(h,{key:0},{default:t(()=>[b(N(e(l)("common.noData")),1)]),_:1}))]))]),_:1},8,["show","style"])}}});export{_e as _};
