import{a6 as u,as as W,aG as _,G as Ee,x as r,C as Oe,aI as Se,a7 as m,a8 as t,ac as o,u as e,aQ as k,aC as T,aD as $,aK as ce,aE as Q,aJ as h,al as d,y as de,bd as Fe,am as Ze,aN as Ae,b3 as He,bj as We,a$ as je,bk as Ve,ba as Ge,bl as Je,bm as Ue,bE as Qe,bo as Xe,aR as Ye,bp as Ke,aH as et}from"./vendor-a7094419.js";import{_ as tt}from"./PageWrapper.vue_vue_type_style_index_0_lang-dba4c827.js";import{l as pe,k as nt,f as _e,a as ot,g as lt,h as at,_ as st,b as rt,c as it,d as ut,e as ct}from"./filePrefix-0d69ca7d.js";import{_ as dt}from"./search2-line-76aff846.js";import{_ as pt}from"./map-outline-d0673865.js";import{d as ge,a as X,b as me,_ as _t}from"./delete-e9cffb9d.js";import{c as gt,b as mt,L as H,k as fe,_ as ft}from"./index-c5daf99f.js";import{u as ht}from"./useAppInject-582724ea.js";import{u as vt}from"./useTransition-50591bac.js";import{F as yt}from"./fileTreeEnum-8c192873.js";import"./sharp-arrow-back-ios-13cc3b11.js";import"./useDesign-01a81f9b.js";import"./propTypes-8a448afd.js";import"./trash-2409ad47.js";const kt={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"},bt=_("path",{fill:"currentColor",d:"M12 20q-3.35 0-5.675-2.325T4 12q0-3.35 2.325-5.675T12 4q1.725 0 3.3.712T18 6.75V5q0-.425.288-.713T19 4q.425 0 .713.288T20 5v5q0 .425-.288.713T19 11h-5q-.425 0-.713-.288T13 10q0-.425.288-.713T14 9h3.2q-.8-1.4-2.188-2.2T12 6Q9.5 6 7.75 7.75T6 12q0 2.5 1.75 4.25T12 18q1.7 0 3.113-.863t2.187-2.312q.2-.35.563-.487t.737-.013q.4.125.575.525t-.025.75q-1.025 2-2.925 3.2T12 20Z"},null,-1),wt=[bt];function Tt(P,p){return u(),W("svg",kt,wt)}const xt={name:"material-symbols-refresh-rounded",render:Tt},Ct={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"},Dt=_("path",{fill:"currentColor",d:"m18.031 16.617l4.283 4.282l-1.415 1.415l-4.282-4.283A8.96 8.96 0 0 1 11 20c-4.968 0-9-4.032-9-9s4.032-9 9-9s9 4.032 9 9a8.96 8.96 0 0 1-1.969 5.617Zm-2.006-.742A6.977 6.977 0 0 0 18 11c0-3.867-3.133-7-7-7s-7 3.133-7 7s3.133 7 7 7a6.977 6.977 0 0 0 4.875-1.975l.15-.15ZM10 10V7h2v3h3v2h-3v3h-2v-3H7v-2h3Z"},null,-1),$t=[Dt];function Mt(P,p){return u(),W("svg",Ct,$t)}const Lt={name:"ri-zoom-in-line",render:Mt},Nt={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"},Rt=_("path",{fill:"currentColor",d:"m18.031 16.617l4.283 4.282l-1.415 1.415l-4.282-4.283A8.96 8.96 0 0 1 11 20c-4.968 0-9-4.032-9-9s4.032-9 9-9s9 4.032 9 9a8.96 8.96 0 0 1-1.969 5.617Zm-2.006-.742A6.977 6.977 0 0 0 18 11c0-3.867-3.133-7-7-7s-7 3.133-7 7s3.133 7 7 7a6.977 6.977 0 0 0 4.875-1.975l.15-.15ZM7 10h8v2H7v-2Z"},null,-1),qt=[Rt];function zt(P,p){return u(),W("svg",Nt,qt)}const Pt={name:"ri-zoom-out-line",render:zt},It={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"},Bt=_("g",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"},[_("path",{d:"M21 12V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14c0 1.1.9 2 2 2h7.5M16 2v4M8 2v4m-5 4h18"}),_("path",{d:"M18 21a3 3 0 1 0 0-6a3 3 0 0 0 0 6v0Zm4 1l-1.5-1.5"})],-1),Et=[Bt];function Ot(P,p){return u(),W("svg",It,Et)}const St={name:"lucide-calendar-search",render:Ot},Ft={class:"pb-1 mr-3"},Zt={class:"pb-1 mr-3"},At=Ee({__name:"index",setup(P){const{message:p,confirm:he}=gt(),{getIsMobile:b}=ht(),{t:a}=mt(),j=r("fade-slide");vt(j);const V=r([]),x=r(""),f=r(""),ve=r(),I=r(!b.value),B=r(b.value?"on":"off"),G=r(null),C=r(b.value?13:15),q=r(null),Y=r([]),K=r(0),ee=r(0),D=r(!1),E=r(!1),O=r(!1),J=r(void 0),S=r(!0),F=r(!1),U=r(!1),Z=r(!1),v=r(null),y=r(null),g=async l=>{switch(l){case"changeToEditor":D.value=!D.value,D.value&&p.info(a("editor.switch.changeToEditorMsg"));break;case"showDateTimeRangePicker":O.value=!O.value;break;case"clickRightClickMenu":E.value=!1;break;case"exitRightClickMenu":E.value=!1,M("rightClickMenu");break;case"enlarge":C.value<24?C.value+=1:C.value===24&&p.info(a("page.runLog.enlargeMaxMsg"));break;case"narrow":C.value>12?C.value-=1:C.value===12&&p.info(a("page.runLog.narrowMinMsg"));break;case"refresh":if(U.value=!0,v.value){const L=f.value;oe(v.value.key),L===f.value?p.info(a("page.runLog.logContentIsLatestMsg")):de(()=>{G.value?.scrollTo({position:"bottom",slient:!0})})}A(),U.value=!1;break;case"wordWrap":B.value=B.value==="on"?"off":"on";break;case"minimap":I.value=!I.value;break;case"requireJump":if(Z.value)return;Z.value=!0,setTimeout(()=>{Z.value=!1},1e3);break;case"delete":const n=y.value?y.value.key:v.value.key;he.error({title:a("file.delete.title"),content:a("file.delete.confirm"),icon:()=>d(h,null,{default:()=>d(X)}),closable:!1,maskClosable:!1,autoFocus:!1,positiveText:a("file.delete.button"),onPositiveClick:async()=>{try{await nt({path:n}),p.success(a("file.delete.success")),v.value&&v.value.key===n&&(M("log"),M("content"),D.value=!1),A()}catch{}finally{M("rightClickMenu")}},onNegativeClick:()=>{M("rightClickMenu")},negativeButtonProps:{ghost:!1,tertiary:!0}});break;case"download":const i=y.value?y.value.key:v.value.key,s=y.value?y.value.label:v.value.label,z=y.value?y.value.isDir:v.value.isDir,w=p.loading(a("file.download.wait"),{duration:0});try{if(z){const{code:L,message:N,blob:R}=await pe({path:i});w.destroy(),L?(p.success(a("file.download.success")),R&&me(R,`${s}.zip`)):N&&p.error(N)}else{const{code:L,message:N,blob:R}=await pe({path:i});w.destroy(),L?(p.success(a("file.download.success")),R&&me(R,`${s}.log`)):N&&p.error(N)}}catch{w.destroy(),p.error(a("file.download.fail"),{keepAliveOnHover:!0})}finally{M("rightClickMenu")}break}},ye={[a("page.runLog.dateTimePicker.today")]:()=>{const l=new Date().getTime();return[new Date().setHours(0,0,0,0),l]},[a("page.runLog.dateTimePicker.thisWeek")]:()=>{const l=new Date().getTime(),n=new Date().setHours(0,0,0,0),i=new Date().getDay();return[n-(i-1)*24*60*60*1e3,l]},[a("page.runLog.dateTimePicker.last2Hours")]:()=>{const l=new Date().getTime();return[l-2*60*60*1e3,l]},[a("page.runLog.dateTimePicker.last24Hours")]:()=>{const l=new Date().getTime();return[l-24*60*60*1e3,l]}},ke=l=>l>Date.now(),be=l=>{l||p.info(a("page.runLog.needSelectDateTimeRangeMsg"))},we=l=>d(k,{placement:"right",delay:500,duration:500,style:{width:"max-content",fontSize:"12px"}},{trigger:()=>[l.option.label],default:()=>l.option.key}),te=({option:l})=>({onClick(){!l.children&&!l.disabled&&(J.value=!0,oe(l.key),de(()=>{G.value?.scrollTo({position:"top",slient:!0})}),v.value=l)},onContextmenu(n){b.value||(Y.value=xe(),E.value=!0,K.value=n.clientX,ee.value=n.clientY,n.preventDefault()),y.value=l}}),ne=(l,n,i)=>{if(i.node)switch(i.action){case"expand":i.node.prefix=()=>d(h,null,{default:()=>d(ot)});break;case"collapse":i.node.prefix=()=>d(h,null,{default:()=>d(_e)});break}},Te=l=>{const n=i=>{i.length&&i.forEach(s=>{if(s.type===0)Object.assign(s,{key:s.path,label:s.title,isDir:!0,prefix:()=>d(h,null,{default:()=>d(_e)})}),n(s.children),s.children.length||(Object.assign(s,{children:null,disabled:!0}),s.prefix=()=>d(h,null,{default:()=>d(ut)}));else{const z=s.name.replace(".log","");z&&Object.assign(s,{key:s.path,label:z,isDir:!1,prefix:()=>d(h,null,{default:()=>d(ct)})})}})};return n(l),l},A=async()=>{S.value=!0;const l=Array.isArray(q.value)?q.value:[],n=l[0]?fe(l[0]):"",i=l[1]?fe(l[1]):"",s=await lt({type:yt.LOG,startTime:n,endTime:i});V.value=Te(s),S.value=!1},oe=async l=>{F.value=!0;const n=encodeURI(l),i=await at({path:n});F.value=!1,i?f.value=i:(M("log"),p.info(a("page.runLog.logContentIsEmptyMsg")))},xe=()=>{const l={download:{label:a("file.download.button"),key:"download",icon:()=>d(h,null,{default:()=>d(ge)}),props:{onClick:()=>{g("download")}}},delete:{label:()=>d(Fe,{style:{color:"var(--app-error-color)"}},{default:()=>a("file.delete.button")}),key:"delete",icon:()=>d(h,{color:"var(--app-error-color)"},{default:()=>d(X)}),props:{onClick:()=>{g("delete")}}}};return[l.download,l.delete]},M=l=>{switch(l){case"log":f.value="";break;case"content":v.value=null;break;case"rightClickMenu":y.value=null;break}};return Oe(q,()=>{A()}),Se(()=>{A()}),(l,n)=>{const i=_t,s=Ze,z=St,w=Ae,L=He,N=pt,R=st,Ce=Pt,De=Lt,$e=xt,Me=We,le=dt,ae=je,se=Ve,Le=Ge,re=Je,ie=Ue,Ne=Qe,Re=rt,ue=Xe,qe=it,ze=Ye,Pe=Ke,Ie=et,Be=tt;return u(),m(Be,{ref:"pageWrapper","content-full":!0,title:e(a)("routes.main.page.runLog")},{subtitle:t(()=>[o(w,null,{default:t(()=>[o(w,{style:{gap:"0"}},{default:t(()=>[o(e(k),{placement:"bottom",trigger:"hover",delay:500},{trigger:t(()=>[o(s,{circle:"",strong:"",quaternary:"",size:"small",disabled:!e(f),type:e(D)?"primary":"tertiary",focusable:!1,onClick:n[0]||(n[0]=c=>g("changeToEditor"))},{default:t(()=>[o(i)]),_:1},8,["disabled","type"])]),default:t(()=>[_("span",null,T(e(a)("editor.switch.changeToEditorTips")),1)]),_:1}),e(b)?$("",!0):(u(),m(e(k),{key:0,placement:"bottom",trigger:"hover",delay:500},{trigger:t(()=>[o(s,{circle:"",strong:"",quaternary:"",size:"small",type:e(O)?"primary":"tertiary",focusable:!1,onClick:n[1]||(n[1]=c=>g("showDateTimeRangePicker"))},{default:t(()=>[o(z)]),_:1},8,["type"])]),default:t(()=>[_("span",null,T(e(a)("page.runLog.dateTimeRangeSearchTips")),1)]),_:1}))]),_:1}),e(O)?(u(),m(ce,{key:0,name:e(j),mode:"out-in",appear:""},{default:t(()=>[o(L,{value:e(q),"onUpdate:value":n[2]||(n[2]=c=>Q(q)?q.value=c:null),size:"small",type:"datetimerange",clearable:"",shortcuts:ye,"is-date-disabled":ke,"on-confirm":be},null,8,["value"])]),_:1},8,["name"])):$("",!0)]),_:1})]),extra:t(()=>[o(ce,{name:e(j),mode:"out-in",appear:""},{default:t(()=>[o(w,null,{default:t(()=>[e(D)?(u(),m(w,{key:0,style:{gap:"0"}},{default:t(()=>[e(b)?(u(),m(e(k),{key:0,placement:"bottom",trigger:"hover",delay:500},{trigger:t(()=>[o(s,{strong:"",quaternary:"",type:e(I)?"primary":"tertiary",size:"small",focusable:!1,onClick:n[3]||(n[3]=c=>g("minimap"))},{default:t(()=>[o(N)]),_:1},8,["type"])]),default:t(()=>[_("span",null,T(e(a)("editor.switch.minimapTips")),1)]),_:1})):$("",!0),o(e(k),{placement:"bottom",trigger:"hover",delay:500},{trigger:t(()=>[o(s,{strong:"",quaternary:"",size:"small",disabled:!e(f)||!e(D),type:e(B)==="on"?"primary":"tertiary",focusable:!1,onClick:n[4]||(n[4]=c=>g("wordWrap"))},{default:t(()=>[o(R)]),_:1},8,["disabled","type"])]),default:t(()=>[_("span",null,T(e(a)("editor.switch.wordWrapTips")),1)]),_:1})]),_:1})):$("",!0),o(w,{style:{gap:"0"}},{default:t(()=>[o(Me,null,{default:t(()=>[e(f)&&!e(b)?(u(),m(e(k),{key:0,placement:"bottom",trigger:"hover",delay:500},{trigger:t(()=>[o(s,{strong:"",secondary:"",size:"small",focusable:!1,onClick:n[5]||(n[5]=c=>g("download"))},{icon:t(()=>[o(e(ge))]),_:1})]),default:t(()=>[_("span",null,T(e(a)("file.download.button")),1)]),_:1})):$("",!0),e(f)?(u(),m(e(k),{key:1,placement:"bottom",trigger:"hover",delay:500},{trigger:t(()=>[o(s,{strong:"",secondary:"",size:"small",focusable:!1,onClick:n[6]||(n[6]=c=>g("delete"))},{icon:t(()=>[o(e(X))]),_:1})]),default:t(()=>[_("span",null,T(e(a)("file.delete.button")),1)]),_:1})):$("",!0),e(f)?(u(),m(e(k),{key:2,placement:"bottom",trigger:"hover",delay:500},{trigger:t(()=>[o(s,{strong:"",secondary:"",size:"small",focusable:!1,onClick:n[7]||(n[7]=c=>g("narrow"))},{icon:t(()=>[o(e(h),null,{default:t(()=>[o(Ce,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1})]),default:t(()=>[_("span",null,T(e(a)("page.runLog.narrowButtonTips")),1)]),_:1})):$("",!0),e(f)?(u(),m(e(k),{key:3,placement:"bottom",trigger:"hover",delay:500},{trigger:t(()=>[o(s,{strong:"",secondary:"",size:"small",focusable:!1,onClick:n[8]||(n[8]=c=>g("enlarge"))},{icon:t(()=>[o(e(h),null,{default:t(()=>[o(De,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1})]),default:t(()=>[_("span",null,T(e(a)("page.runLog.enlargeButtonTips")),1)]),_:1})):$("",!0),o(e(k),{placement:"bottom",trigger:"hover",delay:500},{trigger:t(()=>[o(s,{strong:"",secondary:"",size:"small",loading:e(U),focusable:!1,onClick:n[9]||(n[9]=c=>g("refresh"))},{icon:t(()=>[o(e(h),null,{default:t(()=>[o($e,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1},8,["loading"])]),default:t(()=>[_("span",null,T(e(a)("page.runLog.refreshButtonTips")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["name"])]),default:t(()=>[o(Ie,{bordered:!e(b),style:{height:"100%","word-break":"unset"},"content-style":"padding: 0; height: 100%"},{default:t(()=>[o(Pe,{"has-sider":"",style:{height:"100%"},"content-style":"height: 100%"},{default:t(()=>[e(b)?(u(),m(ie,{key:1,bordered:!1,width:"100%","trigger-style":"margin-right: .75em","collapsed-trigger-style":"margin-right: -0.75em","collapsed-width":0,"show-collapsed-content":!1,"show-trigger":"arrow-circle",collapsed:e(J),"on-update:collapsed":J.value=void 0,"native-scrollbar":!1,"content-style":"display: flex; flex-direction: column; height: 100%; padding: .8em 0 0 .8em",class:"logs-container"},{default:t(()=>[_("div",Zt,[o(ae,{value:e(x),"onUpdate:value":n[13]||(n[13]=c=>Q(x)?x.value=c:null),clearable:"",size:"small",style:{"margin-bottom":".5em"},placeholder:e(a)("page.runLog.searchInputPlaceholder")},{prefix:t(()=>[o(le)]),_:1},8,["value","placeholder"])]),o(re,{"x-scrollable":"",class:"flex-1 pr-3"},{default:t(()=>[o(se,{"expand-on-click":"","block-line":"","node-props":te,pattern:e(x),data:e(V),"show-irrelevant-nodes":!1,"on-update:expanded-keys":ne,style:{height:"100%","font-size":"16px"}},null,8,["pattern","data"])]),_:1}),o(H,{show:e(S)},null,8,["show"])]),_:1},8,["collapsed","on-update:collapsed"])):(u(),m(ie,{key:0,bordered:"",width:"280","trigger-style":"width: 34px","collapsed-width":0,"show-collapsed-content":!1,"show-trigger":"bar","native-scrollbar":!1,"content-style":"display: flex; flex-direction: column; height: 100%; padding: .8em 0 0 .8em",class:"logs-container"},{default:t(()=>[_("div",Ft,[o(ae,{value:e(x),"onUpdate:value":n[10]||(n[10]=c=>Q(x)?x.value=c:null),clearable:"",style:{"margin-bottom":".5em"},placeholder:e(a)("page.runLog.searchInputPlaceholder")},{prefix:t(()=>[o(le)]),_:1},8,["value","placeholder"])]),o(re,{"x-scrollable":"",class:"flex-1 pr-3"},{default:t(()=>[o(se,{"expand-on-click":"","block-line":"","node-props":te,pattern:e(x),data:e(V),"render-label":we,"show-irrelevant-nodes":!1,"on-update:expanded-keys":ne,style:{height:"100%"}},null,8,["pattern","data"]),o(Le,{trigger:"manual",placement:"bottom-start",show:e(E),options:e(Y),x:e(K),y:e(ee),onSelect:n[11]||(n[11]=c=>g("clickRightClickMenu")),onClickoutside:n[12]||(n[12]=c=>g("exitRightClickMenu"))},null,8,["show","options","x","y"])]),_:1}),o(H,{show:e(S)},null,8,["show"])]),_:1})),e(f)?(u(),m(ue,{key:2,style:{overflow:"auto"}},{default:t(()=>[e(D)?(u(),m(Re,{key:1,ref_key:"editor",ref:ve,style:{height:"100%",padding:"0"},value:e(f),language:"plaintext","word-wrap":e(B),"font-size":e(C),"read-only":!0,minimap:e(I)},null,8,["value","word-wrap","font-size","minimap"])):(u(),m(Ne,{key:0,ref_key:"logInstRef",ref:G,log:e(f),loading:e(Z),"font-size":e(C),"line-height":1.5,language:"naive-log",style:{padding:"1em 0 1em 1.6em",width:"100%",height:"100%"},onRequireTop:n[14]||(n[14]=c=>g("requireJump")),onRequireBottom:n[15]||(n[15]=c=>g("requireJump"))},null,8,["log","loading","font-size","line-height"])),o(H,{show:e(F)},null,8,["show"])]),_:1})):(u(),m(ue,{key:3},{default:t(()=>[o(ze,{class:"min-h-200px flex-jc-ac h-full",size:"huge",description:e(a)("common.selectFileEmptyDesc")},{icon:t(()=>[o(e(h),null,{default:t(()=>[o(qe)]),_:1})]),_:1},8,["description"]),o(H,{show:e(F)},null,8,["show"])]),_:1}))]),_:1})]),_:1},8,["bordered"])]),_:1},8,["title"])}}});const on=ft(At,[["__scopeId","data-v-34da0a84"]]);export{on as default};
