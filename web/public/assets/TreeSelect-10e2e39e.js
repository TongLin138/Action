import{R as je,P as E,Q as ne,b1 as De,d as ze,r as v,G as $e,c2 as We,J as V,j as s,V as He,S as oe,d4 as Ge,I as Je,bW as Qe,h as u,D as Ze,ad as qe,cC as Xe,K as Ye,M as et,Z as b,cD as tt,d5 as nt}from"./index-797c0a85.js";import{c as at,u as lt,_ as ot,t as rt,a as it}from"./Tree-c1a4f7b1.js";import{u as dt}from"./use-locale-3967e664.js";import{u as L,c as j,V as st,j as ut,k as ct}from"./Tooltip-271e10cc.js";import{c as ft,h as ht,_ as gt}from"./Empty-aa248199.js";import{N as vt}from"./Selection-a7bafa19.js";import{F as mt}from"./FocusDetector-effeeed3.js";import{u as yt}from"./use-resize-d169ca1a.js";function ae(t,m){const{rawNode:i}=t;return Object.assign(Object.assign({},i),{label:i[m],value:t.key})}function le(t,m,i,c){const{rawNode:d}=t;return Object.assign(Object.assign({},d),{value:t.key,label:m.map(x=>x.rawNode[c]).join(i)})}const bt=je([E("tree-select",`
 z-index: auto;
 outline: none;
 width: 100%;
 position: relative;
 `),E("tree-select-menu",`
 position: relative;
 overflow: hidden;
 margin: 4px 0;
 transition: box-shadow .3s var(--n-bezier), background-color .3s var(--n-bezier);
 border-radius: var(--n-menu-border-radius);
 box-shadow: var(--n-menu-box-shadow);
 background-color: var(--n-menu-color);
 outline: none;
 `,[E("tree","max-height: var(--n-menu-height);"),ne("empty",`
 display: flex;
 padding: 12px 32px;
 flex: 1;
 justify-content: center;
 `),ne("action",`
 padding: var(--n-action-padding);
 transition: 
 color .3s var(--n-bezier);
 border-color .3s var(--n-bezier);
 border-top: 1px solid var(--n-action-divider-color);
 color: var(--n-action-text-color);
 `),De()])]),pt=Object.assign(Object.assign(Object.assign(Object.assign({},oe.props),{bordered:{type:Boolean,default:!0},cascade:Boolean,checkable:Boolean,clearable:Boolean,clearFilterAfterSelect:{type:Boolean,default:!0},consistentMenuWidth:{type:Boolean,default:!0},defaultShow:Boolean,defaultValue:{type:[String,Number,Array],default:null},disabled:{type:Boolean,default:void 0},filterable:Boolean,checkStrategy:{type:String,default:"all"},loading:Boolean,maxTagCount:[String,Number],multiple:Boolean,showPath:Boolean,separator:{type:String,default:" / "},options:{type:Array,default:()=>[]},placeholder:String,placement:{type:String,default:"bottom-start"},show:{type:Boolean,default:void 0},size:String,value:[String,Number,Array],to:j.propTo,menuProps:Object,virtualScroll:{type:Boolean,default:!0},status:String,renderTag:Function}),rt),{renderLabel:Function,renderPrefix:Function,renderSuffix:Function,nodeProps:Function,onBlur:Function,onFocus:Function,onLoad:Function,onUpdateShow:[Function,Array],onUpdateValue:[Function,Array],"onUpdate:value":[Function,Array],"onUpdate:show":[Function,Array],leafOnly:Boolean}),Ct=ze({name:"TreeSelect",props:pt,setup(t){const m=v(null),i=v(null),c=v(null),d=v(null),{mergedClsPrefixRef:x,namespaceRef:I,inlineThemeDisabled:h}=$e(t),{localeRef:M}=dt("Select"),{mergedSizeRef:C,mergedDisabledRef:A,mergedStatusRef:re,nTriggerFormBlur:ie,nTriggerFormChange:de,nTriggerFormFocus:se,nTriggerFormInput:ue}=We(t),D=v(t.defaultValue),ce=V(t,"value"),p=L(ce,D),z=v(t.defaultShow),fe=V(t,"show"),S=L(fe,z),T=v(""),he=s(()=>{const{filter:e}=t;if(e)return e;const{labelField:n}=t;return(l,a)=>l.length?a[n].toLowerCase().includes(l.toLowerCase()):!0}),w=s(()=>ft(t.options,at(t.keyField,t.childrenField,t.disabledField,void 0))),{value:O}=p,$=v(t.checkable?null:Array.isArray(O)&&O.length?O[O.length-1]:null),P=s(()=>t.multiple&&t.cascade&&t.checkable),W=v(t.defaultExpandAll?void 0:t.defaultExpandedKeys||t.expandedKeys),ge=V(t,"expandedKeys"),ve=L(ge,W),F=v(!1),me=s(()=>{const{placeholder:e}=t;return e!==void 0?e:M.value.placeholder}),ye=s(()=>t.checkable?[]:H.value),H=s(()=>{const{value:e}=p;return t.multiple?Array.isArray(e)?e:[]:e===null||Array.isArray(e)?[]:[e]}),be=s(()=>{const{multiple:e,showPath:n,separator:l,labelField:a}=t;if(e)return null;const{value:o}=p;if(!Array.isArray(o)&&o!==null){const{value:r}=w,g=r.getNode(o);if(g!==null)return n?le(g,r.getPath(o).treeNodePath,l,a):ae(g,a)}return null}),pe=s(()=>{const{multiple:e,showPath:n,separator:l}=t;if(!e)return null;const{value:a}=p;if(Array.isArray(a)){const o=[],{value:r}=w,{checkedKeys:g}=r.getCheckedKeys(a,{checkStrategy:t.checkStrategy,cascade:P.value,allowNotLoaded:t.allowCheckingNotLoaded}),{labelField:f}=t;return g.forEach(te=>{const U=r.getNode(te);U!==null&&o.push(n?le(U,r.getPath(te).treeNodePath,l,f):ae(U,f))}),o}return[]}),Se=s(()=>{const{self:{menuPadding:e}}=B.value;return e});function _(){var e;(e=i.value)===null||e===void 0||e.focus()}function G(){var e;(e=i.value)===null||e===void 0||e.focusInput()}function J(e){const{onUpdateShow:n,"onUpdate:show":l}=t;n&&b(n,e),l&&b(l,e),z.value=e}function k(e,n,l){const{onUpdateValue:a,"onUpdate:value":o}=t;a&&b(a,e,n,l),o&&b(o,e,n,l),D.value=e,ue(),de()}function we(e,n){const{onUpdateIndeterminateKeys:l,"onUpdate:indeterminateKeys":a}=t;l&&b(l,e,n),a&&b(a,e,n)}function ke(e,n,l){const{onUpdateExpandedKeys:a,"onUpdate:expandedKeys":o}=t;a&&b(a,e,n,l),o&&b(o,e,n,l),W.value=e}function Q(e){const{onFocus:n}=t;n&&n(e),se()}function Z(e){y();const{onBlur:n}=t;n&&n(e),ie()}function y(){J(!1)}function N(){A.value||(T.value="",J(!0),t.filterable&&G())}function Ke(){T.value=""}function xe(e){var n;S.value&&(!((n=i.value)===null||n===void 0)&&n.$el.contains(tt(e))||y())}function Re(){A.value||(S.value?t.filterable||y():N())}function K(e){const{value:{getNode:n}}=w;return e.map(l=>{var a;return((a=n(l))===null||a===void 0?void 0:a.rawNode)||null})}function Te(e,n,l){const a=K(e),o=l.action==="check"?"select":"unselect",r=l.node;t.multiple?(k(e,a,{node:r,action:o}),t.filterable&&(G(),t.clearFilterAfterSelect&&(T.value=""))):(e.length?k(e[0],a[0]||null,{node:r,action:o}):k(null,null,{node:r,action:o}),y(),_())}function Fe(e){t.checkable&&we(e,K(e))}function Ce(e){var n;!((n=d.value)===null||n===void 0)&&n.contains(e.relatedTarget)||(F.value=!0,Q(e))}function Oe(e){var n;!((n=d.value)===null||n===void 0)&&n.contains(e.relatedTarget)||(F.value=!1,Z(e))}function Pe(e){var n,l,a;!((n=d.value)===null||n===void 0)&&n.contains(e.relatedTarget)||!((a=(l=i.value)===null||l===void 0?void 0:l.$el)===null||a===void 0)&&a.contains(e.relatedTarget)||(F.value=!0,Q(e))}function _e(e){var n,l,a;!((n=d.value)===null||n===void 0)&&n.contains(e.relatedTarget)||!((a=(l=i.value)===null||l===void 0?void 0:l.$el)===null||a===void 0)&&a.contains(e.relatedTarget)||(F.value=!1,Z(e))}function Ie(e){e.stopPropagation();const{multiple:n}=t;!n&&t.filterable&&y(),n?k([],[],{node:null,action:"clear"}):k(null,null,{node:null,action:"clear"})}function Me(e){const{value:n}=p;if(Array.isArray(n)){const{value:l}=w,{checkedKeys:a}=l.getCheckedKeys(n,{cascade:P.value,allowNotLoaded:t.allowCheckingNotLoaded}),o=a.findIndex(r=>r===e.value);if(~o){const r=a[o],g=K([r])[0];if(t.checkable){const{checkedKeys:f}=l.uncheck(e.value,a,{checkStrategy:t.checkStrategy,cascade:P.value,allowNotLoaded:t.allowCheckingNotLoaded});k(f,K(f),{node:g,action:"delete"})}else{const f=Array.from(a);f.splice(o,1),k(f,K(f),{node:g,action:"delete"})}}}}function Ae(e){const{value:n}=e.target;T.value=n}function q(e){const{value:n}=c;n&&n.handleKeydown(e)}function Ne(e){e.key==="Enter"?(S.value?(q(e),t.multiple||(y(),_())):N(),e.preventDefault()):e.key==="Escape"?S.value&&(nt(e),y(),_()):S.value?q(e):e.key==="ArrowDown"&&N()}function Be(){y(),_()}function Ue(e){ht(e,"action")||e.preventDefault()}const Ee=s(()=>{const{renderTag:e}=t;if(e)return function({option:l,handleClose:a}){const{value:o}=l;if(o!==void 0){const r=w.value.getNode(o);if(r)return e({option:r.rawNode,handleClose:a})}return o}});He(it,{pendingNodeKeyRef:$,dataTreeMate:w});function X(){var e;S.value&&((e=m.value)===null||e===void 0||e.syncPosition())}yt(d,X);const Ve=lt(t),Y=s(()=>{if(t.checkable){const e=p.value;return t.multiple&&Array.isArray(e)?w.value.getCheckedKeys(e,{cascade:t.cascade,checkStrategy:Ve.value,allowNotLoaded:t.allowCheckingNotLoaded}):{checkedKeys:Array.isArray(e)||e===null?[]:[e],indeterminateKeys:[]}}return{checkedKeys:[],indeterminateKeys:[]}}),Le={getCheckedData:()=>{const{checkedKeys:e}=Y.value;return{keys:e,options:K(e)}},getIndeterminateData:()=>{const{indeterminateKeys:e}=Y.value;return{keys:e,options:K(e)}},focus:()=>{var e;return(e=i.value)===null||e===void 0?void 0:e.focus()},focusInput:()=>{var e;return(e=i.value)===null||e===void 0?void 0:e.focusInput()},blur:()=>{var e;return(e=i.value)===null||e===void 0?void 0:e.blur()},blurInput:()=>{var e;return(e=i.value)===null||e===void 0?void 0:e.blurInput()}},B=oe("TreeSelect","-tree-select",bt,Ge,t,x),ee=s(()=>{const{common:{cubicBezierEaseInOut:e},self:{menuBoxShadow:n,menuBorderRadius:l,menuColor:a,menuHeight:o,actionPadding:r,actionDividerColor:g,actionTextColor:f}}=B.value;return{"--n-menu-box-shadow":n,"--n-menu-border-radius":l,"--n-menu-color":a,"--n-menu-height":o,"--n-bezier":e,"--n-action-padding":r,"--n-action-text-color":f,"--n-action-divider-color":g}}),R=h?Je("tree-select",void 0,ee,t):void 0;return Object.assign(Object.assign({},Le),{menuElRef:d,mergedStatus:re,triggerInstRef:i,followerInstRef:m,treeInstRef:c,mergedClsPrefix:x,mergedValue:p,mergedShow:S,namespace:I,adjustedTo:j(t),isMounted:Qe(),focused:F,menuPadding:Se,mergedPlaceholder:me,mergedExpandedKeys:ve,treeSelectedKeys:ye,treeCheckedKeys:H,mergedSize:C,mergedDisabled:A,selectedOption:be,selectedOptions:pe,pattern:T,pendingNodeKey:$,mergedCascade:P,mergedFilter:he,selectionRenderTag:Ee,handleTriggerOrMenuResize:X,doUpdateExpandedKeys:ke,handleMenuLeave:Ke,handleTriggerClick:Re,handleMenuClickoutside:xe,handleUpdateCheckedKeys:Te,handleUpdateIndeterminateKeys:Fe,handleTriggerFocus:Ce,handleTriggerBlur:Oe,handleMenuFocusin:Pe,handleMenuFocusout:_e,handleClear:Ie,handleDeleteOption:Me,handlePatternInput:Ae,handleKeydown:Ne,handleTabOut:Be,handleMenuMousedown:Ue,mergedTheme:B,cssVars:h?void 0:ee,themeClass:R==null?void 0:R.themeClass,onRender:R==null?void 0:R.onRender})},render(){const{mergedTheme:t,mergedClsPrefix:m,$slots:i}=this;return u("div",{class:`${m}-tree-select`},u(st,null,{default:()=>[u(ut,null,{default:()=>u(vt,{ref:"triggerInstRef",onResize:this.handleTriggerOrMenuResize,status:this.mergedStatus,focused:this.focused,clsPrefix:m,theme:t.peers.InternalSelection,themeOverrides:t.peerOverrides.InternalSelection,renderTag:this.selectionRenderTag,selectedOption:this.selectedOption,selectedOptions:this.selectedOptions,size:this.mergedSize,bordered:this.bordered,placeholder:this.mergedPlaceholder,disabled:this.mergedDisabled,active:this.mergedShow,loading:this.loading,multiple:this.multiple,maxTagCount:this.maxTagCount,showArrow:!0,filterable:this.filterable,clearable:this.clearable,pattern:this.pattern,onPatternInput:this.handlePatternInput,onClear:this.handleClear,onClick:this.handleTriggerClick,onFocus:this.handleTriggerFocus,onBlur:this.handleTriggerBlur,onDeleteOption:this.handleDeleteOption,onKeydown:this.handleKeydown},{arrow:()=>{var c,d;return[(d=(c=this.$slots).arrow)===null||d===void 0?void 0:d.call(c)]}})}),u(ct,{ref:"followerInstRef",show:this.mergedShow,placement:this.placement,to:this.adjustedTo,teleportDisabled:this.adjustedTo===j.tdkey,containerClass:this.namespace,width:this.consistentMenuWidth?"target":void 0,minWidth:"target"},{default:()=>u(Ze,{name:"fade-in-scale-up-transition",appear:this.isMounted,onLeave:this.handleMenuLeave},{default:()=>{var c;if(!this.mergedShow)return null;const{mergedClsPrefix:d,checkable:x,multiple:I,menuProps:h,options:M}=this;return(c=this.onRender)===null||c===void 0||c.call(this),qe(u("div",Object.assign({},h,{class:[`${d}-tree-select-menu`,h==null?void 0:h.class,this.themeClass],ref:"menuElRef",style:[(h==null?void 0:h.style)||"",this.cssVars],tabindex:0,onMousedown:this.handleMenuMousedown,onKeydown:this.handleKeydown,onFocusin:this.handleMenuFocusin,onFocusout:this.handleMenuFocusout}),u(ot,{ref:"treeInstRef",blockLine:!0,allowCheckingNotLoaded:this.allowCheckingNotLoaded,showIrrelevantNodes:!1,animated:!1,pattern:this.pattern,filter:this.mergedFilter,data:M,cancelable:I,labelField:this.labelField,keyField:this.keyField,disabledField:this.disabledField,childrenField:this.childrenField,theme:t.peers.Tree,themeOverrides:t.peerOverrides.Tree,defaultExpandAll:this.defaultExpandAll,defaultExpandedKeys:this.defaultExpandedKeys,expandedKeys:this.mergedExpandedKeys,checkedKeys:this.treeCheckedKeys,selectedKeys:this.treeSelectedKeys,checkable:x,checkStrategy:this.checkStrategy,cascade:this.mergedCascade,leafOnly:this.leafOnly,multiple:this.multiple,renderLabel:this.renderLabel,renderPrefix:this.renderPrefix,renderSuffix:this.renderSuffix,renderSwitcherIcon:this.renderSwitcherIcon,nodeProps:this.nodeProps,virtualScroll:this.consistentMenuWidth&&this.virtualScroll,internalTreeSelect:!0,internalUnifySelectCheck:!0,internalScrollable:!0,internalScrollablePadding:this.menuPadding,internalFocusable:!1,internalCheckboxFocusable:!1,internalRenderEmpty:()=>u("div",{class:`${d}-tree-select-menu__empty`},Ye(i.empty,()=>[u(gt,{theme:t.peers.Empty,themeOverrides:t.peerOverrides.Empty})])),onLoad:this.onLoad,onUpdateCheckedKeys:this.handleUpdateCheckedKeys,onUpdateIndeterminateKeys:this.handleUpdateIndeterminateKeys,onUpdateExpandedKeys:this.doUpdateExpandedKeys}),et(i.action,C=>C?u("div",{class:`${d}-tree-select-menu__action`,"data-action":!0},C):null),u(mt,{onFocus:this.handleTabOut})),[[Xe,this.handleMenuClickoutside,void 0,{capture:!0}]])}})})]}))}});export{Ct as N};
