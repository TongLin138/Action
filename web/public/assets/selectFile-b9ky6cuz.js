var w=(F,b,m)=>new Promise((I,p)=>{var z=s=>{try{g(m.next(s))}catch(o){p(o)}},x=s=>{try{g(m.throw(s))}catch(o){p(o)}},g=s=>s.done?I(s.value):Promise.resolve(s.value).then(z,x);g((m=m.apply(F,b)).next())});import{_ as Y}from"./search2-line-aL20cOYj.js";import{a as Z,_ as ee,d as te}from"./index-mGrCK8oI.js";import{a7 as D,aJ as ne,at as y,H as ae,y as E,r as le,J as oe,u as e,a8 as j,a9 as a,aa as n,aN as h,aE as T,aC as U,aI as C,an as H,aO as A,am as i,aS as se,b3 as ie,bP as pe,bz as ce,aK as re,bG as de,bw as ue,bE as _e,bF as fe}from"./vendor-kg4oYVSQ.js";import{u as he}from"./useAppInject-l82YhPHr.js";import{g as me}from"./file-T6C44nTG.js";import{c as N,f as S,a as ge,b as xe}from"./index-QxLtsnzB.js";import{f as ye}from"./folderEmpty-6rfjvt8J.js";import{f as J}from"./filePrefix-aegAgnbp.js";const be={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"},ve=y("path",{fill:"currentColor",d:"M14 2H6a2 2 0 0 0-2 2v16c0 1.11.89 2 2 2h12c1.11 0 2-.89 2-2V8zm4 18H6V4h7v5h5zm-8.46-4.35l2.09 2.09L10.35 19L7 15.65l3.35-3.35l1.28 1.26zm7.46 0L13.65 19l-1.27-1.26l2.09-2.09l-2.09-2.09l1.27-1.26z"},null,-1),ke=[ve];function we(F,b){return D(),ne("svg",be,[...ke])}const Te={name:"mdi-file-code-outline",render:we},Ce={class:"pb-1 mr-3"},Fe={style:{"vertical-align":"-4px",padding:"0 2px"}},Ie={class:"pb-1 mr-3"},ze=ae({__name:"selectFile",emits:["onConfirmSelect"],setup(F,{expose:b,emit:m}){const I=m,{t:p}=Z(),{getIsMobile:z}=he(),x=E([]),g=E([]),s=E(""),o=le({show:!1,loading:!1,path:"",option:{}}),{show:f,loading:L,path:v,option:O}=oe(o),K=()=>w(this,null,function*(){o.loading=!0,o.show=!0;const r=yield me({}),l=yield G(r);x.value=l,o.loading=!1}),P=()=>{o.show=!1,I("onConfirmSelect",o.option),o.path="",o.option={}},$=(r,l,c)=>{if(!c.node)return;const t=c.node,d=t.title;switch(c.action){case"expand":t.prefix=()=>i(h,null,{default:()=>i(N.open[d]||ge)});break;case"collapse":t.prefix=()=>i(h,null,{default:()=>i(N.close[d]||S)});break}},M=r=>i(se,{placement:"left",delay:1500,duration:500,showArrow:!1,overlap:!0,style:{width:"max-content",fontSize:"12px",right:"26px"}},{trigger:()=>r.option.label,default:()=>r.option.key}),B=(r,l,c)=>w(this,null,function*(){if(c.action!=="select"){o.path="",o.option={};return}const t=c.node;if(t.isDir||t.disabled){o.path="",o.option={};return}o.path=t.key,o.option=t}),G=r=>w(this,null,function*(){const l=c=>{c.length&&c.forEach(t=>{if(t.type===0)Object.assign(t,{key:t.path,label:t.title,isDir:!0,canRun:!1,disabled:!1,icon:()=>i(S),prefix:()=>i(h,null,{default:()=>i(N.close[t.title]||S)})}),l(t.children),t.children.length||(Object.assign(t,{children:null}),t.prefix=()=>i(h,null,{default:()=>i(ye)}));else{const d=t.name;if(d){const k=d.substring(d.lastIndexOf(".")+1),u=xe[k]||{};Object.assign(t,{key:t.path,label:d,isDir:!1,language:u.language||"plaintext",canRun:u.canRun||!1,disabled:u.disabled||!u.language||!u.canRun||!1,icon:()=>i(u.icon||J),prefix:()=>i(h,null,{default:()=>i(u.icon||J)})})}}})};return l(r),r});return b({open:K}),(r,l)=>{const c=Te,t=ee,d=Y,k=ie,u=pe,R=ce,V=re,q=de,Q=ue,W=_e,X=fe;return e(z)?(D(),j(X,{key:1,show:e(f),"onUpdate:show":l[5]||(l[5]=_=>T(f)?f.value=_:null),height:"100vh",width:"100vw",placement:"right","auto-focus":!1,"mask-closable":!1},{default:a(()=>[n(W,{"header-style":"height: 60px; padding: 16px 12px","body-content-style":"padding: 16px 12px; overscroll-behavior: none","footer-style":"padding: 16px 24px"},{header:a(()=>[n(e(U),null,{default:a(()=>[n(e(h),{color:"var(--app-primary-color)"},{default:a(()=>[n(c,{style:{"font-size":"24px","vertical-align":"0"}})]),_:1}),n(Q,{style:{height:"100%","max-width":"260px"}},{tooltip:a(()=>[y("span",null,C(e(p)("page.script.selectFileTitle")),1)]),default:a(()=>[y("span",Fe,C(e(p)("page.script.selectFileTitle")),1)]),_:1})]),_:1})]),footer:a(()=>[n(e(U),null,{default:a(()=>[n(e(H),{tertiary:"",focusable:!1,onClick:l[4]||(l[4]=_=>(f.value=!1,v.value="",O.value={}))},{default:a(()=>[A(C(e(p)("common.cancelText")),1)]),_:1}),n(e(H),{type:"primary",disabled:!e(v),focusable:!1,onClick:P},{default:a(()=>[A(C(e(p)("common.okText")),1)]),_:1},8,["disabled"])]),_:1})]),default:a(()=>[n(t,{show:e(L)},null,8,["show"]),n(V,{bordered:!1,class:"tree-container",style:{height:"calc(100% - 32px)","word-break":"unset"},"content-style":"height: 100%; padding: 0"},{default:a(()=>[y("div",Ie,[n(k,{value:e(s),"onUpdate:value":l[3]||(l[3]=_=>T(s)?s.value=_:null),clearable:"",style:{"margin-bottom":".5em"},placeholder:e(p)("page.script.searchInputPlaceholder")},{prefix:a(()=>[n(d)]),_:1},8,["value","placeholder"])]),n(R,{"x-scrollable":"",class:"flex-1 pr-3",style:{height:"100%"}},{default:a(()=>[n(u,{"expand-on-click":"","block-line":"",style:{"font-size":"15px"},"show-irrelevant-nodes":!1,pattern:e(s),data:e(x),"default-expanded-keys":e(g),"on-update:expanded-keys":$,"on-update:selected-keys":B},null,8,["pattern","data","default-expanded-keys"])]),_:1})]),_:1})]),_:1})]),_:1},8,["show"])):(D(),j(q,{key:0,show:e(f),"onUpdate:show":l[1]||(l[1]=_=>T(f)?f.value=_:null),preset:"dialog","auto-focus":!1,"mask-closable":!1,title:e(p)("page.script.selectFileTitle"),"positive-text":e(p)("common.okText"),"negative-text":e(p)("common.cancelText"),"positive-button-props":{disabled:!e(v)},"negative-button-props":{ghost:!1,tertiary:!0},style:{width:"600px"},onPositiveClick:P,onNegativeClick:l[2]||(l[2]=_=>(v.value="",O.value={}))},{icon:a(()=>[n(e(h),null,{default:a(()=>[n(c,{style:{"font-size":"20px","vertical-align":"0"}})]),_:1})]),default:a(()=>[n(t,{show:e(L)},null,8,["show"]),n(V,{bordered:!1,class:"tree-container",style:{height:"480px","word-break":"unset"},"content-style":"height: 100%; padding: 1em 0 0 0; "},{default:a(()=>[y("div",Ce,[n(k,{value:e(s),"onUpdate:value":l[0]||(l[0]=_=>T(s)?s.value=_:null),clearable:"",style:{"margin-bottom":".5em"},placeholder:e(p)("page.script.searchInputPlaceholder")},{prefix:a(()=>[n(d)]),_:1},8,["value","placeholder"])]),n(R,{"x-scrollable":"",class:"flex-1 pr-3",style:{height:"420px"}},{default:a(()=>[n(u,{"expand-on-click":"","block-line":"",style:{height:"100%"},"show-irrelevant-nodes":!1,pattern:e(s),data:e(x),"default-expanded-keys":e(g),"render-label":M,"on-update:expanded-keys":$,"on-update:selected-keys":B},null,8,["pattern","data","default-expanded-keys"])]),_:1})]),_:1})]),_:1},8,["show","title","positive-text","negative-text","positive-button-props"]))}}}),Re=te(ze,[["__scopeId","data-v-cc44a82e"]]);export{Re as default};
