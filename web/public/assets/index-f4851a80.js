import{a6 as b,as as O,aG as T,G as U,al as I,i as gt,p as _t,x as w,r as Je,aA as ve,aS as yt,I as Qe,t as le,u as a,ah as he,a5 as Ne,aT as et,a7 as H,a8 as p,ac as g,aL as z,aC as V,aU as Re,au as be,aq as Ee,aJ as Y,aV as tt,am as de,aN as nt,aW as vt,aX as st,aQ as ze,aY as bt,aZ as xt,a_ as Ct,C as Ae,h as N,a$ as it,b0 as wt,b1 as kt,b2 as St,b3 as $t,b4 as Tt,b5 as Be,o as ot,y as It,s as Lt,ar as Fe,aD as Z,aB as oe,b6 as Nt,aI as Et,b7 as Ot,b8 as Dt,b9 as Pt,M as se,at as xe,a9 as lt,aa as Rt,av as zt,ba as at,aR as At,bb as Mt,ap as Ht,bc as Bt,aE as Se,aK as Ft,bd as $e,be as Ve,bf as Vt,bg as Gt,bh as Wt,bi as Kt,aH as jt}from"./vendor-a7094419.js";import{_ as Ut}from"./PageWrapper.vue_vue_type_style_index_0_lang-dba4c827.js";import{_ as qt}from"./search2-line-76aff846.js";import{b as Me,_ as He,i as Te,d as G,e as Oe,f as ce,h as fe,j as rt,c as Xt}from"./index-c5daf99f.js";import{C as Yt,g as Zt,_ as Jt,a as Qt,b as ct}from"./clickOutside-07d8fd9a.js";import{_ as en}from"./question-circle-outlined-9393fe91.js";import{p as _e}from"./propTypes-8a448afd.js";import{_ as tn}from"./more-horiz-7e8be199.js";import{u as nn}from"./useAppInject-582724ea.js";import{u as sn}from"./useRunLog-06306044.js";import{u as on}from"./useTransition-50591bac.js";import{_ as ln,g as an,e as rn,d as Ge,a as cn}from"./editTaskModal.vue_vue_type_script_setup_true_lang-38b7eca8.js";import{_ as un}from"./historyModal.vue_vue_type_script_setup_true_lang-93df7043.js";import Ie from"./delete-b588d0fe.js";import hn from"./enable-682a4849.js";import dn from"./disable-8a609856.js";import fn from"./pause-ac1e7ef1.js";import pn from"./running-0f6fe1d6.js";import"./sharp-arrow-back-ios-13cc3b11.js";import"./useDesign-01a81f9b.js";import"./clock-edit-outline-8af6910f.js";import"./trash-2409ad47.js";import"./alarm-off-28fec6ef.js";const mn={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"},gn=T("path",{fill:"currentColor",d:"M20 20v-3h2v3a2 2 0 0 1-2 2h-3v-2h3M2 20v-3h2v3h3v2H4c-1.1 0-2-.9-2-2m8 0h4v2h-4v-2m4.59-12L12 10.59L9.41 8L8 9.41L10.59 12L8 14.59L9.41 16L12 13.41L14.59 16L16 14.59L13.41 12L16 9.41L14.59 8M20 10h2v4h-2v-4M2 10h2v4H2v-4m0-6a2 2 0 0 1 2-2h3v2H4v3H2V4m20 0v3h-2V4h-3V2h3c1.1 0 2 .9 2 2M10 2h4v2h-4V2Z"},null,-1),_n=[gn];function yn(e,t){return b(),O("svg",mn,_n)}const vn={name:"mdi-selection-remove",render:yn},bn={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"},xn=T("path",{fill:"currentColor",d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2Z"},null,-1),Cn=[xn];function wn(e,t){return b(),O("svg",bn,Cn)}const kn={name:"mdi-plus",render:wn},Sn={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"},$n=T("path",{fill:"currentColor",d:"M2.39 1.73L1.11 3l3.1 3.1c-.13.29-.21.59-.21.9v10c0 2.21 3.59 4 8 4c2.3 0 4.38-.5 5.84-1.27l3 3l1.27-1.27L2.39 1.73M6 9.64c.76.43 1.7.78 2.76 1.01L12.11 14H12c-2.42 0-4.7-.6-6-1.55V9.64M12 19c-3.87 0-6-1.5-6-2v-2.23c1.61.78 3.72 1.23 6 1.23c.68 0 1.34-.05 2-.13l2.34 2.36c-1.01.42-2.47.77-4.34.77M8.64 5.44L7.06 3.86C8.42 3.33 10.13 3 12 3c4.42 0 8 1.79 8 4v9.8l-2-2v-.03v.01l-1.55-1.53c.6-.22 1.13-.49 1.55-.8V9.64c-1.03.58-2.39 1.01-3.94 1.22L12.19 9C15.94 8.94 18 7.5 18 7s-2.13-2-6-2c-1.34 0-2.46.18-3.36.44Z"},null,-1),Tn=[$n];function In(e,t){return b(),O("svg",Sn,Tn)}const Ln={name:"mdi-database-off-outline",render:In},Nn={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"},En=T("path",{fill:"currentColor",d:"M7 19v-2h2v2H7m4 0v-2h2v2h-2m4 0v-2h2v2h-2m-8-4v-2h2v2H7m4 0v-2h2v2h-2m4 0v-2h2v2h-2m-8-4V9h2v2H7m4 0V9h2v2h-2m4 0V9h2v2h-2M7 7V5h2v2H7m4 0V5h2v2h-2m4 0V5h2v2h-2Z"},null,-1),On=[En];function Dn(e,t){return b(),O("svg",Nn,On)}const Pn={name:"mdi-drag",render:Dn},Rn={style:{display:"inline-block"},viewBox:"0 0 1024 1024",width:"1em",height:"1em"},zn=T("path",{fill:"currentColor",d:"m924.8 625.7l-65.5-56c3.1-19 4.7-38.4 4.7-57.8s-1.6-38.8-4.7-57.8l65.5-56a32.03 32.03 0 0 0 9.3-35.2l-.9-2.6a443.74 443.74 0 0 0-79.7-137.9l-1.8-2.1a32.12 32.12 0 0 0-35.1-9.5l-81.3 28.9c-30-24.6-63.5-44-99.7-57.6l-15.7-85a32.05 32.05 0 0 0-25.8-25.7l-2.7-.5c-52.1-9.4-106.9-9.4-159 0l-2.7.5a32.05 32.05 0 0 0-25.8 25.7l-15.8 85.4a351.86 351.86 0 0 0-99 57.4l-81.9-29.1a32 32 0 0 0-35.1 9.5l-1.8 2.1a446.02 446.02 0 0 0-79.7 137.9l-.9 2.6c-4.5 12.5-.8 26.5 9.3 35.2l66.3 56.6c-3.1 18.8-4.6 38-4.6 57.1c0 19.2 1.5 38.4 4.6 57.1L99 625.5a32.03 32.03 0 0 0-9.3 35.2l.9 2.6c18.1 50.4 44.9 96.9 79.7 137.9l1.8 2.1a32.12 32.12 0 0 0 35.1 9.5l81.9-29.1c29.8 24.5 63.1 43.9 99 57.4l15.8 85.4a32.05 32.05 0 0 0 25.8 25.7l2.7.5a449.4 449.4 0 0 0 159 0l2.7-.5a32.05 32.05 0 0 0 25.8-25.7l15.7-85a350 350 0 0 0 99.7-57.6l81.3 28.9a32 32 0 0 0 35.1-9.5l1.8-2.1c34.8-41.1 61.6-87.5 79.7-137.9l.9-2.6c4.5-12.3.8-26.3-9.3-35zM788.3 465.9c2.5 15.1 3.8 30.6 3.8 46.1s-1.3 31-3.8 46.1l-6.6 40.1l74.7 63.9a370.03 370.03 0 0 1-42.6 73.6L721 702.8l-31.4 25.8c-23.9 19.6-50.5 35-79.3 45.8l-38.1 14.3l-17.9 97a377.5 377.5 0 0 1-85 0l-17.9-97.2l-37.8-14.5c-28.5-10.8-55-26.2-78.7-45.7l-31.4-25.9l-93.4 33.2c-17-22.9-31.2-47.6-42.6-73.6l75.5-64.5l-6.5-40c-2.4-14.9-3.7-30.3-3.7-45.5c0-15.3 1.2-30.6 3.7-45.5l6.5-40l-75.5-64.5c11.3-26.1 25.6-50.7 42.6-73.6l93.4 33.2l31.4-25.9c23.7-19.5 50.2-34.9 78.7-45.7l37.9-14.3l17.9-97.2c28.1-3.2 56.8-3.2 85 0l17.9 97l38.1 14.3c28.7 10.8 55.4 26.2 79.3 45.8l31.4 25.8l92.8-32.9c17 22.9 31.2 47.6 42.6 73.6L781.8 426l6.5 39.9zM512 326c-97.2 0-176 78.8-176 176s78.8 176 176 176s176-78.8 176-176s-78.8-176-176-176zm79.2 255.2A111.6 111.6 0 0 1 512 614c-29.9 0-58-11.7-79.2-32.8A111.6 111.6 0 0 1 400 502c0-29.9 11.7-58 32.8-79.2C454 401.6 482.1 390 512 390c29.9 0 58 11.6 79.2 32.8A111.6 111.6 0 0 1 624 502c0 29.9-11.7 58-32.8 79.2z"},null,-1),An=[zn];function Mn(e,t){return b(),O("svg",Rn,An)}const Hn={name:"ant-design-setting-outlined",render:Mn},Bn=U({inject:["manager"],props:{index:{type:Number,required:!0},disabled:{type:Boolean,default:!1}},data(){return{}},watch:{index(e){this.$el&&this.$el.sortableInfo&&(this.$el.sortableInfo.index=e)},disabled(e){e?this.removeDraggable():this.setDraggable(this.index)}},mounted(){const{disabled:e,index:t}=this.$props;e||this.setDraggable(t)},beforeUnmount(){this.disabled||this.removeDraggable()},methods:{setDraggable(e){const t=this.$el;t.sortableInfo={index:e,manager:this.manager},this.ref={node:t},this.manager.add(this.ref)},removeDraggable(){this.manager.remove(this.ref)}}});class Fn{constructor(){this.refs=[],this.active=null}add(t){this.refs||(this.refs=[]),this.refs.push(t)}remove(t){const n=this.getIndex(t);n!==-1&&this.refs.splice(n,1)}isActive(){return!!this.active}getActive(){return this.refs.find(({node:t})=>{var n,s;return((n=t?.sortableInfo)===null||n===void 0?void 0:n.index)==((s=this===null||this===void 0?void 0:this.active)===null||s===void 0?void 0:s.index)})||null}getIndex(t){return this.refs.indexOf(t)}getRefs(){return this.refs}getOrderedRefs(){return this.refs.sort((t,n)=>t.node.sortableInfo.index-n.node.sortableInfo.index)}}const pe=e=>e.touches!=null;function De(e,t){return!!e&&Object.prototype.hasOwnProperty.call(e,t)}function Vn(e,t,n){const s=e.slice(0);if(n>=s.length){let i=n-s.length;for(;i--+1;)s.push(void 0)}return s.splice(n,0,s.splice(t,1)[0]),s}function Gn(e,t){const n=e.slice(0);return t>=n.length||n.splice(t,1),n}function Wn(e,t,n){const s=e.slice(0);return t===s.length?s.push(n):s.splice(t,0,n),s}const Q={start:["touchstart","mousedown"],move:["touchmove","mousemove"],end:["touchend","mouseup"],cancel:["touchcancel","keyup"]};function We(e,t){for(;e;){if(t(e))return e;e=e.parentNode}}function Ke(e,t,n){return n<e?e:n>t?t:n}function me(e){return e.substr(-2)==="px"?parseFloat(e):0}function je(e){const t=window.getComputedStyle(e);return{top:me(t.marginTop),right:me(t.marginRight),bottom:me(t.marginBottom),left:me(t.marginLeft)}}function ge(e,t="page"){const n=`${t}X`,s=`${t}Y`;return{x:pe(e)?e.touches[0][n]:e[n],y:pe(e)?e.touches[0][s]:e[s]}}function Ue(e){const t=[e];for(;e;e=e.offsetParent)t.unshift(e);return t}function Kn(e,t){const n=Ue(e),s=Ue(t);if(n[0]!=s[0])throw"No common ancestor!";for(let i=0;i<n.length;i++)if(n[i]!=s[i])return n[i-1]}function ne(e,t,n={top:0,left:0}){if(e){const s={top:n.top+e.offsetTop,left:n.left+e.offsetLeft};return e.offsetParent!==t.offsetParent?ne(e.offsetParent,t,s):s}return{top:0,left:0}}function qe(e){const t=e.querySelectorAll("input, textarea, select"),n=e.cloneNode(!0);return[...n.querySelectorAll("input, textarea, select")].forEach((i,u)=>{i.type!=="file"&&t[u]&&(i.value=t[u].value)}),n}function jn(e,t,n){if(typeof e=="string"&&(e=+e),Array.isArray(e)||(e=[e,e]),e.length!==2)throw new Error(`lockOffset prop of SortableContainer should be a single value or an array of exactly two values. Given ${e}`);const[s,i]=e;return[Xe(s,t,n),Xe(i,t,n)]}function Xe(e,t,n){let s=e,i=e,u="px";if(typeof e=="string"){const l=/^[+-]?\d*(?:\.\d*)?(px|%)$/.exec(e);if(l===null)throw new Error(`lockOffset value should be a number or a string of a number followed by "px" or "%". Given ${e}`);s=i=parseFloat(e),u=l[1]}if(!isFinite(s)||!isFinite(i))throw new Error(`lockOffset value should be a finite. Given ${e}`);return u==="%"&&(s=s*t/100,i=i*n/100),{x:s,y:i}}function Ye(e=[]){for(let t=0,n=e.length;t<n;t++){const s=e[t],i=s.node;if(!i)return;s.edgeOffset=null,Pe(i)}}function Pe(e,t="",n=""){e&&(e.style.transform=t,e.style.transitionDuration=n)}const Le=setTimeout,Un=U({inject:{SlicksortHub:{from:"SlicksortHub",default:null}},provide(){return{manager:this.manager}},props:{list:{type:Array,required:!0},axis:{type:String,default:"y"},distance:{type:Number,default:0},pressDelay:{type:Number,default:0},pressThreshold:{type:Number,default:5},useDragHandle:{type:Boolean,default:!1},useWindowAsScrollContainer:{type:Boolean,default:!1},hideSortableGhost:{type:Boolean,default:!0},lockToContainerEdges:{type:Boolean,default:!1},lockOffset:{type:[String,Number,Array],default:"50%"},transitionDuration:{type:Number,default:300},appendTo:{type:String,default:"body"},draggedSettlingDuration:{type:Number,default:null},group:{type:String,default:""},accept:{type:[Boolean,Array,Function],default:null},cancelKey:{type:String,default:"Escape"},block:{type:Array,default:()=>[]},lockAxis:{type:String,default:""},helperClass:{type:String,default:""},contentWindow:{type:Object,default:null},shouldCancelStart:{type:Function,default:e=>["input","textarea","select","option","button"].indexOf(e.target.tagName.toLowerCase())!==-1},getHelperDimensions:{type:Function,default:({node:e})=>({width:e.offsetWidth,height:e.offsetHeight})}},emits:["sort-start","sort-move","sort-end","sort-cancel","sort-insert","sort-remove","update:list"],data(){let e=!1;return this.group&&this.SlicksortHub&&(e=!0),{sorting:!1,hub:e?this.SlicksortHub:null,manager:new Fn}},mounted(){this.hub&&(this.id=this.hub.getId()),this.container=this.$el,this.document=this.container.ownerDocument||document,this._window=this.contentWindow||window,this.scrollContainer=this.useWindowAsScrollContainer?{scrollLeft:0,scrollTop:0}:this.container,this.events={start:this.handleStart,move:this.handleMove,end:this.handleEnd};for(const e in this.events)De(this.events,e)&&Q[e].forEach(t=>this.container.addEventListener(t,this.events[e]));this.hub&&this.hub.addContainer(this)},beforeUnmount(){for(const e in this.events)De(this.events,e)&&Q[e].forEach(t=>this.container.removeEventListener(t,this.events[e]));this.hub&&this.hub.removeContainer(this),this.dragendTimer&&clearTimeout(this.dragendTimer),this.cancelTimer&&clearTimeout(this.cancelTimer),this.pressTimer&&clearTimeout(this.pressTimer),this.autoscrollInterval&&clearInterval(this.autoscrollInterval)},methods:{handleStart(e){const{distance:t,shouldCancelStart:n}=this.$props;if(!pe(e)&&e.button===2||n(e))return!1;this._touched=!0,this._pos=ge(e);const s=e.target,i=We(s,u=>u.sortableInfo!=null);if(i&&i.sortableInfo&&this.nodeIsChild(i)&&!this.sorting){const{useDragHandle:u}=this.$props,{index:l}=i.sortableInfo;if(u&&!We(s,d=>d.sortableHandle!=null))return;this.manager.active={index:l},s.tagName.toLowerCase()==="a"&&e.preventDefault(),t||(this.pressDelay===0?this.handlePress(e):this.pressTimer=Le(()=>this.handlePress(e),this.pressDelay))}},nodeIsChild(e){return e.sortableInfo.manager===this.manager},handleMove(e){const{distance:t,pressThreshold:n}=this.$props;if(!this.sorting&&this._touched){const s=ge(e);this._delta={x:this._pos.x-s.x,y:this._pos.y-s.y};const i=Math.abs(this._delta.x)+Math.abs(this._delta.y);!t&&(!n||n&&i>=n)?(this.cancelTimer&&clearTimeout(this.cancelTimer),this.cancelTimer=Le(this.cancel,0)):t&&i>=t&&this.manager.isActive()&&this.handlePress(e)}},handleEnd(){if(!this._touched)return;const{distance:e}=this.$props;this._touched=!1,e||this.cancel()},cancel(){this.sorting||(this.pressTimer&&clearTimeout(this.pressTimer),this.manager.active=null,this.hub&&this.hub.cancel())},handleSortCancel(e){(pe(e)||e.key===this.cancelKey)&&(this.newIndex=this.index,this.canceling=!0,this.translate={x:0,y:0},this.animateNodes(),this.handleSortEnd(e))},handlePress(e){e.stopPropagation();const t=this.manager.getActive();if(t){const{getHelperDimensions:n,helperClass:s,hideSortableGhost:i,appendTo:u}=this.$props,{node:l}=t,{index:d}=l.sortableInfo,m=je(l),c=this.container.getBoundingClientRect(),v=n({index:d,node:l});this.node=l,this.margin=m,this.width=v.width,this.height=v.height,this.marginOffset={x:this.margin.left+this.margin.right,y:Math.max(this.margin.top,this.margin.bottom)},this.boundingClientRect=l.getBoundingClientRect(),this.containerBoundingRect=c,this.index=d,this.newIndex=d;const x=qe(l);this.helper=this.document.querySelector(u).appendChild(x),this.helper.style.position="fixed",this.helper.style.top=`${this.boundingClientRect.top-m.top}px`,this.helper.style.left=`${this.boundingClientRect.left-m.left}px`,this.helper.style.width=`${this.width}px`,this.helper.style.height=`${this.height}px`,this.helper.style.boxSizing="border-box",this.helper.style.pointerEvents="none",i&&(this.sortableGhost=l,l.style.visibility="hidden",l.style.opacity="0"),this.hub&&(this.hub.sortStart(this),this.hub.helper=this.helper,this.hub.ghost=this.sortableGhost),this.intializeOffsets(e,this.boundingClientRect),this.offsetEdge=ne(l,this.container),s&&this.helper.classList.add(...s.split(" ")),this.listenerNode=pe(e)?l:this._window,Q.move.forEach(h=>this.listenerNode.addEventListener(h,this.handleSortMove)),Q.end.forEach(h=>this.listenerNode.addEventListener(h,this.handleSortEnd)),Q.cancel.forEach(h=>this.listenerNode.addEventListener(h,this.handleSortCancel)),this.sorting=!0,this.$emit("sort-start",{event:e,node:l,index:d})}},handleSortMove(e){if(e.preventDefault(),this.updatePosition(e),this.hub){const t=this.list[this.index];this.hub.handleSortMove(e,t)}(!this.hub||this.hub.isDest(this))&&(this.animateNodes(),this.autoscroll()),this.$emit("sort-move",{event:e})},handleDropOut(){const e=this.list[this.index],t=Gn(this.list,this.index);return this.$emit("sort-remove",{oldIndex:this.index}),this.$emit("update:list",t),e},handleDropIn(e){const t=Wn(this.list,this.newIndex,e);this.$emit("sort-insert",{newIndex:this.newIndex,value:e}),this.$emit("update:list",t),this.handleDragEnd()},handleDragOut(){this.autoscrollInterval&&(clearInterval(this.autoscrollInterval),this.autoscrollInterval=null),this.hub.isSource(this)?(this.translate={x:1e4,y:1e4},this.animateNodes()):(this.manager.getRefs().forEach(e=>{e.node.style.transform=""}),this.dragendTimer=Le(this.handleDragEnd,this.transitionDuration||0))},handleDragEnd(){this.autoscrollInterval&&(clearInterval(this.autoscrollInterval),this.autoscrollInterval=null),Ye(this.manager.getRefs()),this.sortableGhost&&(this.sortableGhost.remove(),this.sortableGhost=null),this.dragendTimer&&(clearTimeout(this.dragendTimer),this.dragendTimer=null),this.manager.active=null,this._touched=!1,this.sorting=!1},intializeOffsets(e,t){const{useWindowAsScrollContainer:n,containerBoundingRect:s,_window:i}=this;this.marginOffset={x:this.margin.left+this.margin.right,y:Math.max(this.margin.top,this.margin.bottom)},this._axis={x:this.axis.indexOf("x")>=0,y:this.axis.indexOf("y")>=0},this.initialOffset=ge(e),this.initialScroll={top:this.scrollContainer.scrollTop,left:this.scrollContainer.scrollLeft},this.initialWindowScroll={top:window.pageYOffset,left:window.pageXOffset},this.translate={x:0,y:0},this.minTranslate={},this.maxTranslate={},this._axis.x&&(this.minTranslate.x=(n?0:s.left)-t.left-this.width/2,this.maxTranslate.x=(n?i.innerWidth:s.left+s.width)-t.left-this.width/2),this._axis.y&&(this.minTranslate.y=(n?0:s.top)-t.top-this.height/2,this.maxTranslate.y=(n?i.innerHeight:s.top+s.height)-t.top-this.height/2)},handleDragIn(e,t,n){if(this.hub.isSource(this))return;this.dragendTimer&&(this.handleDragEnd(),clearTimeout(this.dragendTimer),this.dragendTimer=null);const s=this.manager.getRefs();this.index=s.length,this.manager.active={index:this.index};const i=this.container.getBoundingClientRect(),u=n.getBoundingClientRect();this.containerBoundingRect=i,this.sortableGhost=qe(t),this.container.appendChild(this.sortableGhost);const l=this.sortableGhost.getBoundingClientRect();this.boundingClientRect=l,this.margin=je(this.sortableGhost),this.width=l.width,this.height=l.height,this.offsetEdge=ne(this.sortableGhost,this.container),this.intializeOffsets(e,l),this.initialOffset.x+=l.x-u.x,this.initialOffset.y+=l.y-u.y,this.sorting=!0},handleSortEnd(e){this.listenerNode&&(Q.move.forEach(s=>this.listenerNode.removeEventListener(s,this.handleSortMove)),Q.end.forEach(s=>this.listenerNode.removeEventListener(s,this.handleSortEnd)),Q.cancel.forEach(s=>this.listenerNode.removeEventListener(s,this.handleSortCancel)));const t=this.manager.getRefs();this.helper&&this.helperClass&&this.helper.classList.remove(...this.helperClass.split(" ")),this.autoscrollInterval&&clearInterval(this.autoscrollInterval),this.autoscrollInterval=null;const n=()=>{this.helper&&(this.helper.remove(),this.helper=null),this.hideSortableGhost&&this.sortableGhost&&(this.sortableGhost.style.visibility="",this.sortableGhost.style.opacity=""),Ye(t),this.hub&&!this.hub.isDest(this)?this.canceling?this.hub.cancel():this.hub.handleSortEnd():this.canceling?this.$emit("sort-cancel",{event:e}):(this.$emit("sort-end",{event:e,oldIndex:this.index,newIndex:this.newIndex}),this.$emit("update:list",Vn(this.list,this.index,this.newIndex))),this.manager.active=null,this._touched=!1,this.canceling=!1,this.sorting=!1};this.transitionDuration||this.draggedSettlingDuration?this.transitionHelperIntoPlace(t,n):n()},transitionHelperIntoPlace(e,t){if(this.draggedSettlingDuration===0||e.length===0||!this.helper)return Promise.resolve();const n=e[this.index].node;let s=0,i=0;const u={top:window.pageYOffset-this.initialWindowScroll.top,left:window.pageXOffset-this.initialWindowScroll.left};if(this.hub&&!this.hub.isDest(this)&&!this.canceling){const c=this.hub.getDest();if(!c)return;const v=c.newIndex,x=c.manager.getOrderedRefs(),h=v<x.length?x[v].node:c.sortableGhost,o=Kn(n,h),r=ne(n,o),_=ne(h,o);s=_.left-r.left-u.left,i=_.top-r.top-u.top}else{const c=e[this.newIndex].node,v={left:this.scrollContainer.scrollLeft-this.initialScroll.left+u.left,top:this.scrollContainer.scrollTop-this.initialScroll.top+u.top};s=-v.left,this.translate&&this.translate.x>0?s+=c.offsetLeft+c.offsetWidth-(n.offsetLeft+n.offsetWidth):s+=c.offsetLeft-n.offsetLeft,i=-v.top,this.translate&&this.translate.y>0?i+=c.offsetTop+c.offsetHeight-(n.offsetTop+n.offsetHeight):i+=c.offsetTop-n.offsetTop}const l=this.draggedSettlingDuration!==null?this.draggedSettlingDuration:this.transitionDuration;Pe(this.helper,`translate3d(${s}px,${i}px, 0)`,`${l}ms`);const d=c=>{(!c||c.propertyName==="transform")&&(clearTimeout(m),Pe(this.helper),t())},m=setTimeout(d,l+10);this.helper.addEventListener("transitionend",d)},updatePosition(e){const{lockAxis:t,lockToContainerEdges:n}=this.$props,s=ge(e),i={x:s.x-this.initialOffset.x,y:s.y-this.initialOffset.y};if(i.y-=window.pageYOffset-this.initialWindowScroll.top,i.x-=window.pageXOffset-this.initialWindowScroll.left,this.translate=i,n){const[u,l]=jn(this.lockOffset,this.height,this.width),d={x:this.width/2-u.x,y:this.height/2-u.y},m={x:this.width/2-l.x,y:this.height/2-l.y};this.minTranslate.x&&this.maxTranslate.x&&(i.x=Ke(this.minTranslate.x+d.x,this.maxTranslate.x-m.x,i.x)),this.minTranslate.y&&this.maxTranslate.y&&(i.y=Ke(this.minTranslate.y+d.y,this.maxTranslate.y-m.y,i.y))}t==="x"?i.y=0:t==="y"&&(i.x=0),this.helper&&(this.helper.style.transform=`translate3d(${i.x}px,${i.y}px, 0)`)},animateNodes(){const{transitionDuration:e,hideSortableGhost:t}=this.$props,n=this.manager.getOrderedRefs(),s={left:this.scrollContainer.scrollLeft-this.initialScroll.left,top:this.scrollContainer.scrollTop-this.initialScroll.top},i={left:this.offsetEdge.left+this.translate.x+s.left,top:this.offsetEdge.top+this.translate.y+s.top},u={top:window.pageYOffset-this.initialWindowScroll.top,left:window.pageXOffset-this.initialWindowScroll.left};this.newIndex=null;for(let l=0,d=n.length;l<d;l++){const{node:m}=n[l],c=m.sortableInfo.index,v=m.offsetWidth,x=m.offsetHeight,h={width:this.width>v?v/2:this.width/2,height:this.height>x?x/2:this.height/2},o={x:0,y:0};let{edgeOffset:r}=n[l];r||(n[l].edgeOffset=r=ne(m,this.container));const _=l<n.length-1&&n[l+1],C=l>0&&n[l-1];if(_&&!_.edgeOffset&&(_.edgeOffset=ne(_.node,this.container)),c===this.index){t&&(this.sortableGhost=m,m.style.visibility="hidden",m.style.opacity="0");continue}e&&(m.style.transitionDuration=`${e}ms`),this._axis.x?this._axis.y?c<this.index&&(i.left+u.left-h.width<=r.left&&i.top+u.top<=r.top+h.height||i.top+u.top+h.height<=r.top)?(o.x=this.width+this.marginOffset.x,r.left+o.x>this.containerBoundingRect.width-h.width&&_&&(o.x=_.edgeOffset.left-r.left,o.y=_.edgeOffset.top-r.top),this.newIndex===null&&(this.newIndex=c)):c>this.index&&(i.left+u.left+h.width>=r.left&&i.top+u.top+h.height>=r.top||i.top+u.top+h.height>=r.top+x)&&(o.x=-(this.width+this.marginOffset.x),r.left+o.x<this.containerBoundingRect.left+h.width&&C&&(o.x=C.edgeOffset.left-r.left,o.y=C.edgeOffset.top-r.top),this.newIndex=c):c>this.index&&i.left+u.left+h.width>=r.left?(o.x=-(this.width+this.marginOffset.x),this.newIndex=c):c<this.index&&i.left+u.left<=r.left+h.width&&(o.x=this.width+this.marginOffset.x,this.newIndex==null&&(this.newIndex=c)):this._axis.y&&(c>this.index&&i.top+u.top+h.height>=r.top?(o.y=-(this.height+this.marginOffset.y),this.newIndex=c):c<this.index&&i.top+u.top<=r.top+h.height&&(o.y=this.height+this.marginOffset.y,this.newIndex==null&&(this.newIndex=c))),m.style.transform=`translate3d(${o.x}px,${o.y}px,0)`}this.newIndex==null&&(this.newIndex=this.index)},autoscroll(){const e=this.translate,t={x:0,y:0},n={x:1,y:1},s={x:10,y:10};e.y>=this.maxTranslate.y-this.height/2?(t.y=1,n.y=s.y*Math.abs((this.maxTranslate.y-this.height/2-e.y)/this.height)):e.x>=this.maxTranslate.x-this.width/2?(t.x=1,n.x=s.x*Math.abs((this.maxTranslate.x-this.width/2-e.x)/this.width)):e.y<=this.minTranslate.y+this.height/2?(t.y=-1,n.y=s.y*Math.abs((e.y-this.height/2-this.minTranslate.y)/this.height)):e.x<=this.minTranslate.x+this.width/2&&(t.x=-1,n.x=s.x*Math.abs((e.x-this.width/2-this.minTranslate.x)/this.width)),this.autoscrollInterval&&(clearInterval(this.autoscrollInterval),this.autoscrollInterval=null),(t.x!==0||t.y!==0)&&(this.autoscrollInterval=window.setInterval(()=>{const i={left:1*n.x*t.x,top:1*n.y*t.y};this.useWindowAsScrollContainer?this._window.scrollBy(i.left,i.top):(this.scrollContainer.scrollTop+=i.top,this.scrollContainer.scrollLeft+=i.left),this.translate.x+=i.left,this.translate.y+=i.top,this.animateNodes()},5))}}}),qn={beforeMount(e){e.sortableHandle=!0}},ut=U({name:"SlickItem",mixins:[Bn],props:{tag:{type:String,default:"div"}},render(){var e,t;return I(this.tag,(t=(e=this.$slots).default)===null||t===void 0?void 0:t.call(e))}}),Xn=U({name:"SlickList",mixins:[Un],props:{tag:{type:String,default:"div"},itemKey:{type:[String,Function],default:"id"}},render(){var e,t;return this.$slots.item?I(this.tag,this.list.map((n,s)=>{let i;if(n!=null){if(typeof this.itemKey=="function")i=this.itemKey(n);else if(typeof n=="object"&&De(n,this.itemKey)&&typeof n[this.itemKey]=="string")i=n[this.itemKey];else if(typeof n=="string")i=n;else throw new Error("Cannot find key for item, use the item-key prop and pass a function or string");return I(ut,{key:i,index:s},{default:()=>{var u,l;return(l=(u=this.$slots).item)===null||l===void 0?void 0:l.call(u,{item:n,index:s})}})}})):I(this.tag,(t=(e=this.$slots).default)===null||t===void 0?void 0:t.call(e))}});U({props:{tag:{type:String,default:"span"}},mounted(){this.$el.sortableHandle=!0},render(){var e,t;return I(this.tag,(t=(e=this.$slots).default)===null||t===void 0?void 0:t.call(e))}});const ht=Symbol("s-table");function Yn(e){_t(ht,e)}function dt(){return gt(ht)}const{t:Zn}=Me(),Jn=U({name:"ColumnSetting",components:{SlickList:Xn,SlickItem:ut},directives:{handle:qn},setup(){const e=dt(),t=w([]),n=w([]),s=Je({selection:!1,checkAll:!0,checkList:[],defaultCheckList:[]});ve(()=>{e.getColumns().filter(r=>r.type!=="selection").length&&i()});function i(){const o=d(),r=o.map(C=>C.key);s.checkList=r,s.defaultCheckList=r;const _=o;t.value.length||(t.value=he(_),n.value=he(_))}function u(o){o.length?s.checkAll=!0:s.checkAll=!1,l(o)}function l(o){e.setColumns(o)}function d(){const o=[];return e.getColumns().filter(r=>r.key!=="action"&&r.title!=="操作"&&r.type!=="selection").forEach(r=>{o.push({...r})}),o}function m(){s.checkList=[...s.defaultCheckList],s.checkAll=!0;const r=e.getCacheColumns().filter(_=>_.type!=="selection").map(_=>({..._}));l(r),t.value=r}function c(o){const r=e.getCacheColumns(!0);o?(l(r),s.checkList=r):(l([]),s.checkList=[])}function v(){document.body.style.cursor="move"}function x(){const o=le(a(t));t.value=o,l(o),document.body.style.cursor=""}yt(()=>{document.body.style.cursor=""});function h(o){const r=e.getCacheColumns();o||r.splice(0,1),l(r)}return{t:Zn,...Qe(s),columnsList:t,onChange:u,onCheckAll:c,onSelection:h,resetColumns:m,dragEnd:x,dragStart:v}}});const Qn={class:"cursor-pointer table-toolbar-right-icon"},es={class:"table-toolbar-inner-popover-title"},ts={class:"table-toolbar-inner"},ns={class:"drag-icon"};function ss(e,t,n,s,i,u){const l=Hn,d=Y,m=tt,c=de,v=nt,x=Pn,h=Ne("SlickItem"),o=Ne("SlickList"),r=vt,_=st,C=ze,k=et("handle");return b(),H(C,{trigger:"hover"},{trigger:p(()=>[T("div",Qn,[g(_,{trigger:"click",width:230,class:"toolbar-popover",placement:"bottom-end","content-style":"padding: 0"},{trigger:p(()=>[g(d,{size:"18"},{default:p(()=>[g(l)]),_:1})]),header:p(()=>[T("div",es,[g(v,null,{default:p(()=>[g(m,{checked:e.checkAll,"onUpdate:checked":[t[0]||(t[0]=$=>e.checkAll=$),e.onCheckAll]},{default:p(()=>[z(V(e.t("component.table.settingColumnShow")),1)]),_:1},8,["checked","onUpdate:checked"]),g(c,{text:"",type:"primary",size:"small",class:"mt-1",onClick:e.resetColumns},{default:p(()=>[z(V(e.t("component.table.settingColumnReset")),1)]),_:1},8,["onClick"])]),_:1})])]),default:p(()=>[T("div",ts,[g(r,{value:e.checkList,"onUpdate:value":[t[2]||(t[2]=$=>e.checkList=$),e.onChange]},{default:p(()=>[g(o,{list:e.columnsList,"onUpdate:list":[t[1]||(t[1]=$=>e.columnsList=$),e.dragEnd],"use-drag-handle":"","lock-to-container-edges":"","lock-offset":[8,8],axis:"y","lock-axis":"y","helper-class":"shadow","dragged-settling-duration":150,onSortStart:e.dragStart},{default:p(()=>[(b(!0),O(Re,null,be(e.columnsList,($,A)=>(b(),H(h,{key:$.key,index:A,class:"table-toolbar-inner-checkbox"},{default:p(()=>[Ee((b(),O("span",ns,[g(x,{class:"text-18px text-$app-text-color-3"})])),[[k]]),g(m,{value:$.key,label:$.title},null,8,["value","label"])]),_:2},1032,["index"]))),128))]),_:1},8,["list","onSortStart","onUpdate:list"])]),_:1},8,["value","onUpdate:value"])])]),_:1})])]),default:p(()=>[T("span",null,V(e.t("component.table.settingColumn")),1)]),_:1})}const ft=He(Jn,[["render",ss]]),is={style:{display:"inline-block"},viewBox:"0 0 1024 1024",width:"1em",height:"1em"},os=T("path",{fill:"currentColor",d:"M840 836H184c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h656c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm0-724H184c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h656c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zM610.8 378c6 0 9.4-7 5.7-11.7L515.7 238.7a7.14 7.14 0 0 0-11.3 0L403.6 366.3a7.23 7.23 0 0 0 5.7 11.7H476v268h-62.8c-6 0-9.4 7-5.7 11.7l100.8 127.5c2.9 3.7 8.5 3.7 11.3 0l100.8-127.5c3.7-4.7.4-11.7-5.7-11.7H548V378h62.8z"},null,-1),ls=[os];function as(e,t){return b(),O("svg",is,ls)}const rs={name:"ant-design-column-height-outlined",render:as},cs={style:{display:"inline-block"},viewBox:"0 0 1024 1024",width:"1em",height:"1em"},us=T("path",{fill:"currentColor",d:"m909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92C290 92 102.3 279.5 102 511.5C101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1c1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 0 0-10.1 4.8c-1.8 5-3.8 10-5.9 14.9c-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 0 1 655.9 829c-42.3 17.9-87.4 27-133.8 27c-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 0 1 279 755.2a342.16 342.16 0 0 1-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4c31.6-31.6 68.4-56.4 109.3-73.8c42.3-17.9 87.4-27 133.8-27c46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 0 1 109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 0 0 3 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"},null,-1),hs=[us];function ds(e,t){return b(),O("svg",cs,hs)}const fs={name:"ant-design-reload-outlined",render:ds};function ps(e,t=150,n){let s=()=>{e()};s=Ct(s,t);const u=()=>{n&&n.immediate&&s(),window.addEventListener("resize",s)},l=()=>{window.removeEventListener("resize",s)};return bt(()=>{u()}),xt(()=>{l()}),[u,l]}function ms(e){const t=w(a(e).loading);Ae(()=>a(e).loading,i=>{t.value=i});const n=N(()=>a(t));function s(i){t.value=i}return{getLoading:n,setLoading:s}}const gs={style:{display:"inline-block"},viewBox:"0 0 1024 1024",width:"1em",height:"1em"},_s=T("path",{fill:"currentColor",d:"m563.8 512l262.5-312.9c4.4-5.2.7-13.1-6.1-13.1h-79.8c-4.7 0-9.2 2.1-12.3 5.7L511.6 449.8L295.1 191.7c-3-3.6-7.5-5.7-12.3-5.7H203c-6.8 0-10.5 7.9-6.1 13.1L459.4 512L196.9 824.9A7.95 7.95 0 0 0 203 838h79.8c4.7 0 9.2-2.1 12.3-5.7l216.5-258.1l216.5 258.1c3 3.6 7.5 5.7 12.3 5.7h79.8c6.8 0 10.5-7.9 6.1-13.1L563.8 512z"},null,-1),ys=[_s];function vs(e,t){return b(),O("svg",gs,ys)}const bs={name:"ant-design-close-outlined",render:vs},xs={style:{display:"inline-block"},viewBox:"0 0 1024 1024",width:"1em",height:"1em"},Cs=T("path",{fill:"currentColor",d:"M912 190h-69.9c-9.8 0-19.1 4.5-25.1 12.2L404.7 724.5L207 474a32 32 0 0 0-25.1-12.2H112c-6.7 0-10.4 7.7-6.3 12.9l273.9 347c12.8 16.2 37.4 16.2 50.3 0l488.4-618.9c4.1-5.1.4-12.8-6.3-12.8z"},null,-1),ws=[Cs];function ks(e,t){return b(),O("svg",xs,ws)}const Ss={name:"ant-design-check-outlined",render:ks},$s={style:{display:"inline-block"},viewBox:"0 0 1024 1024",width:"1em",height:"1em"},Ts=T("path",{fill:"currentColor",d:"M904 512h-56c-4.4 0-8 3.6-8 8v320H184V184h320c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V520c0-4.4-3.6-8-8-8z"},null,-1),Is=T("path",{fill:"currentColor",d:"M355.9 534.9L354 653.8c-.1 8.9 7.1 16.2 16 16.2h.4l118-2.9c2-.1 4-.9 5.4-2.3l415.9-415c3.1-3.1 3.1-8.2 0-11.3L785.4 114.3c-1.6-1.6-3.6-2.3-5.7-2.3s-4.1.8-5.7 2.3l-415.8 415a8.3 8.3 0 0 0-2.3 5.6zm63.5 23.6L779.7 199l45.2 45.1l-360.5 359.7l-45.7 1.1l.7-46.4z"},null,-1),Ls=[Ts,Is];function Ns(e,t){return b(),O("svg",$s,Ls)}const pt={name:"ant-design-form-outlined",render:Ns};var mt=(e=>(e.NInput="on-input",e.NInputNumber="on-input",e.NSelect="on-update:value",e.NSwitch="on-update:value",e.NCheckbox="on-update:value",e.NDatePicker="on-update:value",e.NTimePicker="on-update:value",e))(mt||{});const ee=new Map;ee.set("NInput",it);ee.set("NInputNumber",wt);ee.set("NSelect",kt);ee.set("NSwitch",St);ee.set("NCheckbox",tt);ee.set("NDatePicker",$t);ee.set("NTimePicker",Tt);const Es=({component:e="NInput",rule:t=!0,ruleMessage:n,popoverVisible:s},{attrs:i})=>{const u=ee.get(e),l=I(u,i);return t?I(st,{"display-directive":"show",show:!!s,manual:"manual"},{trigger:()=>l,default:()=>I("span",{style:{color:"red",width:"90px",display:"inline-block"}},{default:()=>n})}):l};function Ze(e){return e==="NInput"?"请输入":["NPicker","NSelect","NCheckbox","NRadio","NSwitch","NDatePicker","NTimePicker"].includes(e)?"请选择":""}const Os=U({name:"EditableCell",components:{CellComponent:Es},directives:{clickOutside:Yt},props:{value:{type:[String,Number,Boolean,Object],default:""},record:{type:Object},column:{type:Object,default:()=>({})},index:_e.number},setup(e){const t=dt(),n=w(!1),s=w(),i=w(!1),u=w(""),l=w([]),d=w(e.value),m=w(e.value),c=N(()=>e.column?.editComponent||"NInput"),v=N(()=>e.column?.editRule),x=N(()=>a(u)&&a(i)),h=N(()=>{const y=a(c);return["NCheckbox","NRadio"].includes(y)}),o=N(()=>{const y=e.column?.editComponentProps??{},S=e.column?.editComponent??null,L=a(c),D={},f=a(h),P=f?"checked":"value",M=a(d);let K=f?Te(M)&&G(M)?M:!!M:M;Oe(K)&&L==="NDatePicker"?K=Be(K):ce(K)&&L==="NDatePicker"&&(K=K.map(te=>Be(te)));const E=S?mt[S]:void 0;return{placeholder:Ze(a(c)),...D,...ot(y,"onChange"),[E]:A,[P]:K}}),r=N(()=>{const{editComponentProps:y,editValueMap:S}=e.column,L=a(d);return S&&fe(S)?S(L):a(c).includes("NSelect")?(y?.options??(a(l)||[])).find(M=>`${M.value}`==`${L}`)?.label??L:L}),_=N(()=>({width:"calc(100% - 48px)"})),C=N(()=>{const{align:y="center"}=e.column;return`edit-cell-align-${y}`}),k=N(()=>{const{editable:y}=e.record||{};return!!y});ve(()=>{m.value=e.value}),ve(()=>{const{editable:y}=e.column;(G(y)||G(a(k)))&&(n.value=!!y||a(k))});function $(){a(k)||a(e.column?.editRow)||(u.value="",n.value=!0,It(()=>{a(s)?.focus?.()}))}async function A(y,...S){const L=a(c);y?y?.target&&Reflect.has(y.target,"value")?d.value=y.target.value:L==="NCheckbox"?d.value=y.target.checked:(Oe(y)||G(y)||Te(y))&&(d.value=y):d.value=y;const D=e.column?.editComponentProps?.onChange;D&&fe(D)&&D(y,...S),t.emit?.("edit-change",{column:e.column,value:a(d),record:le(e.record)}),await W()}async function W(){const{column:y,record:S}=e,{editRule:L}=y,D=a(d);if(L){if(G(L)&&!D&&!Te(D)){i.value=!0;const f=a(c);return u.value=Ze(f),!1}if(fe(L)){const f=await L(D,S);return f?(u.value=f,i.value=!0,!1):(u.value="",!0)}}return u.value="",!0}async function j(y=!0,S=!0){if(S&&!await W())return;const{column:L,index:D,record:f}=e;if(!f)return;const{key:P}=L,M=a(d);if(!P)return;Lt(f,P,M),y&&t.emit?.("edit-end",{record:f,index:D,key:P,value:M}),n.value=!1}async function J(){e.column?.editRow||await j()}function q(){n.value=!1,d.value=m.value;const{column:y,index:S,record:L}=e,{key:D}=y;i.value=!0,u.value="",t.emit?.("edit-cancel",{record:L,index:S,key:D,value:a(d)})}function X(){if(e.column?.editable||a(k))return;a(c).includes("NInput")&&q()}function R(y){l.value=y}function B(y,S){e.record&&(ce(e.record[y])?e.record[y]?.push(S):e.record[y]=[S])}return e.record&&(B("submitCbs",j),B("validCbs",W),B("cancelCbs",q),e.column.key&&(e.record.editValueRefs||(e.record.editValueRefs={}),e.record.editValueRefs[e.column.key]=d),e.record.onCancelEdit=()=>{ce(e.record?.cancelCbs)&&e.record?.cancelCbs.forEach(y=>y())},e.record.onSubmitEdit=async()=>{if(ce(e.record?.submitCbs)){const y=(e.record?.validCbs||[]).map(f=>f());return(await Promise.all(y)).every(f=>!!f)?((e.record?.submitCbs||[]).forEach(f=>f(!1,!1)),t.emit?.("edit-row-end"),!0):void 0}}),{isEdit:n,handleEdit:$,currentValueRef:d,handleSubmit:j,handleChange:A,handleCancel:q,elRef:s,getComponent:c,getRule:v,onClickOutside:X,ruleMessage:u,getRuleVisible:x,getComponentProps:o,handleOptionsChange:R,getWrapperStyle:_,getWrapperClass:C,getRowEditable:k,getValues:r,handleEnter:J}}});const Ds={class:"editable-cell"},Ps={class:"flex editable-cell-content"},Rs={class:"editable-cell-content-comp"},zs={key:0,class:"editable-cell-action"};function As(e,t,n,s,i,u){const l=pt,d=Y,m=Ne("CellComponent"),c=Ss,v=bs,x=et("click-outside");return b(),O("div",Ds,[Ee(T("div",{class:"editable-cell-content",onClick:t[0]||(t[0]=(...h)=>e.handleEdit&&e.handleEdit(...h))},[z(V(e.getValues)+" ",1),e.column.editRow?Z("",!0):(b(),H(d,{key:0,class:"edit-icon"},{default:p(()=>[g(l)]),_:1}))],512),[[Fe,!e.isEdit]]),Ee((b(),O("div",Ps,[T("div",Rs,[g(m,oe(e.getComponentProps,{ref:"elRef",component:e.getComponent,style:e.getWrapperStyle,"popover-visible":e.getRuleVisible,"rule-message":e.ruleMessage,rule:e.getRule,class:e.getWrapperClass,onOptionsChange:e.handleOptionsChange,onPressEnter:e.handleEnter}),null,16,["component","style","popover-visible","rule-message","rule","class","onOptionsChange","onPressEnter"])]),e.getRowEditable?Z("",!0):(b(),O("div",zs,[g(d,{class:"mx-2 cursor-pointer"},{default:p(()=>[g(c,{onClick:e.handleSubmit},null,8,["onClick"])]),_:1}),g(d,{class:"mx-2 cursor-pointer"},{default:p(()=>[g(v,{onClick:e.handleCancel},null,8,["onClick"])]),_:1})]))])),[[Fe,e.isEdit],[x,e.onClickOutside]])])}const Ms=He(Os,[["render",As]]);function Hs(e){return(t,n)=>{const s=e.key,i=t[s];return t.onEdit=async(u,l=!1)=>(l||(t.editable=u),!u&&l?await t.onSubmitEdit?.()?(t.editable=!1,!0):!1:(!u&&!l&&t.onCancelEdit?.(),!0)),I(Ms,{value:i,record:t,column:e,index:n})}}function Bs(e){const t=w(a(e).columns);let n=a(e).columns;const s=N(()=>{const h=he(a(t));if(!h.some(o=>o.type==="selection")){const o=n.find(r=>r.type==="selection");o&&h.unshift(o)}return d(e,h),h||[]}),{hasPermission:i}=rt();function u(h){const{ifShow:o}=h;let r=!0;return G(o)&&(r=o),fe(o)&&(r=o(h)),r}const l=N(()=>{const h=a(s);return he(h).filter(r=>i(r.auth)&&u(r)).map(r=>{r.ellipsis=typeof r.ellipsis>"u"?{tooltip:!0}:!1;const{edit:_}=r;if(_&&(r.render=Hs(r),_)){const C=r.title;r.title=()=>g(ze,null,{trigger:()=>g("span",null,[g("span",{style:{"margin-right":"5px"}},[C]),g(Y,{size:14},{default:()=>[g(pt,null,null)]})]),default:()=>"该列可编辑"})}return r})});Ae(()=>a(e).columns,h=>{t.value=h,n=h});function d(h,o){const{actionColumn:r}=a(h);r&&!o.find(_=>_.key==="action")&&o.push({...r})}function m(h){const o=he(h);if(!ce(o))return;if(!o.length){t.value=[];return}const r=n.map(_=>_.key);if(!Oe(o[0]))t.value=o;else{const _=[];n.forEach(C=>{h.includes(C.key)&&_.push({...C})}),Nt(r,o)||_.sort((C,k)=>r.indexOf(C.key)-r.indexOf(k.key)),t.value=_}}function c(){return le(a(s)).map(o=>({...o,title:o.title,key:o.key,fixed:o.fixed||void 0}))}function v(h){return h?n.map(o=>o.key):n}function x(h,o){!h||!o||n.forEach(r=>{r.key===h&&Object.assign(r,o)})}return{getColumnsRef:s,getCacheColumns:v,setCacheColumnsField:x,setColumns:m,getColumns:c,getPageColumns:l}}const Fs={table:{apiSetting:{pageField:"page",sizeField:"size",listField:"data",totalField:"total"},defaultPageSize:10,pageSizes:[5,10,20,50,100]},upload:{apiSetting:{infoField:"data",imgField:"photo"},maxSize:2,fileType:["image/png","image/jpg","image/jpeg","image/gif","image/svg+xml"]}},{table:Vs}=Fs,{apiSetting:Gs,defaultPageSize:Ws,pageSizes:Ks}=Vs,js=Ws,ue=Gs,Us=Ks;function qs(e,{getPaginationInfo:t,setPagination:n,setLoading:s,tableData:i},u){const l=w([]);ve(()=>{i.value=a(l)}),Ae(()=>a(e).dataSource,()=>{const{dataSource:o}=a(e);o&&(l.value=o)},{immediate:!0});const d=N(()=>{const{rowKey:o}=a(e);return o||(()=>"key")}),m=N(()=>{const o=a(l);return!o||o.length===0?a(l):a(l)});async function c(o){const{request:r,pagination:_,data:C}=a(e);if(!r&&C){l.value=C;return}try{s(!0);const{pageField:k}=ue,{sizeField:$}=ue,{totalField:A}=ue,{listField:W}=ue;let j={};const{page:J=1,pageSize:q=10}=a(t);G(_)&&!_||G(t)?j={}:(j[k]=o&&o[k]||J,j[$]=q);const X={...j},R=await r(X),B=Math.ceil(R[A]/R[$])||0,y=R[k];B&&J>B&&(n({[k]:B}),c(o));const S=R[W]?R[W]:[];l.value=S,n({[k]:y,[A]:B}),o&&o[k]&&n({[k]:o[k]||1}),u("fetch-success",{items:a(S),resultTotal:B})}catch(k){console.error(k),u("fetch-error",k),l.value=[]}finally{s(!1)}}Et(()=>{setTimeout(()=>{c()},16)});function v(o){l.value=o}function x(){return m.value}async function h(o){await c(o)}return{fetch:c,getRowKey:d,getDataSourceRef:m,getDataSource:x,setTableData:v,reload:h}}function Xs(e){const t=w({}),n=w(!0),s=N(()=>{const{pagination:m}=a(e);if(!a(n)||G(m)&&!m)return!1;const{totalField:c}=ue;return{pageSize:js,pageSizes:Us,showSizePicker:!0,showQuickJumper:!1,...G(m)?{}:m,...a(t),pageCount:a(t)[c]}});function i(m){const c=a(s);t.value={...G(c)?{}:c,...m}}function u(){return a(s)}function l(){return a(n)}async function d(m){n.value=m}return{getPagination:u,getPaginationInfo:s,setShowPagination:d,getShowPagination:l,setPagination:i}}const Ys={...Ot,title:{type:String,default:null},titleTooltip:{type:String,default:null},size:{type:String,default:"medium"},tableData:{type:[Object],default:()=>[]},columns:{type:[Array],default:()=>[],required:!0},request:{type:Function,default:null},rowKey:{type:[String,Function],default:void 0},pagination:{type:[Object,Boolean],default:()=>{}},actionColumn:{type:Object,default:null},showAdvanced:_e.bool.def(!0),canResize:_e.bool.def(!0),resizeHeightOffset:_e.number.def(0)},{t:ye}=Me(),Zs=[{type:"menu",label:ye("component.table.settingDensSmall"),key:"small"},{type:"menu",label:ye("component.table.settingDensDefault"),key:"medium"},{type:"menu",label:ye("component.table.settingDensLoose"),key:"large"}],Js=U({components:{ColumnSetting:ft},props:Ys,emits:["fetch-success","fetch-error","update:checked-row-keys","edit-end","edit-cancel","edit-row-end","edit-change"],setup(e,{emit:t}){const n=w(150),s=w(),i=w(),u=w();let l;const d=w([]),m=w(),c=N(()=>({...e,...a(m)})),{getLoading:v,setLoading:x}=ms(c),{getPaginationInfo:h,setPagination:o}=Xs(c),{getDataSourceRef:r,getRowKey:_,reload:C}=qs(c,{getPaginationInfo:h,setPagination:o,tableData:d,setLoading:x},t),{getPageColumns:k,setColumns:$,getColumns:A,getCacheColumns:W,setCacheColumnsField:j}=Bs(c),{toggle:J,isFullscreen:q}=Dt(i,{autoExit:!0}),X=Je({tableSize:a(c).size||"medium",isColumnSetting:!1});function R(E){o({page:E}),C()}function B(E){o({page:1,pageSize:E}),C()}function y(E){X.tableSize=E}const S=N(()=>X.tableSize),L=N(()=>{const E=a(r),te=E.length&&a(M)?`${a(n)}px`:"auto";return{...a(c),loading:a(v),rowKey:a(_),data:E,size:a(S),remote:!0,"max-height":te}}),D=N(()=>le(a(h)));function f(E){m.value={...a(m),...E}}const P={reload:C,setColumns:$,setLoading:x,setProps:f,getColumns:A,getPageColumns:k,getCacheColumns:W,setCacheColumnsField:j,emit:t},M=N(()=>{const{canResize:E}=a(c);return E});async function K(){const E=Pt(s);if(!E||!a(M))return;const te=E.querySelector(".n-data-table-thead"),{bottomIncludeBody:Ce}=Zt(te),we=64;let ae=2;const ke=24;if(!G(D))if(l=E.querySelector(".n-data-table__pagination"),l){const{offsetHeight:F}=l;ae+=F||0}else ae+=28;let ie=Ce-(we+ae+ke+(e.resizeHeightOffset||0));const{maxHeight:re}=e;ie=re&&re<ie?re:ie,n.value=ie}return ps(K,280,{immediate:!0}),Yn({...P,wrapRef:u,getBindValues:L}),{t:ye,...Qe(X),tableElRef:s,tableContainerRef:i,toggle:J,isFullscreen:q,getBindValues:L,densityOptions:Zs,reload:C,densitySelect:y,updatePage:R,updatePageSize:B,getPageColumns:k,pagination:D,tableAction:P}}});const Qs={key:0,class:"table-toolbar"},ei={class:"flex items-center table-toolbar-left"},ti={key:0,class:"table-toolbar-left-title"},ni={class:"flex items-center table-toolbar-right"},si={class:"table-toolbar-right-icon"},ii={class:"s-table"},oi={class:"table-info"};function li(e,t,n,s,i,u){const l=en,d=ze,m=Jt,c=Qt,v=fs,x=rs,h=at,o=ft,r=Ln,_=Y,C=At,k=Mt;return b(),O("div",{ref:"tableContainerRef",class:zt({"table-full-screen":e.isFullscreen})},[e.showAdvanced?(b(),O("div",Qs,[T("div",ei,[e.title?(b(),O("div",ti,[z(V(e.title)+" ",1),e.titleTooltip?(b(),H(d,{key:0,trigger:"hover"},{trigger:p(()=>[g(l,{class:"text-18px text-$app-text-color-3 ml-1 cursor-pointer"})]),default:p(()=>[z(" "+V(e.titleTooltip),1)]),_:1})):Z("",!0)])):Z("",!0),se(e.$slots,"tableTitle",{},void 0,!0)]),T("div",ni,[se(e.$slots,"toolbar",{},void 0,!0),g(d,{trigger:"hover"},{trigger:p(()=>[T("div",{class:"table-toolbar-right-icon",onClick:t[0]||(t[0]=(...$)=>e.toggle&&e.toggle(...$))},[e.isFullscreen?(b(),H(m,{key:0,class:"text-18px"})):(b(),H(c,{key:1,class:"text-18px"}))])]),default:p(()=>[z(" "+V(e.isFullscreen?e.t("component.table.tooltipExitFull"):e.t("component.table.tooltipEntryFull")),1)]),_:1}),g(d,{trigger:"hover"},{trigger:p(()=>[T("div",{class:"table-toolbar-right-icon",onClick:t[1]||(t[1]=(...$)=>e.reload&&e.reload(...$))},[g(v,{class:"text-18px"})])]),default:p(()=>[T("span",null,V(e.t("component.table.refresh")),1)]),_:1}),g(d,{trigger:"hover"},{trigger:p(()=>[T("div",si,[g(h,{value:e.tableSize,"onUpdate:value":t[2]||(t[2]=$=>e.tableSize=$),trigger:"click",options:e.densityOptions,onSelect:e.densitySelect},{default:p(()=>[g(x,{class:"text-18px"})]),_:1},8,["value","options","onSelect"])])]),default:p(()=>[T("span",null,V(e.t("component.table.settingDens")),1)]),_:1}),g(o)])])):Z("",!0),T("div",ii,[g(k,oe({ref:"tableElRef"},e.getBindValues,{columns:e.getPageColumns,pagination:e.pagination,"onUpdate:page":e.updatePage,"onUpdate:pageSize":e.updatePageSize}),xe({empty:p(()=>[g(C,{size:"huge"},{icon:p(()=>[g(_,null,{default:p(()=>[g(r)]),_:1})]),_:1})]),_:2},[be(Object.keys(e.$slots),$=>({name:$,fn:p(A=>[se(e.$slots,$,lt(Rt(A)),void 0,!0)])}))]),1040,["columns","pagination","onUpdate:page","onUpdate:pageSize"]),T("div",oi,[se(e.$slots,"info",{},void 0,!0)])])],2)}const ai=He(Js,[["render",li],["__scopeId","data-v-a4c0c6fe"]]),ri=U({__name:"popConfirmWrapper",props:{isWrapper:Boolean},setup(e){const t=Ht(),n=N(()=>ot({showIcon:!0,...t},["title","icon"]));return(s,i)=>{const u=ct,l=Bt;return e.isWrapper?(b(),H(l,lt(oe({key:0},a(n))),xe({trigger:p(()=>[se(s.$slots,"default")]),default:p(()=>[z(" "+V(a(t).title),1)]),_:2},[a(t).icon?{name:"icon",fn:p(()=>[g(u,{icon:a(t).icon},null,8,["icon"])]),key:"0"}:void 0]),1040)):se(s.$slots,"default",{key:1})}}}),ci={class:"tableAction"},ui={class:"flex items-center justify-center py-1 px-2 space-x-2"},hi={name:"TableAction"},di=U({...hi,props:{actions:null,dropDownActions:null,style:{default:"button"},select:null},setup(e){const t=e,{hasPermission:n}=rt(),s=t.style==="button"?"default":t.style==="text"?"primary":"default",i=t.style==="button"?void 0:t.style==="text"?!0:void 0,u=N(()=>({text:i,type:s,size:"small"})),l=N(()=>(le(t.dropDownActions)||[]).filter(c=>n(c.auth)&&m(c))),d=N(()=>(le(t.actions)||[]).filter(c=>n(c.auth)&&m(c)).map(c=>{const{popConfirm:v}=c;return{size:"small",text:i,type:s,...c,...v||{},enable:!!v}}));function m(c){const v=c.ifShow;let x=!0;return G(v)&&(x=v),fe(v)&&(x=v(c)),x}return(c,v)=>{const x=ct,h=de,o=tn,r=at;return b(),O("div",ci,[T("div",ui,[(b(!0),O(Re,null,be(a(d),({icon:_,label:C,enable:k,popConfirm:$,...A},W)=>(b(),H(ri,oe({key:`${W}-${C}`,"is-wrapper":k},$),{default:p(()=>[g(h,oe(A,{style:{padding:"0 6px"}}),xe({default:p(()=>[z(V(C),1)]),_:2},[_?{name:"icon",fn:p(()=>[g(x,{icon:_},null,8,["icon"])]),key:"0"}:void 0]),1040)]),_:2},1040,["is-wrapper"]))),128)),e.dropDownActions&&a(l).length?(b(),H(r,{key:0,trigger:"hover",placement:"bottom-end",options:a(l),onSelect:e.select},{default:p(()=>[se(c.$slots,"more",{},()=>[g(h,oe(a(u),{quaternary:"",focusable:!1,style:{padding:"0 6px"}}),{icon:p(()=>[g(o)]),_:1},16)])]),_:3},8,["options","onSelect"])):Z("",!0)])])}}}),fi={style:{color:"var(--app-primary-color)"}},Ai=U({__name:"index",setup(e){const{getIsMobile:t}=nn(),{t:n}=Me(),{message:s,confirm:i}=Xt(),{runLogModal:u}=sn(),l=w("fade-slide");on(l);const d=w("system"),m=w([{type:"system",name:"系统任务"},{type:"user",name:"用户任务"}]),c=w(),v=w(),x=w(),h=w([]),o=w([]),r=w(""),_=w([]),C=w([]),k=[{type:"selection",key:"selection"},{title:"任务名称",key:"name",defaultFilterOptionValues:[],filterOptions:C,filter(){}},{title:"执行命令",key:"shell",width:"25%"},{title:"定时规则",key:"cron"},{title:"任务状态",key:"active",align:"center",render(f){return I(Ve,{type:f.active===1?"success":"error"},{default:()=>f.active===1?"启用":"禁用"})},defaultFilterOptionValues:[],filterOptions:[{label:"启用",value:1},{label:"禁用",value:0}],filter(){}},{title:"运行状态",key:"running_status",align:"center",render(f){return I(Ve,{type:f.running_status?"warning":void 0},{default:()=>f.running_status?"正在运行":"空闲",icon:()=>I(Y,null,{default:()=>f.running_status?I(pn):I(fn)})})}},{title:"最后运行",key:"last_runtime",align:"center"},{title:"备注",key:"remark"}],$={title:"操作",key:"action",width:280,render(f){return I(di,{style:"button",actions:[{label:"编辑",icon:"mdi-square-edit-outline",quaternary:!0,focusable:!1,onClick:A.bind(null,f)},{label:"调试",icon:"mdi-bug-play-outline",quaternary:!0,focusable:!1,onClick:W.bind(null,f)}],dropDownActions:[{label:f.active===1?"禁用":"启用",key:"changeStatus",icon:()=>I(Y,null,{default:()=>f.active===1?I(dn):I(hn)}),props:{onClick:J.bind(null,f)}},{label:()=>I($e,{style:{color:"var(--app-error-color)"}},{default:()=>"删除"}),key:"Delete",icon:()=>I(Y,{color:"var(--app-error-color)"},{default:()=>I(Ie)}),props:{onClick:q.bind(null,f)}}]})}},A=async f=>{v.value?.open(f)},W=async f=>{u.value?.open({title:`${f.name}`,cmd:f.shell})};(async()=>{const f=await an();C.value=f.map(P=>({value:P.bind,label:P.bind||"(空)"}))})();const J=async f=>{try{await rn({id:f.id,active:f.active===0?1:0}),s.success(f.active===1?"已禁用":"已启用",{duration:1e3}),f.active===0?f.active=1:f.active=0}catch{s.error(f.active===1?"禁用失败":"启用失败")}},q=f=>{i.error({title:n("file.delete.title"),content:n("file.delete.confirm"),icon:()=>I(Y,null,{default:()=>I(Ie)}),closable:!1,maskClosable:!1,autoFocus:!1,positiveText:n("file.delete.button"),onPositiveClick:async()=>{try{await Ge({id:f.id}),s.success("删除成功")}catch{s.error("删除失败")}finally{R()}}})},X=()=>{i.error({title:n("file.delete.title"),content:n("file.delete.batchConfirm"),icon:()=>I(Y,null,{default:()=>I(Ie)}),closable:!1,maskClosable:!1,autoFocus:!1,positiveText:n("file.delete.button"),onPositiveClick:async()=>{try{await Ge({id:_.value.join(",")}),s.success("删除成功")}catch{s.error("删除失败")}finally{R()}}})},R=()=>{c.value?.reload(),_.value=[]},B=()=>{S.value="",R()},y=f=>{h.value=f.active,o.value=f.name},S=w(""),L=async f=>await cn({page:f.page,size:f.size,type:d.value,search:S.value||"",active:h.value.join(","),tags:o.value.join(","),remark:r.value}),D=()=>{v.value?.open({type:d.value})};return(f,P)=>{const M=Vt,K=Gt,E=kn,te=qt,Ce=it,we=Wt,ae=vn,ke=Kt,ie=jt,re=Ut;return b(),H(re,{ref:"pageWrapper"},{default:p(()=>[g(ie,{bordered:!a(t),style:{height:"100%"}},{header:p(()=>[g(K,{value:a(d),"onUpdate:value":[P[0]||(P[0]=F=>Se(d)?d.value=F:null),R],type:"line"},{default:p(()=>[(b(!0),O(Re,null,be(a(m),F=>(b(),H(M,{key:F.type,name:F.type},{default:p(()=>[z(V(F.name),1)]),_:2},1032,["name"]))),128))]),_:1},8,["value"])]),default:p(()=>[g(a(ai),{ref_key:"tableRef",ref:c,"checked-row-keys":a(_),"onUpdate:checkedRowKeys":P[2]||(P[2]=F=>Se(_)?_.value=F:null),"pagination-behavior-on-filter":"first",columns:a(k),request:L,"row-key":F=>F.id,"action-column":$,"onUpdate:filters":y},xe({tableTitle:p(()=>[g(a(nt),null,{default:p(()=>[g(a(de),{type:"primary",size:"small",style:{padding:"0 8px"},focusable:!1,onClick:D},{icon:p(()=>[g(E)]),default:p(()=>[z(" 新建任务 ")]),_:1}),g(we,null,{default:p(()=>[g(Ce,{value:a(S),"onUpdate:value":P[1]||(P[1]=F=>Se(S)?S.value=F:null),size:"small",clearable:"",placeholder:"请输入搜索内容","on-clear":B,onKeyup:R},{prefix:p(()=>[g(te)]),_:1},8,["value"]),a(S)?(b(),H(a(de),{key:0,size:"small",type:"primary",focusable:!1,onClick:R},{default:p(()=>[z(" 搜索 ")]),_:1})):Z("",!0)]),_:1})]),_:1})]),toolbar:p(()=>[a(_).length?(b(),H(Ft,{key:0,name:a(l),mode:"out-in",appear:""},{default:p(()=>[g(a(de),{size:"small",type:"error",focusable:!1,onClick:X},{icon:p(()=>[g(ae)]),default:p(()=>[z(" 批量删除 ")]),_:1})]),_:1},8,["name"])):Z("",!0),a(_).length?(b(),H(ke,{key:1,class:"!ml-5",vertical:""})):Z("",!0)]),_:2},[a(_).length?{name:"info",fn:p(()=>[g(a($e),null,{default:p(()=>[z("已选择")]),_:1}),z("  "),T("span",fi,V(a(_).length),1),z("  "),g(a($e),null,{default:p(()=>[z("项")]),_:1})]),key:"0"}:void 0]),1032,["checked-row-keys","columns","row-key"])]),_:1},8,["bordered"]),g(ln,{ref_key:"editTaskModal",ref:v,onOk:R},null,512),g(un,{ref_key:"historyModal",ref:x},null,512)]),_:1},512)}}});export{Ai as default};
