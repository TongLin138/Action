var x=(V,g,l)=>new Promise((k,z)=>{var h=r=>{try{d(l.next(r))}catch(c){z(c)}},v=r=>{try{d(l.throw(r))}catch(c){z(c)}},d=r=>r.done?k(r.value):Promise.resolve(r.value).then(h,v);d((l=l.apply(V,g)).next())});import{_ as le}from"./PageWrapper.vue_vue_type_style_index_0_lang-iCdyxX7_.js";import{a as ie,c as re,_ as ue}from"./index-lXlFquMP.js";import{_ as ce,a as pe,b as _e}from"./sliders-horizontal-bold-1dPJ5zDp.js";import{_ as de,f as fe}from"./folderDisable-JQ-cQSbx.js";import{_ as me}from"./shortcut-N3-a_HkT.js";import{_ as ge,a as ve}from"./find-replace-2UcMKkk2.js";import{_ as ye}from"./swap-outlined-YCG3qHHs.js";import{H as he,y as i,D as be,aL as we,aM as xe,a7 as N,a8 as B,a9 as t,aa as n,u as e,aE as M,ay as ke,aN as u,aO as $,aI as E,at as ze,aD as U,am as _,aP as Ce,an as Ne,aQ as Be,aC as Ee,aR as Ie,aS as Se,aT as Te,aK as $e}from"./vendor-88CfsZ0h.js";import{_ as Fe}from"./index.vue_vue_type_style_index_0_lang-HZK011BJ.js";import{u as Oe}from"./useAppInject-htw12zLS.js";import{u as De}from"./useTransition-f93yfBB3.js";import{F as Pe}from"./fileTreeEnum-nxCMH85-.js";import{s as Le,g as Ve,a as We}from"./file-nlIWw8Qn.js";import{f as A,a as je,b as Me}from"./index-2ITmi_Ad.js";import{f as Ue}from"./filePrefix-kRqy0MsR.js";import"./sharp-arrow-back-ios-T556WsKB.js";import"./useDesign-SmALCiTA.js";import"./propTypes-XBNzJcxe.js";const un=he({__name:"index",setup(V){const{getIsMobile:g}=Oe(),{t:l}=ie(),{message:k}=re(),z=i("fade-slide");De(z);const h=i([]),v=i({}),d=i(),r=i({content:"",language:""}),c=i(""),I=i(!g.value),S=i(g.value?"on":"off"),F=i(!1),O=i(!1),D=i(!1),T=i(g.value?13:15),P=i(!1),y=i(!1),C=o=>x(this,null,function*(){switch(o){case"findBox":P.value=!P.value,y.value=!1;break;case"wordWrap":S.value=S.value==="on"?"off":"on",y.value=!1;break;case"minimap":I.value=!I.value,y.value=!1;break;case"showEditorShortcutsInfo":d.value.showShortCuts();break;case"save":F.value=!0;const a=e(d).getValue();try{yield Le({content:a,path:v.value.path}),k.success(l("editor.main.savedSuccess"))}finally{F.value=!1,yield W()}break}}),W=()=>x(this,null,function*(){D.value=!0;const o=yield Ve({type:Pe.CONFIG}),a=R(o);h.value=a,D.value=!1}),R=o=>{const a=b=>{b.length&&b.forEach(s=>{if(s.type===0)Object.assign(s,{key:s.path,label:s.title,disabled:!0,prefix:()=>_(u,null,{default:()=>_(A)})}),a(s.children),s.children.length||(Object.assign(s,{children:null,disabled:!0}),s.prefix=()=>_(u,null,{default:()=>_(fe)}));else{const w=s.name;if(w){const L=w.substring(w.lastIndexOf(".")+1),p=Me[L]||{};Object.assign(s,{key:s.path,label:w,language:p.language||"plaintext",disabled:p.disabled||!1,prefix:()=>_(u,null,{default:()=>_(p.icon||Ue)})})}}})};a(o);const f=b=>b.filter(s=>s.children?(s.children=f(s.children),!0):!s.disabled);return o=f(o),o},q=(o,a,f)=>{if(f.node)switch(f.action){case"expand":f.node.prefix=()=>_(u,null,{default:()=>_(je)});break;case"collapse":f.node.prefix=()=>_(u,null,{default:()=>_(A)});break}},H=({option:o})=>({onClick(){return x(this,null,function*(){!o.children&&!o.disabled&&(v.value=o,yield j(o))})}});function j(o){return x(this,null,function*(){O.value=!0;const a=yield We({path:encodeURI(o.key)});a?r.value={content:a,language:o.language}:(r.value={content:"",language:""},k.info(l("page.config.fileContentIsEmptyMsg"))),O.value=!1})}function G(){return x(this,null,function*(){yield W();let o={};if(h.value.length)for(const a of h.value)a.type===1&&a.name==="config.sh"&&(o=a);o.path?(v.value=o,j(v.value),c.value=v.value.path):k.error(l("page.config.mainConfigNotExistsMsg"),{keepAliveOnHover:!0})})}return be(c,o=>{o||(r.value={content:"",language:""})}),we(()=>{G()}),xe(()=>{d.value&&d.value.dispose()}),(o,a)=>{const f=Ce,b=ce,s=Ne,w=pe,L=Be,p=Ee,K=ge,Q=ye,J=ve,X=Ie,Y=me,Z=Se,ee=de,ne=_e,ae=Te,te=ue,oe=$e,se=le;return N(),B(se,{ref:"pageWrapper","content-full":""},{title:t(()=>[n(f,{value:e(c),"onUpdate:value":a[0]||(a[0]=m=>M(c)?c.value=m:null),size:"small",class:"min-w-190px",loading:e(D),"consistent-menu-width":!1,clearable:"",placeholder:e(l)("page.config.selectConfigFilePlaceholder"),options:e(h),"node-props":H,"on-update:expanded-keys":q},null,8,["value","loading","placeholder","options"])]),extra:t(()=>[e(c)?(N(),B(ke,{key:0,name:e(z),mode:"out-in",appear:""},{default:t(()=>[n(p,{style:{width:"fix-content"}},{default:t(()=>[n(p,{style:{gap:"0"}},{default:t(()=>[n(X,{trigger:"manual",style:{padding:"8px"},show:e(y),"show-arrow":!1,placement:"bottom"},{trigger:t(()=>[n(s,{strong:"",quaternary:"",size:"small",type:e(y)?"primary":"tertiary",style:{padding:"6px"},focusable:!1,onClick:a[1]||(a[1]=m=>y.value=!e(y))},{default:t(()=>[n(e(u),{size:"18"},{default:t(()=>[n(b,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1},8,["type"])]),default:t(()=>[n(p,{vertical:""},{default:t(()=>[n(p,{size:"small"},{default:t(()=>[n(e(u),{size:20},{default:t(()=>[n(w,{style:{"vertical-align":"-0.4em"}})]),_:1}),n(L,{value:e(T),"onUpdate:value":a[2]||(a[2]=m=>M(T)?T.value=m:null),min:12,max:40,"button-placement":"both",size:"small",class:"max-w-94px",style:{"text-align":"center"}},null,8,["value"])]),_:1}),n(p,{size:"small"},{default:t(()=>[n(e(u),{size:20},{default:t(()=>[n(K,{style:{"vertical-align":"-0.4em"}})]),_:1}),n(s,{strong:"",secondary:"",size:"small",style:{width:"94px"},onClick:a[3]||(a[3]=m=>C("findBox"))},{default:t(()=>[$(E(e(l)("editor.switch.findBtn")),1)]),_:1})]),_:1}),n(p,{size:"small"},{default:t(()=>[n(e(u),{size:20,color:e(S)==="on"?"var(--app-primary-color)":void 0},{default:t(()=>[n(Q,{style:{"vertical-align":"-0.4em"}})]),_:1},8,["color"]),n(s,{strong:"",secondary:"",size:"small",style:{width:"94px"},onClick:a[4]||(a[4]=m=>C("wordWrap"))},{default:t(()=>[$(E(e(l)("editor.switch.wordWrapBtn")),1)]),_:1})]),_:1}),n(p,{size:"small"},{default:t(()=>[n(e(u),{size:20,color:e(I)?"var(--app-primary-color)":void 0},{default:t(()=>[n(J,{style:{"vertical-align":"-0.4em"}})]),_:1},8,["color"]),n(s,{strong:"",secondary:"",size:"small",style:{width:"94px"},onClick:a[5]||(a[5]=m=>C("minimap"))},{default:t(()=>[$(E(e(l)("editor.switch.minimapBtn")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["show"]),e(g)?U("",!0):(N(),B(Z,{key:0,placement:"bottom",trigger:"hover",delay:500},{trigger:t(()=>[n(s,{strong:"",quaternary:"",size:"small",type:"tertiary",style:{padding:"6px"},focusable:!1,onClick:a[6]||(a[6]=m=>C("showEditorShortcutsInfo"))},{default:t(()=>[n(e(u),{size:"18"},{default:t(()=>[n(Y,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1})]),default:t(()=>[ze("span",null,E(e(l)("editor.switch.shortcutsTips")),1)]),_:1}))]),_:1}),n(s,{strong:"",type:"primary",size:"small",loading:e(F),focusable:!1,onClick:a[7]||(a[7]=m=>C("save"))},{icon:t(()=>[n(ee)]),default:t(()=>[$(" "+E(e(l)("editor.main.saveButton")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["name"])):U("",!0)]),default:t(()=>[n(oe,{bordered:!e(g),style:{height:"100%","word-break":"unset"},"content-style":"padding: 0"},{default:t(()=>[e(c)?(N(),B(Fe,{key:0,ref_key:"editor",ref:d,value:e(r),"word-wrap":e(S),minimap:e(I),"font-size":e(T),"find-box":e(P)},null,8,["value","word-wrap","minimap","font-size","find-box"])):(N(),B(ae,{key:1,class:"min-h-200px flex-jc-ac h-full",size:"huge",description:e(l)("common.selectFileEmptyDesc")},{icon:t(()=>[n(e(u),null,{default:t(()=>[n(ne)]),_:1})]),_:1},8,["description"])),n(te,{show:e(O)},null,8,["show"])]),_:1},8,["bordered"])]),_:1},512)}}});export{un as default};
