import{a6 as i,as as I,aG as p,a7 as g,a8 as t,ac as o,aJ as h,G as Ze,x as r,C as Oe,aI as Se,u as e,aQ as y,aC as w,aD as C,aK as de,aE as X,av as Fe,al as _,y as pe,bf as Ae,am as He,aN as We,b3 as Ve,bn as je,a$ as Ge,bo as Je,ba as Ue,bp as Qe,bq as Xe,bI as Ye,bs as Ke,aR as et,bt as tt,aH as nt}from"./vendor-95d24bd5.js";import{_ as ot}from"./PageWrapper.vue_vue_type_style_index_0_lang-fd31c3a1.js";import{f as _e,a as lt,_ as at,b as st,c as rt,d as it}from"./folderOpen-2a6ea35b.js";import{_ as ct}from"./search2-line-49f1ddd8.js";import{_ as ut}from"./map-outline-a1172694.js";import{d as ge,a as Y,b as me,_ as dt,f as pt}from"./delete-db041e54.js";import{_ as ve,c as _t,b as gt,L as V,k as fe}from"./index-1a66f6b1.js";import{u as mt}from"./useAppInject-27ca0bbd.js";import{u as ft}from"./useTransition-8b9ea612.js";import{F as ht}from"./fileTreeEnum-8c192873.js";import{d as he,c as vt,g as yt,a as bt}from"./file-e78de043.js";import"./sharp-arrow-back-ios-6d3804a3.js";import"./useDesign-828d8e9e.js";import"./propTypes-8a448afd.js";import"./trash-a2b3ccea.js";const kt={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"},wt=p("path",{fill:"currentColor",d:"m12 16l4-4l-1.4-1.4l-1.6 1.6V8h-2v4.2l-1.6-1.6L8 12l4 4Zm0 6q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22Zm0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20Zm0-8Z"},null,-1),Tt=[wt];function xt(R,c){return i(),I("svg",kt,Tt)}const Ct={name:"material-symbols-arrow-circle-down-outline",render:xt},$t={};function Dt(R,c){const j=Ct,v=h;return i(),g(v,null,{default:t(()=>[o(j,{style:{"vertical-align":"baseline"}})]),_:1})}const qt=ve($t,[["render",Dt]]),Lt={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"},Mt=p("path",{fill:"currentColor",d:"M12 20q-3.35 0-5.675-2.325T4 12q0-3.35 2.325-5.675T12 4q1.725 0 3.3.712T18 6.75V5q0-.425.288-.713T19 4q.425 0 .713.288T20 5v5q0 .425-.288.713T19 11h-5q-.425 0-.713-.288T13 10q0-.425.288-.713T14 9h3.2q-.8-1.4-2.188-2.2T12 6Q9.5 6 7.75 7.75T6 12q0 2.5 1.75 4.25T12 18q1.7 0 3.113-.863t2.187-2.312q.2-.35.563-.487t.737-.013q.4.125.575.525t-.025.75q-1.025 2-2.925 3.2T12 20Z"},null,-1),Nt=[Mt];function zt(R,c){return i(),I("svg",Lt,Nt)}const Rt={name:"material-symbols-refresh-rounded",render:zt},Pt={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"},It=p("path",{fill:"currentColor",d:"m18.031 16.617l4.283 4.282l-1.415 1.415l-4.282-4.283A8.96 8.96 0 0 1 11 20c-4.968 0-9-4.032-9-9s4.032-9 9-9s9 4.032 9 9a8.96 8.96 0 0 1-1.969 5.617Zm-2.006-.742A6.977 6.977 0 0 0 18 11c0-3.867-3.133-7-7-7s-7 3.133-7 7s3.133 7 7 7a6.977 6.977 0 0 0 4.875-1.975l.15-.15ZM10 10V7h2v3h3v2h-3v3h-2v-3H7v-2h3Z"},null,-1),Bt=[It];function Et(R,c){return i(),I("svg",Pt,Bt)}const Zt={name:"ri-zoom-in-line",render:Et},Ot={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"},St=p("path",{fill:"currentColor",d:"m18.031 16.617l4.283 4.282l-1.415 1.415l-4.282-4.283A8.96 8.96 0 0 1 11 20c-4.968 0-9-4.032-9-9s4.032-9 9-9s9 4.032 9 9a8.96 8.96 0 0 1-1.969 5.617Zm-2.006-.742A6.977 6.977 0 0 0 18 11c0-3.867-3.133-7-7-7s-7 3.133-7 7s3.133 7 7 7a6.977 6.977 0 0 0 4.875-1.975l.15-.15ZM7 10h8v2H7v-2Z"},null,-1),Ft=[St];function At(R,c){return i(),I("svg",Ot,Ft)}const Ht={name:"ri-zoom-out-line",render:At},Wt={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"},Vt=p("g",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"},[p("path",{d:"M21 12V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14c0 1.1.9 2 2 2h7.5M16 2v4M8 2v4m-5 4h18"}),p("path",{d:"M18 21a3 3 0 1 0 0-6a3 3 0 0 0 0 6v0Zm4 1l-1.5-1.5"})],-1),jt=[Vt];function Gt(R,c){return i(),I("svg",Wt,jt)}const Jt={name:"lucide-calendar-search",render:Gt},Ut={class:"pb-1 mr-3"},Qt={class:"pb-1 mr-3"},Xt=Ze({__name:"index",setup(R){const{message:c,confirm:j}=_t(),{getIsMobile:v}=mt(),{t:a}=gt(),G=r("fade-slide");ft(G);const J=r([]),$=r(""),f=r(""),ye=r(),B=r(!v.value),E=r(v.value?"on":"off"),Z=r(null),D=r(v.value?13:15),q=r(null),K=r([]),ee=r(0),te=r(0),T=r(!1),O=r(!1),S=r(!1),U=r(void 0),F=r(!0),A=r(!1),Q=r(!1),H=r(!1),b=r(null),k=r(null),m=async l=>{switch(l){case"bottom":Z.value?.scrollTo({position:"bottom",slient:!0});break;case"changeToEditor":T.value=!T.value,T.value&&c.info(a("editor.switch.changeToEditorMsg"));break;case"showDateTimeRangePicker":S.value=!S.value;break;case"clickRightClickMenu":O.value=!1;break;case"exitRightClickMenu":O.value=!1,L("rightClickMenu");break;case"enlarge":D.value<24?D.value+=1:D.value===24&&c.info(a("page.runLog.enlargeMaxMsg"));break;case"narrow":D.value>12?D.value-=1:D.value===12&&c.info(a("page.runLog.narrowMinMsg"));break;case"refresh":if(Q.value=!0,b.value){const M=e(f);await le(b.value.key),M===f.value?c.info(a("page.runLog.logContentIsLatestMsg")):pe(()=>{Z.value?.scrollTo({position:"bottom",slient:!0})})}W(),Q.value=!1;break;case"wordWrap":E.value=E.value==="on"?"off":"on";break;case"minimap":B.value=!B.value;break;case"requireJump":if(H.value)return;H.value=!0,setTimeout(()=>{H.value=!1},1e3);break;case"delete":const n=k.value?k.value.key:b.value.key;j.error({title:a("file.delete.title"),content:a("file.delete.confirm"),icon:()=>_(h,null,{default:()=>_(Y)}),closable:!1,maskClosable:!1,autoFocus:!1,positiveText:a("file.delete.button"),onPositiveClick:async()=>{try{await vt({path:n}),c.success(a("file.delete.success")),b.value&&b.value.key===n&&(L("log"),L("content"),T.value=!1),W()}catch{}finally{L("rightClickMenu")}},onNegativeClick:()=>{L("rightClickMenu")},negativeButtonProps:{ghost:!1,tertiary:!0}});break;case"download":const u=k.value?k.value.key:b.value.key,s=k.value?k.value.label:b.value.label,P=k.value?k.value.isDir:b.value.isDir,x=c.loading(a("file.download.wait"),{duration:0});try{if(P){const{code:M,message:N,blob:z}=await he({path:u});x.destroy(),M?(c.success(a("file.download.success")),z&&me(z,`${s}.zip`)):N&&c.error(N)}else{const{code:M,message:N,blob:z}=await he({path:u});x.destroy(),M?(c.success(a("file.download.success")),z&&me(z,`${s}.log`)):N&&c.error(N)}}catch{x.destroy(),c.error(a("file.download.fail"),{keepAliveOnHover:!0})}finally{L("rightClickMenu")}break}},be={[a("page.runLog.dateTimePicker.today")]:()=>{const l=new Date().getTime();return[new Date().setHours(0,0,0,0),l]},[a("page.runLog.dateTimePicker.thisWeek")]:()=>{const l=new Date().getTime(),n=new Date().setHours(0,0,0,0),u=new Date().getDay();return[n-(u-1)*24*60*60*1e3,l]},[a("page.runLog.dateTimePicker.last2Hours")]:()=>{const l=new Date().getTime();return[l-2*60*60*1e3,l]},[a("page.runLog.dateTimePicker.last24Hours")]:()=>{const l=new Date().getTime();return[l-24*60*60*1e3,l]}},ke=l=>l>Date.now(),we=l=>{l||c.info(a("page.runLog.needSelectDateTimeRangeMsg"))},Te=l=>_(y,{placement:"right",delay:800,duration:500,style:{width:"max-content",fontSize:"12px"}},{trigger:()=>[l.option.label],default:()=>l.option.key}),ne=({option:l})=>({async onClick(){!l.children&&!l.disabled&&(U.value=!0,await le(l.key),pe(()=>{Z.value?.scrollTo({position:"top",slient:!0})}),b.value=l)},onContextmenu(n){v.value||(K.value=Ce(),O.value=!0,ee.value=n.clientX,te.value=n.clientY,n.preventDefault()),k.value=l}}),oe=(l,n,u)=>{if(u.node)switch(u.action){case"expand":u.node.prefix=()=>_(h,null,{default:()=>_(lt)});break;case"collapse":u.node.prefix=()=>_(h,null,{default:()=>_(_e)});break}},xe=l=>{const n=u=>{u.length&&u.forEach(s=>{if(s.type===0)Object.assign(s,{key:s.path,label:s.title,isDir:!0,prefix:()=>_(h,null,{default:()=>_(_e)})}),n(s.children),s.children.length||(Object.assign(s,{children:null,disabled:!0}),s.prefix=()=>_(h,null,{default:()=>_(pt)}));else{const P=s.name.replace(".log","");P&&Object.assign(s,{key:s.path,label:P,isDir:!1,prefix:()=>_(h,null,{default:()=>_(it)})})}})};return n(l),l},W=async()=>{F.value=!0;const l=Array.isArray(q.value)?q.value:[],n=l[0]?fe(l[0]):"",u=l[1]?fe(l[1]):"",s=await yt({type:ht.LOG,startTime:n,endTime:u});J.value=xe(s),F.value=!1},le=async l=>{A.value=!0;const n=encodeURI(l),u=await bt({path:n});A.value=!1,u?f.value=u:(L("log"),c.info(a("page.runLog.logContentIsEmptyMsg")))},Ce=()=>{const l={download:{label:a("file.download.button"),key:"download",icon:()=>_(h,null,{default:()=>_(ge)}),props:{onClick:()=>{m("download")}}},delete:{label:()=>_(Ae,{style:{color:"var(--app-error-color)"}},{default:()=>a("file.delete.button")}),key:"delete",icon:()=>_(h,{color:"var(--app-error-color)"},{default:()=>_(Y)}),props:{onClick:()=>{m("delete")}}}};return[l.download,l.delete]},L=l=>{switch(l){case"log":f.value="";break;case"content":b.value=null;break;case"rightClickMenu":k.value=null;break}};return Oe(q,()=>{W()}),Se(()=>{W()}),(l,n)=>{const u=dt,s=He,P=Jt,x=We,M=Ve,N=ut,z=at,$e=Ht,De=Zt,qe=Rt,Le=je,ae=ct,se=Ge,re=Je,Me=Ue,ie=Qe,ce=Xe,Ne=Ye,ze=st,ue=Ke,Re=rt,Pe=et,Ie=tt,Be=nt,Ee=ot;return i(),g(Ee,{ref:"pageWrapper","content-full":!0,title:e(a)("routes.main.page.runLog")},{subtitle:t(()=>[o(x,null,{default:t(()=>[o(x,{style:{gap:"0"}},{default:t(()=>[o(e(y),{placement:"bottom",trigger:"hover",delay:500},{trigger:t(()=>[o(s,{circle:"",strong:"",quaternary:"",size:"small",disabled:!e(f),type:e(T)?"primary":"tertiary",focusable:!1,onClick:n[0]||(n[0]=d=>m("changeToEditor"))},{default:t(()=>[o(u)]),_:1},8,["disabled","type"])]),default:t(()=>[p("span",null,w(e(a)("editor.switch.changeToEditorTips")),1)]),_:1}),e(v)?C("",!0):(i(),g(e(y),{key:0,placement:"bottom",trigger:"hover",delay:500},{trigger:t(()=>[o(s,{circle:"",strong:"",quaternary:"",size:"small",type:e(S)?"primary":"tertiary",focusable:!1,onClick:n[1]||(n[1]=d=>m("showDateTimeRangePicker"))},{default:t(()=>[o(P)]),_:1},8,["type"])]),default:t(()=>[p("span",null,w(e(a)("page.runLog.dateTimeRangeSearchTips")),1)]),_:1}))]),_:1}),e(S)?(i(),g(de,{key:0,name:e(G),mode:"out-in",appear:""},{default:t(()=>[o(M,{value:e(q),"onUpdate:value":n[2]||(n[2]=d=>X(q)?q.value=d:null),size:"small",type:"datetimerange",clearable:"",shortcuts:be,"is-date-disabled":ke,"on-confirm":we},null,8,["value"])]),_:1},8,["name"])):C("",!0)]),_:1})]),extra:t(()=>[o(de,{name:e(G),mode:"out-in",appear:""},{default:t(()=>[o(x,null,{default:t(()=>[e(T)?(i(),g(x,{key:0,style:{gap:"0"}},{default:t(()=>[e(v)?(i(),g(e(y),{key:0,placement:"bottom",trigger:"hover",delay:500},{trigger:t(()=>[o(s,{strong:"",quaternary:"",type:e(B)?"primary":"tertiary",size:"small",focusable:!1,onClick:n[3]||(n[3]=d=>m("minimap"))},{default:t(()=>[o(N)]),_:1},8,["type"])]),default:t(()=>[p("span",null,w(e(a)("editor.switch.minimapTips")),1)]),_:1})):C("",!0),o(e(y),{placement:"bottom",trigger:"hover",delay:500},{trigger:t(()=>[o(s,{strong:"",quaternary:"",size:"small",disabled:!e(f)||!e(T),type:e(E)==="on"?"primary":"tertiary",focusable:!1,onClick:n[4]||(n[4]=d=>m("wordWrap"))},{default:t(()=>[o(z)]),_:1},8,["disabled","type"])]),default:t(()=>[p("span",null,w(e(a)("editor.switch.wordWrapTips")),1)]),_:1})]),_:1})):C("",!0),o(x,{style:{gap:"0"}},{default:t(()=>[o(Le,null,{default:t(()=>[e(f)&&!e(v)?(i(),g(e(y),{key:0,placement:"bottom",trigger:"hover",delay:500},{trigger:t(()=>[o(s,{strong:"",secondary:"",size:"small",focusable:!1,onClick:n[5]||(n[5]=d=>m("download"))},{icon:t(()=>[o(e(ge))]),_:1})]),default:t(()=>[p("span",null,w(e(a)("file.download.button")),1)]),_:1})):C("",!0),e(f)?(i(),g(e(y),{key:1,placement:"bottom",trigger:"hover",delay:500},{trigger:t(()=>[o(s,{strong:"",secondary:"",size:"small",focusable:!1,onClick:n[6]||(n[6]=d=>m("delete"))},{icon:t(()=>[o(e(Y))]),_:1})]),default:t(()=>[p("span",null,w(e(a)("file.delete.button")),1)]),_:1})):C("",!0),e(f)?(i(),g(e(y),{key:2,placement:"bottom",trigger:"hover",delay:500},{trigger:t(()=>[o(s,{strong:"",secondary:"",size:"small",focusable:!1,onClick:n[7]||(n[7]=d=>m("narrow"))},{icon:t(()=>[o(e(h),null,{default:t(()=>[o($e,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1})]),default:t(()=>[p("span",null,w(e(a)("page.runLog.narrowButtonTips")),1)]),_:1})):C("",!0),e(f)?(i(),g(e(y),{key:3,placement:"bottom",trigger:"hover",delay:500},{trigger:t(()=>[o(s,{strong:"",secondary:"",size:"small",focusable:!1,onClick:n[8]||(n[8]=d=>m("enlarge"))},{icon:t(()=>[o(e(h),null,{default:t(()=>[o(De,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1})]),default:t(()=>[p("span",null,w(e(a)("page.runLog.enlargeButtonTips")),1)]),_:1})):C("",!0),e(f)&&!e(T)?(i(),g(e(y),{key:4,placement:"bottom",trigger:"hover",delay:500},{trigger:t(()=>[o(s,{strong:"",secondary:"",size:"small",focusable:!1,onClick:n[9]||(n[9]=d=>m("bottom"))},{icon:t(()=>[o(e(qt))]),_:1})]),default:t(()=>[p("span",null,w(e(a)("file.bottom.button")),1)]),_:1})):C("",!0),o(e(y),{placement:"bottom",trigger:"hover",delay:500},{trigger:t(()=>[o(s,{strong:"",secondary:"",size:"small",loading:e(Q),focusable:!1,onClick:n[10]||(n[10]=d=>m("refresh"))},{icon:t(()=>[o(e(h),null,{default:t(()=>[o(qe,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1},8,["loading"])]),default:t(()=>[p("span",null,w(e(a)("page.runLog.refreshButtonTips")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["name"])]),default:t(()=>[o(Be,{bordered:!e(v),style:{height:"100%","word-break":"unset"},"content-style":"padding: 0; height: 100%"},{default:t(()=>[o(Ie,{"has-sider":"",style:{height:"100%"},"content-style":"height: 100%"},{default:t(()=>[e(v)?(i(),g(ce,{key:1,bordered:!1,width:"100%","trigger-style":"margin-right: .75em","collapsed-trigger-style":"margin-right: -0.75em","collapsed-width":0,"show-collapsed-content":!1,"show-trigger":"arrow-circle",collapsed:e(U),"on-update:collapsed":U.value=void 0,"native-scrollbar":!1,"content-style":"display: flex; flex-direction: column; height: 100%; padding: .8em 0 0 .8em",class:"logs-container"},{default:t(()=>[p("div",Qt,[o(se,{value:e($),"onUpdate:value":n[14]||(n[14]=d=>X($)?$.value=d:null),clearable:"",size:"small",style:{"margin-bottom":".5em"},placeholder:e(a)("page.runLog.searchInputPlaceholder")},{prefix:t(()=>[o(ae)]),_:1},8,["value","placeholder"])]),o(ie,{"x-scrollable":"",class:"flex-1 pr-3"},{default:t(()=>[o(re,{"expand-on-click":"","block-line":"","node-props":ne,pattern:e($),data:e(J),"show-irrelevant-nodes":!1,"on-update:expanded-keys":oe,style:{height:"100%","font-size":"16px"}},null,8,["pattern","data"])]),_:1}),o(V,{show:e(F)},null,8,["show"])]),_:1},8,["collapsed","on-update:collapsed"])):(i(),g(ce,{key:0,bordered:"",width:"280","trigger-style":"width: 34px","collapsed-width":0,"show-collapsed-content":!1,"show-trigger":"bar","native-scrollbar":!1,"content-style":"display: flex; flex-direction: column; height: 100%; padding: .8em 0 0 .8em",class:"logs-container"},{default:t(()=>[p("div",Ut,[o(se,{value:e($),"onUpdate:value":n[11]||(n[11]=d=>X($)?$.value=d:null),clearable:"",style:{"margin-bottom":".5em"},placeholder:e(a)("page.runLog.searchInputPlaceholder")},{prefix:t(()=>[o(ae)]),_:1},8,["value","placeholder"])]),o(ie,{"x-scrollable":"",class:Fe(["flex-1 pr-3 select-none",{"in-timerage-filter":e(q)}])},{default:t(()=>[o(re,{"expand-on-click":"","block-line":"","node-props":ne,pattern:e($),data:e(J),"render-label":Te,"show-irrelevant-nodes":!1,"on-update:expanded-keys":oe,style:{height:"100%"}},null,8,["pattern","data"]),o(Me,{trigger:"manual",placement:"bottom-start",show:e(O),options:e(K),x:e(ee),y:e(te),onSelect:n[12]||(n[12]=d=>m("clickRightClickMenu")),onClickoutside:n[13]||(n[13]=d=>m("exitRightClickMenu"))},null,8,["show","options","x","y"])]),_:1},8,["class"]),o(V,{show:e(F)},null,8,["show"])]),_:1})),e(f)?(i(),g(ue,{key:2,style:{overflow:"auto"}},{default:t(()=>[e(T)?(i(),g(ze,{key:1,ref_key:"editor",ref:ye,style:{height:"100%",padding:"0"},value:e(f),language:"plaintext","word-wrap":e(E),"font-size":e(D),"read-only":!0,minimap:e(B)},null,8,["value","word-wrap","font-size","minimap"])):(i(),g(Ne,{key:0,ref_key:"logInstRef",ref:Z,log:e(f),loading:e(H),"font-size":e(D),"line-height":1.5,language:"naive-log",style:{padding:"1em 0 1em 1.6em",width:"100%",height:"100%"},onRequireTop:n[15]||(n[15]=d=>m("requireJump")),onRequireBottom:n[16]||(n[16]=d=>m("requireJump"))},null,8,["log","loading","font-size","line-height"])),o(V,{show:e(A)},null,8,["show"])]),_:1})):(i(),g(ue,{key:3},{default:t(()=>[o(Pe,{class:"min-h-200px flex-jc-ac h-full",size:"huge",description:e(a)("common.selectFileEmptyDesc")},{icon:t(()=>[o(e(h),null,{default:t(()=>[o(Re)]),_:1})]),_:1},8,["description"]),o(V,{show:e(A)},null,8,["show"])]),_:1}))]),_:1})]),_:1},8,["bordered"])]),_:1},8,["title"])}}});const gn=ve(Xt,[["__scopeId","data-v-df2d42e1"]]);export{gn as default};
