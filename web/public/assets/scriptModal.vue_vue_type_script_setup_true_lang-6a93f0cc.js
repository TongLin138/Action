import{_ as T}from"./swap-outlined-c2e90102.js";import{c as j,_ as J}from"./index-35fc6cad.js";import{a6 as o,as as U,aG as m,G as Z,r as q,I as K,a7 as s,a8 as t,ac as a,u as e,aJ as p,aL as Q,aC as u,aD as r,aE as X,aw as Y,am as ee,aS as te,aN as ne,bD as oe,br as se,bp as ae,aH as ce,bu as ie}from"./vendor-605eddea.js";import{_ as le}from"./description-outline-rounded-15b42bae.js";import{c as re,b as _e,H as pe,I as ue}from"./index-bbe7d773.js";import{u as me}from"./useAppInject-315274ec.js";import{f as de}from"./index-82a40a9e.js";import{a as ge}from"./file-a0aae56a.js";import fe from"./loading-ed142cca.js";const he={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"},ye=m("path",{fill:"currentColor",d:"M8 12h8v2H8v-2m2 8H6V4h7v5h5v3.1l2-2V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4v-2m-2-2h4.1l.9-.9V16H8v2m12.2-5c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1l-2.1-2.1l1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1l2.1 2.1Z"},null,-1),we=[ye];function ke(x,k){return o(),U("svg",he,we)}const be={name:"mdi-file-document-edit-outline",render:ke},He=Z({__name:"scriptModal",setup(x,{expose:k}){const{message:d}=re(),{t:l}=_e(),{getIsMobile:b}=me(),v=pe(),n=q({title:l("cron.task.script"),path:"",show:!1,loading:!0,code:"",language:"",wordWrap:!0,showLineNumbers:!1}),{title:N,path:C,show:g,loading:i,code:E,language:I,wordWrap:B,showLineNumbers:M}=K(n),z=async c=>{n.title=c.scriptPath.split("/").pop(),n.path=c.scriptPath,n.code="",n.language="",n.loading=!0,n.show=!0;try{await H(c.scriptPath)}finally{n.code?n.loading=!1:d.warning(l("cron.task.message.no_script"))}},H=async c=>{const _=await ge({path:c}),f=c.substring(c.lastIndexOf(".")+1),h=de[f]||{};n.code=_,n.language=h.language||"plaintext"},L=()=>{j(n.code)?d.success(l("common.copyOk")):d.error(l("common.copyFail"))},V=()=>{n.wordWrap=!n.wordWrap,n.showLineNumbers=!n.showLineNumbers},S=()=>{v(`${ue.FILE_MANAGER_PAGE}?path=${C.value}`)};return k({open:z}),(c,_)=>{const f=le,h=be,y=ee,w=te,W=J,$=T,A=ne,G=oe,P=se,D=ae,F=ce,R=ie;return o(),s(R,{show:e(g),"onUpdate:show":_[0]||(_[0]=O=>X(g)?g.value=O:null),preset:"dialog","auto-focus":!1,style:Y({width:e(b)?"100vw":"800px",padding:e(b)?"16px":""})},{icon:t(()=>[a(e(p),null,{default:t(()=>[e(i)?(o(),s(fe,{key:0})):(o(),s(f,{key:1,style:{"vertical-align":"0"}}))]),_:1})]),header:t(()=>[a(A,null,{default:t(()=>[Q(u(e(N))+" ",1),e(i)?r("",!0):(o(),s(w,{key:0,trigger:"hover"},{trigger:t(()=>[e(i)?r("",!0):(o(),s(y,{key:0,text:"",size:"tiny",type:"primary",focusable:!1,onClick:S},{icon:t(()=>[a(e(p),{size:16},{default:t(()=>[a(h)]),_:1})]),_:1}))]),default:t(()=>[m("span",null,u(e(l)("cron.task.scriptModal.goEditBtn")),1)]),_:1})),e(i)?r("",!0):(o(),s(w,{key:1,trigger:"hover"},{trigger:t(()=>[e(i)?r("",!0):(o(),s(y,{key:0,text:"",size:"tiny",type:"primary",focusable:!1,onClick:L},{icon:t(()=>[a(e(p),null,{default:t(()=>[a(W)]),_:1})]),_:1}))]),default:t(()=>[m("span",null,u(e(l)("cron.task.scriptModal.copyBtn")),1)]),_:1})),e(i)?r("",!0):(o(),s(w,{key:2,trigger:"hover"},{trigger:t(()=>[e(i)?r("",!0):(o(),s(y,{key:0,text:"",size:"tiny",type:"primary",focusable:!1,onClick:V},{icon:t(()=>[a(e(p),{size:16},{default:t(()=>[a($)]),_:1})]),_:1}))]),default:t(()=>[m("span",null,u(e(l)("cron.task.scriptModal.wordWrapBtn")),1)]),_:1}))]),_:1})]),default:t(()=>[e(i)?(o(),s(G,{key:0,text:"",repeat:27,height:"16px"})):(o(),s(F,{key:1,bordered:!1,style:{height:"100%","word-break":"unset"},"content-style":"height: 100%; padding: 0"},{default:t(()=>[a(D,{"x-scrollable":"",style:{"max-height":"600px",height:"100%"}},{default:t(()=>[a(P,{code:e(E),language:e(I),"show-line-numbers":e(M),"word-wrap":e(B),style:{"font-size":"15px",height:"100%",padding:"1em 0 1em 0"}},null,8,["code","language","show-line-numbers","word-wrap"])]),_:1})]),_:1}))]),_:1},8,["show","style"])}}});export{He as _};
