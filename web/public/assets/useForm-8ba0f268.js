import{a6 as l,aH as A,as as _e,u as r,cl as Me,cm as Se,cn as De,co as je,cp as be,s as W,a$ as Te,ck as Oe,bp as ye,cq as $e,aP as Ae,cr as Ge,b0 as Le,b1 as Ue,cs as ze,ct as Ee,cu as qe,cv as Je,aO as We,b2 as He,b3 as Xe,cw as Ye,bF as Ke,bq as Qe,G as Ze,x as G,r as xe,bY as et,h as T,ah as tt,C as oe,aL as nt,a7 as g,a8 as i,a9 as O,aa as ne,ab as de,aV as z,au as J,aG as L,at as ot,M as pe,aN as S,aI as D,bv as fe,cx as st,aJ as $,aw as me,bj as at,aR as rt,aW as lt,aC as it,aX as ut,c6 as ct,c7 as dt,cy as pt,bG as ft,bs as mt,am as gt,aB as _t,bt,bH as yt,aT as Nt,y as kt}from"./vendor-339b2486.js";import{_ as Pt}from"./question-circle-outlined-1934c0e0.js";import{h as H,S as vt,f as Ne,U as ge,e as ke,a as ht,d as wt,V as Ft,W as It,_ as Ct,X as Bt,Y as Rt}from"./index-b98e63e9.js";import{p as b}from"./propTypes-8a448afd.js";import{u as Vt}from"./useBreakpoint-7b3544fc.js";const Mt={style:{display:"inline-block"},viewBox:"0 0 1024 1024",width:"1em",height:"1em"},St=_e("path",{fill:"currentColor",d:"M890.5 755.3L537.9 269.2c-12.8-17.6-39-17.6-51.7 0L133.5 755.3A8 8 0 0 0 140 768h75c5.1 0 9.9-2.5 12.9-6.6L512 369.8l284.1 391.6c3 4.1 7.8 6.6 12.9 6.6h75c6.5 0 10.3-7.4 6.5-12.7z"},null,-1),Dt=[St];function jt(e,_){return l(),A("svg",Mt,[...Dt])}const Tt={name:"ant-design-up-outlined",render:jt},Ot={style:{display:"inline-block"},viewBox:"0 0 1024 1024",width:"1em",height:"1em"},$t=_e("path",{fill:"currentColor",d:"M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2L227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"},null,-1),At=[$t];function Gt(e,_){return l(),A("svg",Ot,[...At])}const Lt={name:"ant-design-down-outlined",render:Gt};function Ut(e){return e?["NPicker","NSelect","NCheckbox","NRadio","NSwitch","NDatePicker","NTimePicker"].includes(e)?"请选择":"请输入":""}function zt(e,_,f=!0){switch(_){case"NDatePicker":case"NTimePicker":e.type=f?"string":"object";break;case"NUpload":case"NCheckboxGroup":case"NDateRangePicker":e.type="array";break;case"NInputNumber":e.type="number";break}}function Et({emit:e,getProps:_,formModel:f,getSchema:y,formElRef:I,defaultFormModel:V,handleFormValues:o}){async function m(){return r(I)?.validate()}async function u(N){N&&N.preventDefault();const{submitFunc:d}=r(_);if(d&&H(d)){await d(f);return}if(r(I))try{return await m(),e("submit",f),f}catch{return!1}}async function h(){await r(I)?.restoreValidation()}async function C(){const{resetFunc:N,submitOnReset:d}=r(_);if(N&&H(N)&&await N(),!r(I))return;r(y).forEach(j=>{Me(f,j.field,()=>be(V.value,j.field)||null)}),await h();const M=o(f);e("reset",M),d&&await u()}function B(){return r(I)?o(f):{}}async function U(N){const d=r(y).map(k=>Se(k.field)?k.field[0]:k.field).filter(Boolean);Object.keys(N).forEach(k=>{const M=N[k];d.includes(k)&&(f[k]=De(M)?je(f[k],M):M)})}return{handleSubmit:u,validate:m,resetFields:C,getFieldsValue:B,clearValidate:h,setFieldsValue:U}}function qt({defaultFormModel:e,getSchema:_,formModel:f}){function y(V){if(!vt(V))return{};const o={};for(const m of Object.entries(V)){let[,u]=m;const[h]=m;!h||Ne(u)&&u.length===0||H(u)||ge(u)||(ke(u)&&(u=u.trim()),W(o,h,u))}return o}function I(){const V=r(_),o={},m=u=>{u.forEach(h=>{const{defaultValue:C,childrens:B}=h;ge(C)||(W(o,h.field,C),W(f,h.field,C)),B&&B?.length>0&&m(B)})};m(V),e.value=o}return{handleFormValues:y,initDefault:I}}const Jt={model:{type:Object,default:{}},disabled:b.bool.def(!1),require:b.bool.def(!1),rulesMessageJoinLabel:b.bool.def(!0),labelWidth:b.stringNumber.def(80),schemas:{type:[Array],default:()=>[]},inline:b.bool.def(!1),size:b.string.def("medium"),labelPlacement:b.string,isFull:b.bool.def(!0),showActionButtonGroup:b.bool.def(!0),showResetButton:b.bool.def(!0),resetButtonOptions:Object,showSubmitButton:b.bool.def(!0),submitButtonOptions:Object,showAdvancedButton:b.bool.def(!0),submitButtonText:b.string,resetButtonText:b.string,gridProps:Object,giProps:Object,formItemProps:Object,baseGridStyle:Object,collapsed:b.bool.def(!1),collapsedRows:b.number.def(1)},p=new Map;p.set("NInput",Te);p.set("NDynamicInput",Oe);p.set("NInputGroup",ye);p.set("NInputGroupLabel",$e);p.set("NInputNumber",Ae);p.set("NAutoComplete",Ge);p.set("NSelect",Le);p.set("NSwitch",Ue);p.set("NCascader",ze);p.set("NSlider",Ee);p.set("NRate",qe);p.set("NTransfer",Je);p.set("NTreeSelect",We);p.set("NDatePicker",He);p.set("NTimePicker",Xe);p.set("NColorPicker",Ye);p.set("NUpload",Ke);p.set("NDivider",Qe);const Wt=Ze({name:"BasicForm",props:{...Jt},emits:["reset","submit","register"],setup(e,{emit:_,attrs:f}){const{t:y}=ht(),{smaller:I,sizeEnum:V}=Vt(),o=G({}),m=xe({}),u=G({}),h=G(null),C=G(null),B=G(!1),U=G(!1),N=et(()=>I(V.MD).value?"top":"left"),d=T(()=>{const n=Object.assign({},e,r(u)),a={rules:{}};return(n.schemas||[]).forEach(P=>{const R=Be(P);W(a.rules,P.field,R)}),{...n,...r(a)}}),k=T(()=>{const{schemas:n}=r(d);return{schemas:n,model:r(m)}});function M(n){if(Ne(n))return n.join(".");if(ke(n))return n}function j(n){const{rulesMessageJoinLabel:a,label:c,component:P}=n,{rulesMessageJoinLabel:R}=e,w=Reflect.has(n,"rulesMessageJoinLabel")?a:R;return`${Ut(P)}${w?c??"":""}`}function E(n){const{component:a}=n;let c;switch(a){case"NInputTextarea":c="NInput";break;case"NInputPassword":c="NInput";break;case"NDateRangePicker":c="NDatePicker";break;case"NDatetimeRangePicker":c="NDatePicker";break;default:c=a}return p.get(c)}function Q(n){const{component:a,componentProps:c}=n;let P={};switch(a){case null:case void 0:break;case"NInputTextarea":P={type:"textarea"};break;case"NInputPassword":P={type:"password"};break;case"NDateRangePicker":P={type:"daterange"};break;case"NDatetimeRangePicker":P={type:"datetimerange"};break}const R=c??{};return{clearable:!0,placeholder:j(n),disabled:X(n),...P,...R}}function X(n){const{disabled:a}=n,{disabled:c}=r(d);return H(a)?a(k.value):a??c??!1}function Z(n){const{show:a=!0}=n;return H(a)?a(k.value):a}const x=T(()=>Object.assign({size:e.size,type:"default"},u.value.resetButtonOptions)),ee=T(()=>Object.assign({size:e.size,type:"primary"},u.value.submitButtonOptions)),t=T(()=>r(d).inline),s=T(()=>{const{gridProps:n}=r(d);return{responsive:"screen",collapsed:t.value?B.value:!1,cols:1,...n}});function te(n){const{giProps:a}=n,{giProps:c}=r(d);return{span:1,...c,...a}}const Pe=T(()=>{const{labelPlacement:n,...a}=r(d);return{...f,...e,...a,labelPlacement:n??N.value}}),Y=T(()=>{const n=r(h)||r(d).schemas;for(const a of n){const{defaultValue:c,bindVal:P="value",bindUpdateVal:R="update:value"}=a;a.bindVal=P,a.bindUpdateVal=R,c&&(a.defaultValue=c)}return n}),{handleFormValues:ve,initDefault:se}=qt({defaultFormModel:o,getSchema:Y,formModel:m}),{handleSubmit:ae,validate:he,resetFields:re,getFieldsValue:we,clearValidate:Fe,setFieldsValue:le}=Et({emit:_,getProps:d,formModel:m,getSchema:Y,formElRef:C,defaultFormModel:o,handleFormValues:ve});function Ie(){B.value=!B.value}async function Ce(n){u.value=It(r(u)||{},n)}function Be(n){const{rules:a=[],show:c,required:P,component:R}=n;let w=tt(a);const ie=["blur","input"],ue=j(n);function Ve(v,F){const K=v.message||ue;return F===void 0||Ft(F)||Array.isArray(F)&&F.length===0||typeof F=="string"&&F.trim()===""||typeof F=="object"&&Reflect.has(F,"checked")&&Reflect.has(F,"halfChecked")&&Array.isArray(F.checked)&&Array.isArray(F.halfChecked)&&F.checked.length===0&&F.halfChecked.length===0?Promise.reject(K):Promise.resolve()}(!w||w.length===0)&&P&&(w=[{required:P,validator:Ve,trigger:ie}]);const ce=w.findIndex(v=>Reflect.has(v,"required")&&!Reflect.has(v,"validator"));if(ce!==-1){const v=w[ce];wt(c)&&!c&&(v.required=!1),R&&(Reflect.has(v,"type")||zt(v,R),v.message=v.message||ue,v.trigger=ie,R.includes("NInput")&&(v.whitespace=!0))}const q=w.findIndex(v=>v.max);return q!==-1&&!w[q].validator&&(w[q].message=w[q].message||y("component.form.maxTip",[w[q].max])),w}const Re={getFieldsValue:we,setFieldsValue:le,resetFields:re,validate:he,clearValidate:Fe,setProps:Ce,submit:ae};return oe(()=>Y.value,n=>{r(U)||n?.length&&(se(),U.value=!0)}),oe(()=>r(d).model,n=>{n&&le(n)},{immediate:!0}),nt(()=>{se(),_("register",Re)}),{t:y,get:be,set:W,formElRef:C,formModel:m,getGrid:s,getGridItem:te,getProps:d,getShow:Z,getFormItemPath:M,getBindValue:Pe,getSchema:Y,getSubmitBtnOptions:ee,getResetBtnOptions:x,handleSubmit:ae,resetFields:re,isInline:t,getComponentProps:Q,getComp:E,unfoldToggle:Ie,componentMap:p}}});function Ht(e,_,f,y,I,V){const o=at,m=Pt,u=rt,h=lt,C=it,B=ut,U=ct,N=dt,d=pt,k=ye,M=ft,j=mt,E=gt,Q=Lt,X=_t,Z=Tt,x=bt,ee=yt;return l(),g(ee,L(e.getBindValue,{ref:"formElRef",model:e.formModel,class:"mt-2"}),{default:i(()=>[O(x,ne(de(e.getGrid)),{default:i(()=>[(l(!0),A(z,null,J(e.getSchema,t=>(l(),A(z,{key:t.field},[e.getShow(t)?(l(),g(j,ne(L({key:0},e.getGridItem(t))),{default:i(()=>[O(M,L({label:t.label,path:e.getFormItemPath(t.field)},t.formItemProps),ot({default:i(()=>[t.slot?pe(e.$slots,t.slot,{key:0,model:e.formModel,field:t.field,value:e.get(e.formModel,t.field)},void 0,!0):t.component==="NCheckbox"?(l(),g(B,{key:1,value:e.formModel[t.field],"onUpdate:value":s=>e.formModel[t.field]=s},{default:i(()=>[O(C,null,{default:i(()=>[(l(!0),A(z,null,J(t?.componentProps?.options,s=>(l(),g(h,{key:s.value,value:s.value,label:s.label},null,8,["value","label"]))),128))]),_:2},1024)]),_:2},1032,["value","onUpdate:value"])):t.component==="NRadioGroup"?(l(),g(N,{key:2,value:e.formModel[t.field],"onUpdate:value":s=>e.formModel[t.field]=s},{default:i(()=>[O(C,ne(de(t?.componentProps?.spaceProps)),{default:i(()=>[(l(!0),A(z,null,J(t?.componentProps?.options,s=>(l(),g(U,{key:s.value,value:s.value},{default:i(()=>[S(D(s.label),1)]),_:2},1032,["value"]))),128))]),_:2},1040)]),_:2},1032,["value","onUpdate:value"])):t.component==="NRadioButtonGroup"?(l(),g(N,{key:3,value:e.formModel[t.field],"onUpdate:value":s=>e.formModel[t.field]=s},{default:i(()=>[(l(!0),A(z,null,J(t?.componentProps?.options,s=>(l(),g(d,{key:s.value,value:s.value},{default:i(()=>[S(D(s.label),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value"])):t.component==="NInputGroup"?(l(),g(k,{key:4},{default:i(()=>[(l(!0),A(z,null,J(t.childrens,s=>(l(),g(fe(e.getComp(s)),L({key:s.filed},e.getComponentProps(s),{value:e.get(e.formModel,s.field??t.field),class:{isFull:(s.isFull??t.isFull)!=!1&&e.getProps.isFull},"onUpdate:value":te=>e.set(e.formModel,s.field??t.field,te)}),{default:i(()=>[S(D(s?.defaultSlot),1)]),_:2},1040,["value","class","onUpdate:value"]))),128))]),_:2},1024)):(l(),g(fe(e.getComp(t)),L({key:5},e.getComponentProps(t),{[t.bindVal||""]:e.get(e.formModel,t.field),class:{isFull:t.isFull!=!1&&e.getProps.isFull}},{[st(t.bindUpdateVal)]:s=>e.set(e.formModel,t.field,s)}),null,16,["class"])),t.suffix?pe(e.$slots,t.suffix,{key:6,model:e.formModel,field:t.field,value:e.get(e.formModel,t.field)},void 0,!0):$("",!0)]),_:2},[t.subLabel||t.labelMessage?{name:"label",fn:i(()=>[S(D(t.label)+" ",1),t.subLabel?(l(),g(o,{key:0,depth:3,class:"mr-2"},{default:i(()=>[S(D(t.subLabel),1)]),_:2},1024)):$("",!0),t.labelMessage?(l(),g(u,{key:1,trigger:"hover",style:me(t.labelMessageStyle)},{trigger:i(()=>[O(m,{class:"text-18px cursor-pointer text-$app-text-color-3"})]),default:i(()=>[S(" "+D(t.labelMessage),1)]),_:2},1032,["style"])):$("",!0)]),key:"0"}:void 0]),1040,["label","path"])]),_:2},1040)):$("",!0)],64))),128)),e.getProps.showActionButtonGroup?(l(),g(j,{key:0,span:e.isInline?"":24,suffix:!!e.isInline},{default:i(({overflow:t})=>[O(C,{align:"center",justify:e.isInline?"end":"start",style:me({"margin-left":`${e.isInline?12:e.getProps.labelWidth}px`,"margin-bottom":"24px"})},{default:i(()=>[e.getProps.showSubmitButton?(l(),g(E,L({key:0},e.getSubmitBtnOptions,{onClick:e.handleSubmit}),{default:i(()=>[S(D(e.getProps.submitButtonText??e.t("common.queryText")),1)]),_:1},16,["onClick"])):$("",!0),e.getProps.showResetButton?(l(),g(E,L({key:1},e.getResetBtnOptions,{onClick:e.resetFields}),{default:i(()=>[S(D(e.getProps.resetButtonText??e.t("common.resetText")),1)]),_:1},16,["onClick"])):$("",!0),e.isInline&&e.getProps.showAdvancedButton?(l(),g(E,{key:2,type:"primary",text:"","icon-placement":"right",onClick:e.unfoldToggle},{icon:i(()=>[t?(l(),g(X,{key:0,size:"14",class:"unfold-icon"},{default:i(()=>[O(Q)]),_:1})):(l(),g(X,{key:1,size:"14",class:"unfold-icon"},{default:i(()=>[O(Z)]),_:1}))]),default:i(()=>[S(" "+D(t?"展开":"收起"),1)]),_:2},1032,["onClick"])):$("",!0)]),_:2},1032,["justify","style"])]),_:1},8,["span","suffix"])):$("",!0)]),_:3},16)]),_:3},16,["model"])}const xt=Ct(Wt,[["render",Ht],["__scopeId","data-v-99776a72"]]);function en(e){const _=G(null),f=G(!1);async function y(){const o=r(_);return o||console.error("The form instance has not been obtained, please make sure that the form has been rendered when performing the form operation!"),await kt(),o}function I(o){Nt(()=>{_.value=null,f.value=null}),!(r(f)&&Bt()&&o===r(_))&&(_.value=o,f.value=!0,oe(()=>e,()=>{e&&o.setProps(Rt(e))},{immediate:!0,deep:!0}))}return[I,{setProps:async o=>{await(await y()).setProps(o)},resetFields:async()=>{y().then(async o=>{await o.resetFields()})},clearValidate:async o=>{await(await y()).clearValidate(o)},getFieldsValue:()=>r(_)?.getFieldsValue(),setFieldsValue:async o=>{await(await y()).setFieldsValue(o)},submit:async()=>(await y()).submit(),validate:async o=>(await y()).validate(o)}]}export{xt as _,en as u};
