var w=(V,d,i)=>new Promise((E,S)=>{var h=p=>{try{y(i.next(p))}catch(m){S(m)}},C=p=>{try{y(i.throw(p))}catch(m){S(m)}},y=p=>p.done?E(p.value):Promise.resolve(p.value).then(h,C);y((i=i.apply(V,d)).next())});import{_ as fe}from"./PageWrapper.vue_vue_type_style_index_0_lang-2smqrgtP.js";import{a as me,c as ge,_ as ve}from"./index-mGrCK8oI.js";import{_ as he,a as ye,b as be}from"./sliders-horizontal-bold-fMHmj_Km.js";import{_ as we,f as xe}from"./folderDisable-L9J8RflW.js";import{_ as ke}from"./shortcut-ISyG0e2L.js";import{a7 as x,aJ as Z,at as R,H as ze,y as r,D as Q,aL as Se,aM as Ce,a8 as N,au as De,u as e,a9 as t,aa as n,aE as P,aN as u,ay as $e,aO as j,aI as H,aD as G,am as f,aP as Be,aC as Ne,bs as Pe,bt as Ve,an as Ee,aQ as Ie,aR as Te,aS as Oe,aT as Fe,aK as Me}from"./vendor-kg4oYVSQ.js";import{_ as He}from"./swap-outlined-tkJZnzNY.js";import{_ as Ue}from"./index.vue_vue_type_style_index_0_lang-c-2lX1Tq.js";import{u as Le}from"./useAppInject-l82YhPHr.js";import{u as We}from"./useTransition-GfIN44Ja.js";import{s as je,g as X,a as Re}from"./file-T6C44nTG.js";import{f as Y,a as Ae,b as qe}from"./index-QxLtsnzB.js";import{f as Je}from"./filePrefix-aegAgnbp.js";import"./sharp-arrow-back-ios-r99876JW.js";import"./useDesign-Tg9gUwPG.js";import"./propTypes-e0b5J7qR.js";const Ke={style:{display:"inline-block"},viewBox:"0 0 2048 2048",width:"1em",height:"1em"},Qe=R("path",{fill:"currentColor",d:"M1792 0v2048H256V0zM384 128v384h1280V128zm1280 1408H384v384h1280zm0-256V640H384v640z"},null,-1),Ge=[Qe];function Xe(V,d){return x(),Z("svg",Ke,[...Ge])}const Ye={name:"fluent-mdl2-diff-inline",render:Xe},Ze={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"},en=R("path",{fill:"currentColor",d:"M10 18H6v-2h4zm0-4H6v-2h4zm0-13v1H6c-1.11 0-2 .89-2 2v16a2 2 0 0 0 2 2h4v1h2V1zm10 7v12c0 1.11-.89 2-2 2h-4v-2h4v-9h-4V9h4.5L14 4.5V2zm-4 6h-2v-2h2zm0 4h-2v-2h2z"},null,-1),nn=[en];function tn(V,d){return x(),Z("svg",Ze,[...nn])}const an={name:"mdi-file-compare",render:tn},xn=ze({__name:"index",setup(V){const{getIsMobile:d}=Le(),{t:i}=me(),{message:E}=ge(),S=r("fade-slide");We(S);const h=r(),C=r([]),y=r([]),p=r({}),m=r({content:"",language:""}),D=r(""),I=r(!d.value),T=r(d.value?13:15),O=r(d.value?"on":"off"),_=r(""),g=r(""),U=r(!1),L=r(!1),k=r(!1),z=r(!1),F=o=>w(this,null,function*(){switch(o){case"showEditorShortcutsInfo":h.value.showShortCuts();break;case"wordWrap":O.value=O.value==="on"?"off":"on",z.value=!1;break;case"renderSideBySide":I.value=!I.value,z.value=!1;break;case"save":U.value=!0;const a=e(h).getValue();try{yield je({content:a,path:_.value}),E.success(i("editor.main.savedSuccess"))}finally{U.value=!1}break}}),ee=()=>w(this,null,function*(){k.value=!0;const o=yield X({}),a=A(o);C.value=a;const s=yield X({}),v=A(s);y.value=v,k.value=!1}),A=o=>{const a=v=>{v.length&&v.forEach(l=>{if(l.type===0)Object.assign(l,{key:l.path,label:l.title,disabled:!0,prefix:()=>f(u,null,{default:()=>f(Y)})}),a(l.children),l.children.length||(Object.assign(l,{children:null,disabled:!0}),l.prefix=()=>f(u,null,{default:()=>f(xe)}));else{const b=l.name;if(b){const W=b.substring(b.lastIndexOf(".")+1),$=qe[W]||{};Object.assign(l,{key:l.path,label:b,language:$.language||"plaintext",disabled:$.disabled||!1,prefix:()=>f(u,null,{default:()=>f($.icon||Je)})})}}})};a(o);const s=v=>v.filter(l=>l.children?(l.children=s(l.children),!0):!l.disabled);return o=s(o),o},M=(o,a,s)=>{if(s.node)switch(s.action){case"expand":s.node.prefix=()=>f(u,null,{default:()=>f(Ae)});break;case"collapse":s.node.prefix=()=>f(u,null,{default:()=>f(Y)});break}},q=(o,a)=>w(this,null,function*(){L.value=!0;const s=yield Re({path:encodeURI(o.key)});if(s)switch(a){case"config":m.value={content:s,language:o.language};break;case"sample":D.value=s;break}else{switch(a){case"config":break;case"sample":D.value="";break}E.info(i("page.diff.fileContentIsEmptyMsg"))}L.value=!1}),J=({option:o})=>({onClick(){return w(this,null,function*(){!o.children&&!o.disabled&&(p.value=o,yield q(o,"config"))})}}),K=({option:o})=>({onClick(){return w(this,null,function*(){!o.children&&!o.disabled&&(p.value=o,yield q(o,"sample"))})}});return Q(_,o=>{o||(m.value={content:"",language:""})}),Q(g,o=>{o||(D.value="")}),Se(()=>w(this,null,function*(){yield ee()})),Ce(()=>{h.value&&h.value.dispose()}),(o,a)=>{const s=Be,v=an,l=Ne,b=Pe,W=Ve,$=he,B=Ee,ne=ye,te=Ie,ae=He,oe=Ye,le=Te,se=ke,ie=Oe,re=we,ce=be,ue=Fe,de=ve,pe=Me,_e=fe;return x(),N(_e,{ref:"pageWrapper","content-full":"",title:e(i)("routes.main.page.diff")},De({extra:t(()=>[e(_)&&e(g)?(x(),N($e,{key:0,name:e(S),mode:"out-in",appear:""},{default:t(()=>[n(l,null,{default:t(()=>[n(l,{style:{gap:"0"}},{default:t(()=>[n(le,{trigger:"manual",style:{padding:"8px"},show:e(z),"show-arrow":!1,placement:"bottom"},{trigger:t(()=>[n(B,{strong:"",quaternary:"",size:"small",type:e(z)?"primary":"tertiary",style:{padding:"6px"},focusable:!1,onClick:a[4]||(a[4]=c=>z.value=!e(z))},{default:t(()=>[n(e(u),{size:"18"},{default:t(()=>[n($,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1},8,["type"])]),default:t(()=>[n(l,{vertical:""},{default:t(()=>[n(l,{size:"small"},{default:t(()=>[n(e(u),{size:20},{default:t(()=>[n(ne,{style:{"vertical-align":"-0.4em"}})]),_:1}),n(te,{value:e(T),"onUpdate:value":a[5]||(a[5]=c=>P(T)?T.value=c:null),min:12,max:40,"button-placement":"both",size:"small",class:"max-w-94px",style:{"text-align":"center"}},null,8,["value"])]),_:1}),n(l,{size:"small"},{default:t(()=>[n(e(u),{size:20,color:e(O)==="on"?"var(--app-primary-color)":void 0},{default:t(()=>[n(ae,{style:{"vertical-align":"-0.4em"}})]),_:1},8,["color"]),n(B,{strong:"",secondary:"",size:"small",style:{width:"94px"},onClick:a[6]||(a[6]=c=>F("wordWrap"))},{default:t(()=>[j(H(e(i)("editor.switch.wordWrapBtn")),1)]),_:1})]),_:1}),n(l,{size:"small"},{default:t(()=>[n(e(u),{size:20,color:e(I)?void 0:"var(--app-primary-color)"},{default:t(()=>[n(oe,{style:{"vertical-align":"-0.4em"}})]),_:1},8,["color"]),n(B,{strong:"",secondary:"",size:"small",style:{width:"94px"},onClick:a[7]||(a[7]=c=>F("renderSideBySide"))},{default:t(()=>[j(H(e(i)("editor.switch.inlineModeTips")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["show"]),e(d)?G("",!0):(x(),N(ie,{key:0,placement:"bottom",trigger:"hover",delay:500},{trigger:t(()=>[n(B,{strong:"",quaternary:"",size:"small",type:"tertiary",style:{padding:"6px"},focusable:!1,onClick:a[8]||(a[8]=c=>F("showEditorShortcutsInfo"))},{default:t(()=>[n(e(u),{size:"18"},{default:t(()=>[n(se,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1})]),default:t(()=>[R("span",null,H(e(i)("editor.switch.shortcutsTips")),1)]),_:1}))]),_:1}),n(B,{strong:"",type:"primary",size:"small",disabled:!e(_),loading:e(U),focusable:!1,onClick:a[9]||(a[9]=c=>F("save"))},{icon:t(()=>[n(re)]),default:t(()=>[j(" "+H(e(i)("editor.main.saveButton")),1)]),_:1},8,["disabled","loading"])]),_:1})]),_:1},8,["name"])):G("",!0)]),default:t(()=>[n(pe,{bordered:!e(d),style:{height:"100%","word-break":"unset"},"content-style":"padding: 0"},{default:t(()=>[e(m).content||e(D)?(x(),N(Ue,{key:0,ref_key:"editor",ref:h,value:e(m),"origin-value":e(D),"diff-mode":!0,"word-wrap":e(O),"render-side-by-side":e(I),"font-size":e(T)},null,8,["value","origin-value","word-wrap","render-side-by-side","font-size"])):(x(),N(ue,{key:1,class:"min-h-200px flex-jc-ac h-full",size:"huge",description:e(i)("common.selectFileEmptyDesc")},{icon:t(()=>[n(e(u),null,{default:t(()=>[n(ce)]),_:1})]),_:1},8,["description"])),n(de,{show:e(L)},null,8,["show"])]),_:1},8,["bordered"])]),_:2},[e(d)?{name:"headerContent",fn:t(()=>[n(W,{"x-gap":12,cols:2},{default:t(()=>[n(b,null,{default:t(()=>[n(s,{value:e(g),"onUpdate:value":a[2]||(a[2]=c=>P(g)?g.value=c:null),size:"small",loading:e(k),"consistent-menu-width":!1,clearable:"",placement:"bottom-start",placeholder:e(i)("page.diff.selectSourceFilePlaceholder"),options:e(y),"node-props":K,"on-update:expanded-keys":M},null,8,["value","loading","placeholder","options"])]),_:1}),n(b,null,{default:t(()=>[n(s,{value:e(_),"onUpdate:value":a[3]||(a[3]=c=>P(_)?_.value=c:null),size:"small",loading:e(k),"consistent-menu-width":!1,clearable:"",placement:"bottom-end",placeholder:e(i)("page.diff.selectDestinationFilePlaceholder"),options:e(C),"node-props":J,"on-update:expanded-keys":M},null,8,["value","loading","placeholder","options"])]),_:1})]),_:1})]),key:"1"}:{name:"subtitle",fn:t(()=>[n(l,null,{default:t(()=>[n(s,{value:e(g),"onUpdate:value":a[0]||(a[0]=c=>P(g)?g.value=c:null),size:"small",style:{"min-width":"200px",width:"fit-content"},"show-path":"",loading:e(k),"consistent-menu-width":!1,clearable:"",placeholder:e(i)("page.diff.selectSourceFilePlaceholder"),options:e(y),"node-props":K,"on-update:expanded-keys":M},null,8,["value","loading","placeholder","options"]),n(e(u),{size:"24",depth:3},{default:t(()=>[n(v)]),_:1}),n(s,{value:e(_),"onUpdate:value":a[1]||(a[1]=c=>P(_)?_.value=c:null),size:"small",style:{"min-width":"200px",width:"fit-content"},"show-path":"",loading:e(k),"consistent-menu-width":!1,clearable:"",placeholder:e(i)("page.diff.selectDestinationFilePlaceholder"),options:e(C),"node-props":J,"on-update:expanded-keys":M},null,8,["value","loading","placeholder","options"])]),_:1})]),key:"0"}]),1032,["title"])}}});export{xn as default};
