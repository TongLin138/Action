import{_ as ee}from"./swap-outlined-2da29970.js";import{c as ne,_ as te}from"./index-8f9a70dd.js";import{a6 as o,aH as oe,as as u,G as se,r as ae,I as le,u as e,a7 as s,a8 as n,a9 as t,aM as j,aI as p,aJ as G,aD as L,aB as ie,am as re,aQ as ce,bp as _e,aC as pe,bG as ue,bx as de,br as ge,aK as me,by as fe,bo as ye,c5 as he,c6 as we}from"./vendor-3ca7b8d8.js";import{_ as ve}from"./description-outline-rounded-3eed1a0c.js";import{_ as be,a as ke,b as xe,c as We,f as $e}from"./index-3b46d9cc.js";import{c as ze,a as Ce,K as Be,M as Me}from"./index-a6057b40.js";import{u as Ee}from"./useAppInject-5648be0a.js";import{a as Ne}from"./file-cb236294.js";import S from"./loading-e45cd3fe.js";const Ie={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"},Ve=u("path",{fill:"currentColor",d:"M8 12h8v2H8v-2m2 8H6V4h7v5h5v3.1l2-2V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4v-2m-2-2h4.1l.9-.9V16H8v2m12.2-5c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1l-2.1-2.1l1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1l2.1 2.1Z"},null,-1),He=[Ve];function Pe(D,$){return o(),oe("svg",Ie,He)}const Te={name:"mdi-file-document-edit-outline",render:Pe},je={style:{"vertical-align":"-4px",padding:"0 2px"}},Oe=se({__name:"scriptModal",setup(D,{expose:$}){const{message:k}=ze(),{t:r}=Ce(),{getIsMobile:A}=Ee(),R=Be(),a=ae({title:r("page.cron.table.script"),formatTitle:"",path:"",show:!1,loading:!0,code:"",language:"",wordWrap:!0,showLineNumbers:!1}),{title:i,formatTitle:z,path:U,show:d,loading:m,code:w,language:C,wordWrap:B,showLineNumbers:x}=le(a),F=async c=>{a.title=c.scriptPath.split("/").pop(),a.formatTitle=a.title.replace(/\.(js|py|ts|sh)$/,""),a.path=c.scriptPath,a.code="",a.language="",a.loading=!0,a.show=!0;try{await K(c.scriptPath)}finally{a.code?a.loading=!1:k.warning(r("page.cron.scriptModal.noScriptMsg"))}},K=async c=>{const l=await Ne({path:c}),v=c.substring(c.lastIndexOf(".")+1),b=$e[v]||{};a.code=l,a.language=b.language||"plaintext"},y=async c=>{switch(c){case"goEdit":a.show=!1,R(`${Me.SCRIPT_DEBUG_PAGE}?path=${U.value}`);break;case"copyContent":ne(a.code)?k.success(r("common.copyOk")):k.error(r("common.copyFail"));break;case"changeWrap":a.showLineNumbers=!a.showLineNumbers,a.wordWrap=!a.wordWrap;break}};return $({open:F}),(c,l)=>{const v=be,b=ke,M=xe,E=We,N=ve,g=ie,I=Te,f=re,h=ce,O=te,V=ee,H=_e,W=pe,P=ue,T=de,J=ge,Q=me,Z=fe,q=ye,X=he,Y=we;return e(A)?(o(),s(Y,{key:1,show:e(d),"onUpdate:show":l[7]||(l[7]=_=>L(d)?d.value=_:null),height:"100vh",width:"100vw",placement:"right","auto-focus":!1,"mask-closable":!1},{default:n(()=>[t(X,{closable:"","header-style":"height: 60px; padding: 16px 12px","body-content-style":`padding: ${e(x)?"4px 4px":"4px 8px"}; overscroll-behavior: none`,"footer-style":"padding: 16px 24px"},{header:n(()=>[t(W,null,{default:n(()=>[t(g,{size:24,color:"var(--app-primary-color)"},{default:n(()=>[e(m)?(o(),s(S,{key:0,style:{"font-size":"24"}})):e(i).endsWith(".js")?(o(),s(v,{key:1,style:{"vertical-align":"0"}})):e(i).endsWith(".py")?(o(),s(b,{key:2,style:{"vertical-align":"0"}})):e(i).endsWith(".ts")?(o(),s(M,{key:3,style:{"vertical-align":"0"}})):e(i).endsWith(".sh")?(o(),s(E,{key:4,style:{"vertical-align":"0"}})):(o(),s(N,{key:5,style:{"font-size":"26","vertical-align":"0"}}))]),_:1}),t(q,{style:{height:"100%","max-width":"200px"}},{tooltip:n(()=>[u("span",null,p(e(i)),1)]),default:n(()=>[u("span",je,p(e(z)||e(i)),1)]),_:1}),!e(m)&&e(w)?(o(),s(H,{key:0},{default:n(()=>[t(h,{"show-arrow":!1,trigger:"hover"},{trigger:n(()=>[t(f,{strong:"",secondary:"",size:"small",focusable:!1,onClick:l[4]||(l[4]=_=>y("goEdit"))},{icon:n(()=>[t(g,{size:16},{default:n(()=>[t(I,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1})]),default:n(()=>[u("span",null,p(e(r)("page.cron.scriptModal.goEditBtn")),1)]),_:1}),t(h,{"show-arrow":!1,trigger:"hover"},{trigger:n(()=>[t(f,{strong:"",secondary:"",size:"small",focusable:!1,onClick:l[5]||(l[5]=_=>y("changeWrap"))},{icon:n(()=>[t(g,{size:16},{default:n(()=>[t(V,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1})]),default:n(()=>[u("span",null,p(e(r)("page.cron.scriptModal.wordWrapBtn")),1)]),_:1})]),_:1})):G("",!0)]),_:1})]),footer:n(()=>[t(W,null,{default:n(()=>[t(f,{type:"primary",focusable:!1,onClick:l[6]||(l[6]=_=>d.value=!1)},{default:n(()=>[j(p(e(r)("component.modal.close")),1)]),_:1})]),_:1})]),default:n(()=>[e(m)?(o(),s(P,{key:0,text:"",repeat:30,height:"16px"})):(o(),s(T,{key:1,code:e(w),language:e(C),"show-line-numbers":e(x),"word-wrap":e(B),style:{"font-size":"13px",height:"100%"}},null,8,["code","language","show-line-numbers","word-wrap"]))]),_:1},8,["body-content-style"])]),_:1},8,["show"])):(o(),s(Z,{key:0,show:e(d),"onUpdate:show":l[3]||(l[3]=_=>L(d)?d.value=_:null),preset:"dialog","auto-focus":!1,style:{width:"600px"}},{icon:n(()=>[t(g,{size:26},{default:n(()=>[e(m)?(o(),s(S,{key:0})):e(i).endsWith(".js")?(o(),s(v,{key:1,style:{"vertical-align":"0"}})):e(i).endsWith(".py")?(o(),s(b,{key:2,style:{"vertical-align":"0"}})):e(i).endsWith(".ts")?(o(),s(M,{key:3,style:{"vertical-align":"0"}})):e(i).endsWith(".sh")?(o(),s(E,{key:4,style:{"vertical-align":"0"}})):(o(),s(N,{key:5,style:{"vertical-align":"0"}}))]),_:1})]),header:n(()=>[t(W,null,{default:n(()=>[j(p(e(z)||e(i))+" ",1),!e(m)&&e(w)?(o(),s(H,{key:0},{default:n(()=>[t(h,{"show-arrow":!1,trigger:"hover"},{trigger:n(()=>[t(f,{strong:"",secondary:"",size:"small",focusable:!1,onClick:l[0]||(l[0]=_=>y("goEdit"))},{icon:n(()=>[t(g,{size:16},{default:n(()=>[t(I,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1})]),default:n(()=>[u("span",null,p(e(r)("page.cron.scriptModal.goEditBtn")),1)]),_:1}),t(h,{"show-arrow":!1,trigger:"hover"},{trigger:n(()=>[t(f,{strong:"",secondary:"",size:"small",focusable:!1,onClick:l[1]||(l[1]=_=>y("copyContent"))},{icon:n(()=>[t(g,{size:14},{default:n(()=>[t(O,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1})]),default:n(()=>[u("span",null,p(e(r)("page.cron.scriptModal.copyBtn")),1)]),_:1}),t(h,{"show-arrow":!1,trigger:"hover"},{trigger:n(()=>[t(f,{strong:"",secondary:"",size:"small",focusable:!1,onClick:l[2]||(l[2]=_=>y("changeWrap"))},{icon:n(()=>[t(g,{size:16},{default:n(()=>[t(V,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1})]),default:n(()=>[u("span",null,p(e(r)("page.cron.scriptModal.wordWrapBtn")),1)]),_:1})]),_:1})):G("",!0)]),_:1})]),default:n(()=>[e(m)?(o(),s(P,{key:0,text:"",repeat:27,height:"16px"})):(o(),s(Q,{key:1,bordered:!1,style:{height:"100%","word-break":"unset"},"content-style":"height: 100%; padding: 1em 0 0 0; "},{default:n(()=>[t(J,{"x-scrollable":"",style:{"max-height":"600px",height:"100%"}},{default:n(()=>[t(T,{code:e(w),language:e(C),"show-line-numbers":e(x),"word-wrap":e(B),style:{"font-size":"14px",height:"100%"}},null,8,["code","language","show-line-numbers","word-wrap"])]),_:1})]),_:1}))]),_:1},8,["show"]))}}});export{Oe as _};
