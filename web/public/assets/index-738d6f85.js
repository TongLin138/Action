import{a6 as g,aH as Z,as as H,G as fe,x as s,C as G,aL as me,a7 as x,at as ge,u as e,a8 as a,a9 as n,aD as k,aB as u,ax as ve,aM as M,aI as P,aJ as J,al as _,aN as he,aC as ye,bm as be,bn as we,am as xe,aO as ke,aP as ze,aQ as Ce,aR as Se,aK as $e}from"./vendor-3ca7b8d8.js";import{_ as De}from"./PageWrapper.vue_vue_type_style_index_0_lang-93c21646.js";import{a as Be,c as Ne,L as Pe}from"./index-9b42ecb3.js";import{f as K,a as Ve,_ as Ee,b as Ie,c as Oe,d as Te,e as Me}from"./folderOpen-688d7f6b.js";import{_ as He,a as Le}from"./shortcut-43f59817.js";import{_ as Fe}from"./swap-outlined-2da29970.js";import{u as Ue}from"./useAppInject-85fd3906.js";import{u as We}from"./useTransition-9526ea13.js";import{s as je,g as Q,a as Re}from"./file-3de77f7d.js";import{f as Ae}from"./index-fb6838b8.js";import{f as qe}from"./folderDisable-b54ba11e.js";import"./sharp-arrow-back-ios-b43b17a4.js";import"./useDesign-7b9ba386.js";import"./propTypes-8a448afd.js";const Ge={style:{display:"inline-block"},viewBox:"0 0 2048 2048",width:"1em",height:"1em"},Je=H("path",{fill:"currentColor",d:"M1792 0v2048H256V0h1536zM384 128v384h1280V128H384zm1280 1408H384v384h1280v-384zm0-256V640H384v640h1280z"},null,-1),Ke=[Je];function Qe(L,f){return g(),Z("svg",Ge,Ke)}const Ze={name:"fluent-mdl2-diff-inline",render:Qe},Xe={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"},Ye=H("path",{fill:"currentColor",d:"M10 18H6v-2h4v2m0-4H6v-2h4v2m0-13v1H6c-1.11 0-2 .89-2 2v16a2 2 0 0 0 2 2h4v1h2V1h-2m10 7v12c0 1.11-.89 2-2 2h-4v-2h4v-9h-4V9h4.5L14 4.5V2l6 6m-4 6h-2v-2h2v2m0 4h-2v-2h2v2Z"},null,-1),en=[Ye];function nn(L,f){return g(),Z("svg",Xe,en)}const an={name:"mdi-file-compare",render:nn},hn=fe({__name:"index",setup(L){const{getIsMobile:f}=Ue(),{t:c}=Be(),{message:F}=Ne(),U=s("fade-slide");We(U);const V=s(),E=s([]),I=s([]),W=s({}),z=s({content:"",language:""}),y=s(""),C=s(!f.value),S=s(f.value?13:15),$=s(f.value?"on":"off"),p=s(""),m=s(""),O=s(!1),T=s(!1),v=s(!1),h=s(!1),D=async o=>{switch(o){case"showEditorShortcutsInfo":V.value.showShortCuts=!0;break;case"wordWrap":$.value=$.value==="on"?"off":"on",h.value=!1;break;case"renderSideBySide":C.value=!C.value,h.value=!1;break;case"save":O.value=!0;const t=e(V).getValue();try{await je({content:t,path:p.value}),F.success(c("editor.main.savedSuccess"))}finally{O.value=!1}break}},X=async()=>{v.value=!0;const o=await Q({}),t=j(o);E.value=t;const l=await Q({}),i=j(l);I.value=i,v.value=!1},j=o=>{const t=l=>{l.length&&l.forEach(i=>{if(i.type===0)Object.assign(i,{key:i.path,label:i.title,disabled:!0,prefix:()=>_(u,null,{default:()=>_(K)})}),t(i.children),i.children.length||(Object.assign(i,{children:null,disabled:!0}),i.prefix=()=>_(u,null,{default:()=>_(qe)}));else{const d=i.name;if(d){const N=d.substring(d.lastIndexOf(".")+1),b=Ae[N]||{};Object.assign(i,{key:i.path,label:d,language:b.language||"plaintext",disabled:b.disabled||!1,prefix:()=>_(u,null,{default:()=>_(b.icon||Me)})})}}})};return t(o),o},B=(o,t,l)=>{if(l.node)switch(l.action){case"expand":l.node.prefix=()=>_(u,null,{default:()=>_(Ve)});break;case"collapse":l.node.prefix=()=>_(u,null,{default:()=>_(K)});break}},R=async(o,t)=>{T.value=!0;const l=await Re({path:encodeURI(o.key)});if(l)switch(t){case"config":z.value={content:l,language:o.language};break;case"sample":y.value=l;break}else{switch(t){case"config":break;case"sample":y.value="";break}F.info(c("page.diff.fileContentIsEmptyMsg"))}T.value=!1},A=({option:o})=>({async onClick(){!o.children&&!o.disabled&&(W.value=o,await R(o,"config"))}}),q=({option:o})=>({async onClick(){!o.children&&!o.disabled&&(W.value=o,await R(o,"sample"))}});return G(p,o=>{o||(z.value={content:"",language:""})}),G(m,o=>{o||(y.value="")}),me(async()=>{await X()}),(o,t)=>{const l=he,i=an,d=ye,N=be,b=we,Y=Ee,w=xe,ee=Ie,ne=ke,ae=Fe,te=Ze,oe=ze,le=He,se=Ce,ie=Le,re=Oe,ce=Te,de=Se,ue=Pe,pe=$e,_e=De;return g(),x(_e,{ref:"pageWrapper","content-full":!0,title:e(c)("routes.main.page.diff")},ge({extra:a(()=>[e(p)&&e(m)?(g(),x(ve,{key:0,name:e(U),mode:"out-in",appear:""},{default:a(()=>[n(d,null,{default:a(()=>[n(d,{style:{gap:"0"}},{default:a(()=>[n(oe,{trigger:"manual",show:e(h),"show-arrow":!1,placement:"bottom"},{trigger:a(()=>[n(w,{strong:"",quaternary:"",size:"small",type:e(h)?"primary":"tertiary",style:{padding:"6px"},focusable:!1,onClick:t[4]||(t[4]=r=>h.value=!e(h))},{default:a(()=>[n(e(u),{size:"18"},{default:a(()=>[n(Y,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1},8,["type"])]),default:a(()=>[n(d,{vertical:""},{default:a(()=>[n(d,{size:"small"},{default:a(()=>[n(e(u),{size:20},{default:a(()=>[n(ee,{style:{"vertical-align":"-0.4em"}})]),_:1}),n(ne,{value:e(S),"onUpdate:value":t[5]||(t[5]=r=>k(S)?S.value=r:null),min:12,max:40,"button-placement":"both",size:"small",class:"max-w-94px"},null,8,["value"])]),_:1}),n(d,{size:"small"},{default:a(()=>[n(e(u),{size:20,color:e($)==="on"?"var(--app-primary-color)":void 0},{default:a(()=>[n(ae,{style:{"vertical-align":"-0.4em"}})]),_:1},8,["color"]),n(w,{strong:"",secondary:"",size:"small",style:{width:"94px"},onClick:t[6]||(t[6]=r=>D("wordWrap"))},{default:a(()=>[M(P(e(c)("editor.switch.wordWrapBtn")),1)]),_:1})]),_:1}),n(d,{size:"small"},{default:a(()=>[n(e(u),{size:20,color:e(C)?void 0:"var(--app-primary-color)"},{default:a(()=>[n(te,{style:{"vertical-align":"-0.4em"}})]),_:1},8,["color"]),n(w,{strong:"",secondary:"",size:"small",style:{width:"94px"},onClick:t[7]||(t[7]=r=>D("renderSideBySide"))},{default:a(()=>[M(P(e(c)("editor.switch.inlineModeTips")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["show"]),e(f)?J("",!0):(g(),x(se,{key:0,placement:"bottom",trigger:"hover",delay:500},{trigger:a(()=>[n(w,{strong:"",quaternary:"",size:"small",type:"tertiary",style:{padding:"6px"},focusable:!1,onClick:t[8]||(t[8]=r=>D("showEditorShortcutsInfo"))},{default:a(()=>[n(e(u),{size:"18"},{default:a(()=>[n(le,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1})]),default:a(()=>[H("span",null,P(e(c)("editor.switch.shortcutsTips")),1)]),_:1}))]),_:1}),n(w,{strong:"",type:"primary",size:"small",disabled:!e(p),loading:e(O),focusable:!1,onClick:t[9]||(t[9]=r=>D("save"))},{icon:a(()=>[n(ie)]),default:a(()=>[M(" "+P(e(c)("editor.main.saveButton")),1)]),_:1},8,["disabled","loading"])]),_:1})]),_:1},8,["name"])):J("",!0)]),default:a(()=>[n(pe,{bordered:!e(f),style:{height:"100%","word-break":"unset"},"content-style":"padding: 0"},{default:a(()=>[e(z).content||e(y)?(g(),x(re,{key:0,ref_key:"editor",ref:V,value:e(z),"origin-value":e(y),"diff-mode":!0,"word-wrap":e($),"render-side-by-side":e(C),"font-size":e(S)},null,8,["value","origin-value","word-wrap","render-side-by-side","font-size"])):(g(),x(de,{key:1,class:"min-h-200px flex-jc-ac h-full",size:"huge",description:e(c)("common.selectFileEmptyDesc")},{icon:a(()=>[n(e(u),null,{default:a(()=>[n(ce)]),_:1})]),_:1},8,["description"])),n(ue,{show:e(T)},null,8,["show"])]),_:1},8,["bordered"])]),_:2},[e(f)?{name:"headerContent",fn:a(()=>[n(b,{"x-gap":12,cols:2},{default:a(()=>[n(N,null,{default:a(()=>[n(l,{value:e(m),"onUpdate:value":t[2]||(t[2]=r=>k(m)?m.value=r:null),size:"small",loading:e(v),"consistent-menu-width":!1,clearable:"",placement:"bottom-start",placeholder:e(c)("page.diff.selectSourceFilePlaceholder"),options:e(I),"node-props":q,"on-update:expanded-keys":B},null,8,["value","loading","placeholder","options"])]),_:1}),n(N,null,{default:a(()=>[n(l,{value:e(p),"onUpdate:value":t[3]||(t[3]=r=>k(p)?p.value=r:null),size:"small",loading:e(v),"consistent-menu-width":!1,clearable:"",placement:"bottom-end",placeholder:e(c)("page.diff.selectDestinationFilePlaceholder"),options:e(E),"node-props":A,"on-update:expanded-keys":B},null,8,["value","loading","placeholder","options"])]),_:1})]),_:1})]),key:"1"}:{name:"subtitle",fn:a(()=>[n(d,null,{default:a(()=>[n(l,{value:e(m),"onUpdate:value":t[0]||(t[0]=r=>k(m)?m.value=r:null),size:"small",style:{width:"200px"},loading:e(v),"consistent-menu-width":!1,clearable:"",placeholder:e(c)("page.diff.selectSourceFilePlaceholder"),options:e(I),"node-props":q,"on-update:expanded-keys":B},null,8,["value","loading","placeholder","options"]),n(e(u),{size:"24",depth:3},{default:a(()=>[n(i)]),_:1}),n(l,{value:e(p),"onUpdate:value":t[1]||(t[1]=r=>k(p)?p.value=r:null),size:"small",style:{width:"200px"},loading:e(v),"consistent-menu-width":!1,clearable:"",placeholder:e(c)("page.diff.selectDestinationFilePlaceholder"),options:e(E),"node-props":A,"on-update:expanded-keys":B},null,8,["value","loading","placeholder","options"])]),_:1})]),key:"0"}]),1032,["title"])}}});export{hn as default};
