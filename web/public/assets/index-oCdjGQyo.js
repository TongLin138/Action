var x=(V,g,l)=>new Promise((k,z)=>{var h=r=>{try{d(l.next(r))}catch(c){z(c)}},v=r=>{try{d(l.throw(r))}catch(c){z(c)}},d=r=>r.done?k(r.value):Promise.resolve(r.value).then(h,v);d((l=l.apply(V,g)).next())});import{G as le,x as i,C as ie,aL as re,aM as ue,a6 as N,a7 as B,a8 as t,a9 as n,u as e,aD as M,ax as ce,aB as u,aN as T,aH as S,as as pe,aJ as U,al as _,aO as _e,am as de,aP as fe,aC as me,aQ as ge,aR as ve,aS as ye,aK as he}from"./vendor-tP7MJkVm.js";import{_ as be}from"./PageWrapper.vue_vue_type_style_index_0_lang-_BQo_egP.js";import{a as we,c as xe,L as ke}from"./index-YWZYq8iG.js";import{_ as ze,a as Ce,b as Ne,c as Be}from"./index.vue_vue_type_style_index_0_lang-DnSf_MPB.js";import{_ as Se,f as $e}from"./folderDisable-zmQ32rSn.js";import{_ as Ee,f as Ie}from"./filePrefix-MOkS9-Rv.js";import{_ as Te,a as Fe}from"./find-replace-HTUYavB3.js";import{_ as Oe}from"./swap-outlined-tp0eCcWN.js";import{u as De}from"./useAppInject-BuU8lio7.js";import{u as Le}from"./useTransition-qMbJRxJj.js";import{F as Pe}from"./fileTreeEnum-nxCMH85-.js";import{s as Ve,g as We,a as je}from"./file-myfSNQEg.js";import{f as A,a as Me,b as Ue}from"./index-Fh6gHIZ9.js";import"./sharp-arrow-back-ios-o7qdCfpO.js";import"./useDesign-7GyM2Hwu.js";import"./propTypes-LGH0h7_d.js";const ln=le({__name:"index",setup(V){const{getIsMobile:g}=De(),{t:l}=we(),{message:k}=xe(),z=i("fade-slide");Le(z);const h=i([]),v=i({}),d=i(),r=i({content:"",language:""}),c=i(""),$=i(!g.value),E=i(g.value?"on":"off"),F=i(!1),O=i(!1),D=i(!1),I=i(g.value?13:15),L=i(!1),y=i(!1),C=o=>x(this,null,function*(){switch(o){case"findBox":L.value=!L.value,y.value=!1;break;case"wordWrap":E.value=E.value==="on"?"off":"on",y.value=!1;break;case"minimap":$.value=!$.value,y.value=!1;break;case"showEditorShortcutsInfo":d.value.showShortCuts();break;case"save":F.value=!0;const a=e(d).getValue();try{yield Ve({content:a,path:v.value.path}),k.success(l("editor.main.savedSuccess"))}finally{F.value=!1,yield W()}break}}),W=()=>x(this,null,function*(){D.value=!0;const o=yield We({type:Pe.CONFIG}),a=R(o);h.value=a,D.value=!1}),R=o=>{const a=b=>{b.length&&b.forEach(s=>{if(s.type===0)Object.assign(s,{key:s.path,label:s.title,disabled:!0,prefix:()=>_(u,null,{default:()=>_(A)})}),a(s.children),s.children.length||(Object.assign(s,{children:null,disabled:!0}),s.prefix=()=>_(u,null,{default:()=>_($e)}));else{const w=s.name;if(w){const P=w.substring(w.lastIndexOf(".")+1),p=Ue[P]||{};Object.assign(s,{key:s.path,label:w,language:p.language||"plaintext",disabled:p.disabled||!1,prefix:()=>_(u,null,{default:()=>_(p.icon||Ie)})})}}})};a(o);const f=b=>b.filter(s=>s.children?(s.children=f(s.children),!0):!s.disabled);return o=f(o),o},q=(o,a,f)=>{if(f.node)switch(f.action){case"expand":f.node.prefix=()=>_(u,null,{default:()=>_(Me)});break;case"collapse":f.node.prefix=()=>_(u,null,{default:()=>_(A)});break}},G=({option:o})=>({onClick(){return x(this,null,function*(){!o.children&&!o.disabled&&(v.value=o,yield j(o))})}});function j(o){return x(this,null,function*(){O.value=!0;const a=yield je({path:encodeURI(o.key)});a?r.value={content:a,language:o.language}:(r.value={content:"",language:""},k.info(l("page.config.fileContentIsEmptyMsg"))),O.value=!1})}function H(){return x(this,null,function*(){yield W();let o={};if(h.value.length)for(const a of h.value)a.type===1&&a.name==="config.sh"&&(o=a);o.path?(v.value=o,j(v.value),c.value=v.value.path):k.error(l("page.config.mainConfigNotExistsMsg"),{keepAliveOnHover:!0})})}return ie(c,o=>{o||(r.value={content:"",language:""})}),re(()=>{H()}),ue(()=>{d.value&&d.value.dispose()}),(o,a)=>{const f=_e,b=Ce,s=de,w=Ne,P=fe,p=me,J=Te,K=Oe,Q=Fe,X=ge,Y=Ee,Z=ve,ee=Se,ne=Be,ae=ye,te=ke,oe=he,se=be;return N(),B(se,{ref:"pageWrapper","content-full":!0},{title:t(()=>[n(f,{value:e(c),"onUpdate:value":a[0]||(a[0]=m=>M(c)?c.value=m:null),size:"small",class:"min-w-190px",loading:e(D),"consistent-menu-width":!1,clearable:"",placeholder:e(l)("page.config.selectConfigFilePlaceholder"),options:e(h),"node-props":G,"on-update:expanded-keys":q},null,8,["value","loading","placeholder","options"])]),extra:t(()=>[e(c)?(N(),B(ce,{key:0,name:e(z),mode:"out-in",appear:""},{default:t(()=>[n(p,{style:{width:"fix-content"}},{default:t(()=>[n(p,{style:{gap:"0"}},{default:t(()=>[n(X,{trigger:"manual",style:{padding:"8px"},show:e(y),"show-arrow":!1,placement:"bottom"},{trigger:t(()=>[n(s,{strong:"",quaternary:"",size:"small",type:e(y)?"primary":"tertiary",style:{padding:"6px"},focusable:!1,onClick:a[1]||(a[1]=m=>y.value=!e(y))},{default:t(()=>[n(e(u),{size:"18"},{default:t(()=>[n(b,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1},8,["type"])]),default:t(()=>[n(p,{vertical:""},{default:t(()=>[n(p,{size:"small"},{default:t(()=>[n(e(u),{size:20},{default:t(()=>[n(w,{style:{"vertical-align":"-0.4em"}})]),_:1}),n(P,{value:e(I),"onUpdate:value":a[2]||(a[2]=m=>M(I)?I.value=m:null),min:12,max:40,"button-placement":"both",size:"small",class:"max-w-94px",style:{"text-align":"center"}},null,8,["value"])]),_:1}),n(p,{size:"small"},{default:t(()=>[n(e(u),{size:20},{default:t(()=>[n(J,{style:{"vertical-align":"-0.4em"}})]),_:1}),n(s,{strong:"",secondary:"",size:"small",style:{width:"94px"},onClick:a[3]||(a[3]=m=>C("findBox"))},{default:t(()=>[T(S(e(l)("editor.switch.findBtn")),1)]),_:1})]),_:1}),n(p,{size:"small"},{default:t(()=>[n(e(u),{size:20,color:e(E)==="on"?"var(--app-primary-color)":void 0},{default:t(()=>[n(K,{style:{"vertical-align":"-0.4em"}})]),_:1},8,["color"]),n(s,{strong:"",secondary:"",size:"small",style:{width:"94px"},onClick:a[4]||(a[4]=m=>C("wordWrap"))},{default:t(()=>[T(S(e(l)("editor.switch.wordWrapBtn")),1)]),_:1})]),_:1}),n(p,{size:"small"},{default:t(()=>[n(e(u),{size:20,color:e($)?"var(--app-primary-color)":void 0},{default:t(()=>[n(Q,{style:{"vertical-align":"-0.4em"}})]),_:1},8,["color"]),n(s,{strong:"",secondary:"",size:"small",style:{width:"94px"},onClick:a[5]||(a[5]=m=>C("minimap"))},{default:t(()=>[T(S(e(l)("editor.switch.minimapBtn")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["show"]),e(g)?U("",!0):(N(),B(Z,{key:0,placement:"bottom",trigger:"hover",delay:500},{trigger:t(()=>[n(s,{strong:"",quaternary:"",size:"small",type:"tertiary",style:{padding:"6px"},focusable:!1,onClick:a[6]||(a[6]=m=>C("showEditorShortcutsInfo"))},{default:t(()=>[n(e(u),{size:"18"},{default:t(()=>[n(Y,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1})]),default:t(()=>[pe("span",null,S(e(l)("editor.switch.shortcutsTips")),1)]),_:1}))]),_:1}),n(s,{strong:"",type:"primary",size:"small",loading:e(F),focusable:!1,onClick:a[7]||(a[7]=m=>C("save"))},{icon:t(()=>[n(ee)]),default:t(()=>[T(" "+S(e(l)("editor.main.saveButton")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["name"])):U("",!0)]),default:t(()=>[n(oe,{bordered:!e(g),style:{height:"100%","word-break":"unset"},"content-style":"padding: 0"},{default:t(()=>[e(c)?(N(),B(ze,{key:0,ref_key:"editor",ref:d,value:e(r),"word-wrap":e(E),minimap:e($),"font-size":e(I),"find-box":e(L)},null,8,["value","word-wrap","minimap","font-size","find-box"])):(N(),B(ae,{key:1,class:"min-h-200px flex-jc-ac h-full",size:"huge",description:e(l)("common.selectFileEmptyDesc")},{icon:t(()=>[n(e(u),null,{default:t(()=>[n(ne)]),_:1})]),_:1},8,["description"])),n(te,{show:e(O)},null,8,["show"])]),_:1},8,["bordered"])]),_:1},512)}}});export{ln as default};
