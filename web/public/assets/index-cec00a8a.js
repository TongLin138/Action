var b=(V,u,s)=>new Promise((E,z)=>{var h=_=>{try{y(s.next(_))}catch(g){z(g)}},C=_=>{try{y(s.throw(_))}catch(g){z(g)}},y=_=>_.done?E(_.value):Promise.resolve(_.value).then(h,C);y((s=s.apply(V,u)).next())});import{o as w,p as X,v as j,d as fe,b as me,z as ge,r as i,A as G,B as ve,C as he,c as B,au as ye,e,w as t,a as n,i as D,D as be,E as W,t as L,q as J,h as m,f as we,L as xe,y as ke}from"./index-797c0a85.js";import{_ as ze}from"./PageWrapper.vue_vue_type_style_index_0_lang-f0d6bddb.js";import{_ as Ce,a as Se,b as Ne,c as $e}from"./index.vue_vue_type_style_index_0_lang-50975d62.js";import{_ as Be,f as De}from"./folderDisable-67c9a4f1.js";import{_ as Ve,f as Ee}from"./filePrefix-28253f5c.js";import{_ as Pe}from"./swap-outlined-e52ae3c2.js";import{u as Ie}from"./useAppInject-e4ee4e96.js";import{u as Te}from"./useTransition-5809f8e4.js";import{s as Oe,g as K,a as Fe}from"./file-6dbc6db3.js";import{f as Q,a as He,b as Le}from"./index-9f937feb.js";import{_ as Me,a as Ue}from"./Grid-5e99a5d0.js";import{N as p}from"./Icon-abc31adc.js";import{N as We}from"./TreeSelect-10e2e39e.js";import{N as je}from"./Space-3cb079f3.js";import{N as Ae}from"./InputNumber-d8e642e9.js";import{_ as qe,a as Re}from"./Tooltip-271e10cc.js";import{_ as Ze}from"./Empty-aa248199.js";import"./monacoEditor-d72532b2.js";import"./sharp-arrow-back-ios-ca1144ee.js";import"./useDesign-a03ef768.js";import"./propTypes-69de8b77.js";import"./Tag-274eae2a.js";import"./Table-f28f3c40.js";import"./Tree-c1a4f7b1.js";import"./Checkbox-007ffc49.js";import"./FocusDetector-effeeed3.js";import"./use-locale-3967e664.js";import"./Selection-a7bafa19.js";import"./Input-c8aa899c.js";import"./attribute-2ee9e579.js";import"./use-resize-d169ca1a.js";import"./Remove-cd58428d.js";import"./Add-843bb42e.js";import"./on-fonts-ready-2684803e.js";const Ge={style:{display:"inline-block"},viewBox:"0 0 2048 2048",width:"1em",height:"1em"},Je=j("path",{fill:"currentColor",d:"M1792 0v2048H256V0h1536zM384 128v384h1280V128H384zm1280 1408H384v384h1280v-384zm0-256V640H384v640h1280z"},null,-1),Ke=[Je];function Qe(V,u){return w(),X("svg",Ge,[...Ke])}const Xe={name:"fluent-mdl2-diff-inline",render:Qe},Ye={style:{display:"inline-block"},viewBox:"0 0 24 24",width:"1em",height:"1em"},en=j("path",{fill:"currentColor",d:"M10 18H6v-2h4v2m0-4H6v-2h4v2m0-13v1H6c-1.11 0-2 .89-2 2v16a2 2 0 0 0 2 2h4v1h2V1h-2m10 7v12c0 1.11-.89 2-2 2h-4v-2h4v-9h-4V9h4.5L14 4.5V2l6 6m-4 6h-2v-2h2v2m0 4h-2v-2h2v2Z"},null,-1),nn=[en];function tn(V,u){return w(),X("svg",Ye,[...nn])}const on={name:"mdi-file-compare",render:tn},Mn=fe({__name:"index",setup(V){const{getIsMobile:u}=Ie(),{t:s}=me(),{message:E}=ge(),z=i("fade-slide");Te(z);const h=i(),C=i([]),y=i([]),_=i({}),g=i({content:"",language:""}),S=i(""),P=i(!u.value),I=i(u.value?13:15),T=i(u.value?"on":"off"),f=i(""),v=i(""),M=i(!1),U=i(!1),x=i(!1),k=i(!1),O=a=>b(this,null,function*(){switch(a){case"showEditorShortcutsInfo":h.value.showShortCuts();break;case"wordWrap":T.value=T.value==="on"?"off":"on",k.value=!1;break;case"renderSideBySide":P.value=!P.value,k.value=!1;break;case"save":M.value=!0;const o=e(h).getValue();try{yield Oe({content:o,path:f.value}),E.success(s("editor.main.savedSuccess"))}finally{M.value=!1}break}}),Y=()=>b(this,null,function*(){x.value=!0;const a=yield K({}),o=A(a);C.value=o;const l=yield K({}),r=A(l);y.value=r,x.value=!1}),A=a=>{const o=l=>{l.length&&l.forEach(r=>{if(r.type===0)Object.assign(r,{key:r.path,label:r.title,disabled:!0,prefix:()=>m(p,null,{default:()=>m(Q)})}),o(r.children),r.children.length||(Object.assign(r,{children:null,disabled:!0}),r.prefix=()=>m(p,null,{default:()=>m(De)}));else{const d=r.name;if(d){const H=d.substring(d.lastIndexOf(".")+1),N=Le[H]||{};Object.assign(r,{key:r.path,label:d,language:N.language||"plaintext",disabled:N.disabled||!1,prefix:()=>m(p,null,{default:()=>m(N.icon||Ee)})})}}})};return o(a),a},F=(a,o,l)=>{if(l.node)switch(l.action){case"expand":l.node.prefix=()=>m(p,null,{default:()=>m(He)});break;case"collapse":l.node.prefix=()=>m(p,null,{default:()=>m(Q)});break}},q=(a,o)=>b(this,null,function*(){U.value=!0;const l=yield Fe({path:encodeURI(a.key)});if(l)switch(o){case"config":g.value={content:l,language:a.language};break;case"sample":S.value=l;break}else{switch(o){case"config":break;case"sample":S.value="";break}E.info(s("page.diff.fileContentIsEmptyMsg"))}U.value=!1}),R=({option:a})=>({onClick(){return b(this,null,function*(){!a.children&&!a.disabled&&(_.value=a,yield q(a,"config"))})}}),Z=({option:a})=>({onClick(){return b(this,null,function*(){!a.children&&!a.disabled&&(_.value=a,yield q(a,"sample"))})}});return G(f,a=>{a||(g.value={content:"",language:""})}),G(v,a=>{a||(S.value="")}),ve(()=>b(this,null,function*(){yield Y()})),he(()=>{h.value&&h.value.dispose()}),(a,o)=>{const l=We,r=on,d=je,H=Me,N=Ue,ee=Se,$=we,ne=Ne,te=Ae,oe=Pe,ae=Xe,le=qe,se=Ve,ie=Re,re=Be,ce=$e,de=Ze,pe=xe,ue=ke,_e=ze;return w(),B(_e,{ref:"pageWrapper","content-full":!0,title:e(s)("routes.main.page.diff")},ye({extra:t(()=>[e(f)&&e(v)?(w(),B(be,{key:0,name:e(z),mode:"out-in",appear:""},{default:t(()=>[n(d,null,{default:t(()=>[n(d,{style:{gap:"0"}},{default:t(()=>[n(le,{trigger:"manual",style:{padding:"8px"},show:e(k),"show-arrow":!1,placement:"bottom"},{trigger:t(()=>[n($,{strong:"",quaternary:"",size:"small",type:e(k)?"primary":"tertiary",style:{padding:"6px"},focusable:!1,onClick:o[4]||(o[4]=c=>k.value=!e(k))},{default:t(()=>[n(e(p),{size:"18"},{default:t(()=>[n(ee,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1},8,["type"])]),default:t(()=>[n(d,{vertical:""},{default:t(()=>[n(d,{size:"small"},{default:t(()=>[n(e(p),{size:20},{default:t(()=>[n(ne,{style:{"vertical-align":"-0.4em"}})]),_:1}),n(te,{value:e(I),"onUpdate:value":o[5]||(o[5]=c=>D(I)?I.value=c:null),min:12,max:40,"button-placement":"both",size:"small",class:"max-w-94px",style:{"text-align":"center"}},null,8,["value"])]),_:1}),n(d,{size:"small"},{default:t(()=>[n(e(p),{size:20,color:e(T)==="on"?"var(--app-primary-color)":void 0},{default:t(()=>[n(oe,{style:{"vertical-align":"-0.4em"}})]),_:1},8,["color"]),n($,{strong:"",secondary:"",size:"small",style:{width:"94px"},onClick:o[6]||(o[6]=c=>O("wordWrap"))},{default:t(()=>[W(L(e(s)("editor.switch.wordWrapBtn")),1)]),_:1})]),_:1}),n(d,{size:"small"},{default:t(()=>[n(e(p),{size:20,color:e(P)?void 0:"var(--app-primary-color)"},{default:t(()=>[n(ae,{style:{"vertical-align":"-0.4em"}})]),_:1},8,["color"]),n($,{strong:"",secondary:"",size:"small",style:{width:"94px"},onClick:o[7]||(o[7]=c=>O("renderSideBySide"))},{default:t(()=>[W(L(e(s)("editor.switch.inlineModeTips")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["show"]),e(u)?J("",!0):(w(),B(ie,{key:0,placement:"bottom",trigger:"hover",delay:500},{trigger:t(()=>[n($,{strong:"",quaternary:"",size:"small",type:"tertiary",style:{padding:"6px"},focusable:!1,onClick:o[8]||(o[8]=c=>O("showEditorShortcutsInfo"))},{default:t(()=>[n(e(p),{size:"18"},{default:t(()=>[n(se,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1})]),default:t(()=>[j("span",null,L(e(s)("editor.switch.shortcutsTips")),1)]),_:1}))]),_:1}),n($,{strong:"",type:"primary",size:"small",disabled:!e(f),loading:e(M),focusable:!1,onClick:o[9]||(o[9]=c=>O("save"))},{icon:t(()=>[n(re)]),default:t(()=>[W(" "+L(e(s)("editor.main.saveButton")),1)]),_:1},8,["disabled","loading"])]),_:1})]),_:1},8,["name"])):J("",!0)]),default:t(()=>[n(ue,{bordered:!e(u),style:{height:"100%","word-break":"unset"},"content-style":"padding: 0"},{default:t(()=>[e(g).content||e(S)?(w(),B(Ce,{key:0,ref_key:"editor",ref:h,value:e(g),"origin-value":e(S),"diff-mode":!0,"word-wrap":e(T),"render-side-by-side":e(P),"font-size":e(I)},null,8,["value","origin-value","word-wrap","render-side-by-side","font-size"])):(w(),B(de,{key:1,class:"min-h-200px flex-jc-ac h-full",size:"huge",description:e(s)("common.selectFileEmptyDesc")},{icon:t(()=>[n(e(p),null,{default:t(()=>[n(ce)]),_:1})]),_:1},8,["description"])),n(pe,{show:e(U)},null,8,["show"])]),_:1},8,["bordered"])]),_:2},[e(u)?{name:"headerContent",fn:t(()=>[n(N,{"x-gap":12,cols:2},{default:t(()=>[n(H,null,{default:t(()=>[n(l,{value:e(v),"onUpdate:value":o[2]||(o[2]=c=>D(v)?v.value=c:null),size:"small",loading:e(x),"consistent-menu-width":!1,clearable:"",placement:"bottom-start",placeholder:e(s)("page.diff.selectSourceFilePlaceholder"),options:e(y),"node-props":Z,"on-update:expanded-keys":F},null,8,["value","loading","placeholder","options"])]),_:1}),n(H,null,{default:t(()=>[n(l,{value:e(f),"onUpdate:value":o[3]||(o[3]=c=>D(f)?f.value=c:null),size:"small",loading:e(x),"consistent-menu-width":!1,clearable:"",placement:"bottom-end",placeholder:e(s)("page.diff.selectDestinationFilePlaceholder"),options:e(C),"node-props":R,"on-update:expanded-keys":F},null,8,["value","loading","placeholder","options"])]),_:1})]),_:1})]),key:"1"}:{name:"subtitle",fn:t(()=>[n(d,null,{default:t(()=>[n(l,{value:e(v),"onUpdate:value":o[0]||(o[0]=c=>D(v)?v.value=c:null),size:"small",style:{"min-width":"200px",width:"fit-content"},"show-path":"",loading:e(x),"consistent-menu-width":!1,clearable:"",placeholder:e(s)("page.diff.selectSourceFilePlaceholder"),options:e(y),"node-props":Z,"on-update:expanded-keys":F},null,8,["value","loading","placeholder","options"]),n(e(p),{size:"24",depth:3},{default:t(()=>[n(r)]),_:1}),n(l,{value:e(f),"onUpdate:value":o[1]||(o[1]=c=>D(f)?f.value=c:null),size:"small",style:{"min-width":"200px",width:"fit-content"},"show-path":"",loading:e(x),"consistent-menu-width":!1,clearable:"",placeholder:e(s)("page.diff.selectDestinationFilePlaceholder"),options:e(C),"node-props":R,"on-update:expanded-keys":F},null,8,["value","loading","placeholder","options"])]),_:1})]),key:"0"}]),1032,["title"])}}});export{Mn as default};
