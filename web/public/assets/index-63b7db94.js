import{G as le,x as s,C as ie,aI as re,a6 as w,a7 as b,a8 as a,ac as n,u as e,aE as j,aK as ue,aJ as i,aL as T,aC as x,aG as ce,aD as V,al as c,aM as pe,am as _e,aQ as de,aN as fe,aR as me,aS as ge,aT as ve,aH as ye}from"./vendor-605eddea.js";import{_ as he}from"./PageWrapper.vue_vue_type_style_index_0_lang-32cdcc51.js";import{b as we,c as be,L as xe}from"./index-bbe7d773.js";import{f as R,a as ke,_ as Ce,b as ze,c as Ee,d as Ne,e as Ie}from"./folderOpen-ea1914b0.js";import{_ as Te,a as $e}from"./shortcut-fcedd9ec.js";import{_ as Be,a as Se}from"./find-replace-e9d8c08c.js";import{_ as Fe}from"./swap-outlined-c2e90102.js";import{u as Le}from"./useAppInject-315274ec.js";import{u as Oe}from"./useTransition-22eddc61.js";import{F as De}from"./fileTreeEnum-3de0f4c6.js";import{s as Me,g as Pe,a as We}from"./file-a0aae56a.js";import{f as je}from"./index-82a40a9e.js";import{f as Ve}from"./folderDisable-fda256a4.js";import"./sharp-arrow-back-ios-fa33e058.js";import"./useDesign-32ab0668.js";import"./propTypes-8a448afd.js";const sn=le({__name:"index",setup(Re){const{getIsMobile:v}=Le(),{t:u}=we(),{message:$}=be(),D=s("fade-slide");Oe(D);const k=s([]),d=s({}),B=s(),C=s(""),M=s(""),f=s(""),z=s(!v.value),E=s(v.value?"on":"off"),S=s(!1),N=s(!0),F=s(!1),I=s(v.value?13:15),L=s(!1),m=s(!1),y=async o=>{switch(o){case"findBox":L.value=!L.value,m.value=!1;break;case"wordWrap":E.value=E.value==="on"?"off":"on",m.value=!1;break;case"minimap":z.value=!z.value,m.value=!1;break;case"showEditorShortcutsInfo":B.value.showShortCuts=!0;break;case"save":S.value=!0;const t=e(B).getValue();try{await Me({content:t,path:d.value.path}),$.success(u("editor.main.savedSuccess"))}finally{S.value=!1,await P()}break}},P=async()=>{F.value=!0;const o=await Pe({type:De.CONFIG});k.value=A(o),F.value=!1},A=o=>{const t=p=>{p.length&&p.forEach(l=>{if(l.type===0)Object.assign(l,{key:l.path,label:l.title,disabled:!0,prefix:()=>c(i,null,{default:()=>c(R)})}),t(l.children),l.children.length||(Object.assign(l,{children:null,disabled:!0}),l.prefix=()=>c(i,null,{default:()=>c(Ve)}));else{const r=l.name;if(r){const O=r.substring(r.lastIndexOf(".")+1),h=je[O]||{};Object.assign(l,{key:l.path,label:r,language:h.language||"plaintext",disabled:h.disabled||!1,prefix:()=>c(i,null,{default:()=>c(h.icon||Ie)})})}}})};return t(o),o},G=(o,t,p)=>{if(p.node)switch(p.action){case"expand":p.node.prefix=()=>c(i,null,{default:()=>c(ke)});break;case"collapse":p.node.prefix=()=>c(i,null,{default:()=>c(R)});break}},U=({option:o})=>({async onClick(){!o.children&&!o.disabled&&(d.value=o,await W(o))}});async function W(o){M.value=o.language,N.value=!0;const t=await We({path:encodeURI(o.key)});N.value=!1,t?C.value=t:(C.value="",$.info(u("page.editConfig.fileContentIsEmptyMsg")))}function q(){if(k.value.length){for(const o of k.value)if(o.type===1&&o.name==="config.sh")return o}return{}}return ie(f,o=>{o||(d.value={},C.value="")}),re(async()=>{await P(),d.value=q(),d.value.path?(await W(d.value),f.value=d.value.path):$.error(u("page.editConfig.mainConfigNotExistsMsg"),{keepAliveOnHover:!0}),N.value=!1}),(o,t)=>{const p=pe,l=Ce,r=_e,O=ze,h=de,g=fe,H=Be,J=Fe,K=Se,Q=me,X=Te,Y=ge,Z=$e,ee=Ee,ne=Ne,ae=ve,te=xe,oe=ye,se=he;return w(),b(se,{ref:"pageWrapper","content-full":!0},{title:a(()=>[n(p,{value:e(f),"onUpdate:value":t[0]||(t[0]=_=>j(f)?f.value=_:null),size:"small",class:"min-w-170px",loading:e(F),"consistent-menu-width":!1,clearable:"","show-path":!0,separator:"/",placeholder:e(u)("page.editConfig.selectConfigFilePlaceholder"),options:e(k),"node-props":U,"on-update:expanded-keys":G},null,8,["value","loading","placeholder","options"])]),extra:a(()=>[e(f)?(w(),b(ue,{key:0,name:e(D),mode:"out-in",appear:""},{default:a(()=>[n(g,{style:{width:"fix-content"}},{default:a(()=>[n(g,{style:{gap:"0"}},{default:a(()=>[n(Q,{trigger:"manual",show:e(m),"show-arrow":!1,placement:"bottom"},{trigger:a(()=>[n(r,{strong:"",quaternary:"",size:"small",type:e(m)?"primary":"tertiary",style:{padding:"6px"},focusable:!1,onClick:t[1]||(t[1]=_=>m.value=!e(m))},{default:a(()=>[n(e(i),{size:"18"},{default:a(()=>[n(l,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1},8,["type"])]),default:a(()=>[n(g,{vertical:""},{default:a(()=>[n(g,{size:"small"},{default:a(()=>[n(e(i),{size:20},{default:a(()=>[n(O,{style:{"vertical-align":"-0.4em"}})]),_:1}),n(h,{value:e(I),"onUpdate:value":t[2]||(t[2]=_=>j(I)?I.value=_:null),min:12,max:40,"button-placement":"both",size:"small",class:"max-w-94px"},null,8,["value"])]),_:1}),n(g,{size:"small"},{default:a(()=>[n(e(i),{size:20},{default:a(()=>[n(H,{style:{"vertical-align":"-0.4em"}})]),_:1}),n(r,{strong:"",secondary:"",size:"small",style:{width:"94px"},onClick:t[3]||(t[3]=_=>y("findBox"))},{default:a(()=>[T(x(e(u)("editor.switch.findBtn")),1)]),_:1})]),_:1}),n(g,{size:"small"},{default:a(()=>[n(e(i),{size:20,color:e(E)==="on"?"var(--app-primary-color)":void 0},{default:a(()=>[n(J,{style:{"vertical-align":"-0.4em"}})]),_:1},8,["color"]),n(r,{strong:"",secondary:"",size:"small",style:{width:"94px"},onClick:t[4]||(t[4]=_=>y("wordWrap"))},{default:a(()=>[T(x(e(u)("editor.switch.wordWrapBtn")),1)]),_:1})]),_:1}),n(g,{size:"small"},{default:a(()=>[n(e(i),{size:20,color:e(z)?"var(--app-primary-color)":void 0},{default:a(()=>[n(K,{style:{"vertical-align":"-0.4em"}})]),_:1},8,["color"]),n(r,{strong:"",secondary:"",size:"small",style:{width:"94px"},onClick:t[5]||(t[5]=_=>y("minimap"))},{default:a(()=>[T(x(e(u)("editor.switch.minimapBtn")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["show"]),e(v)?V("",!0):(w(),b(Y,{key:0,placement:"bottom",trigger:"hover",delay:500},{trigger:a(()=>[n(r,{strong:"",quaternary:"",size:"small",type:"tertiary",style:{padding:"6px"},focusable:!1,onClick:t[6]||(t[6]=_=>y("showEditorShortcutsInfo"))},{default:a(()=>[n(e(i),{size:"18"},{default:a(()=>[n(X,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1})]),default:a(()=>[ce("span",null,x(e(u)("editor.switch.shortcutsTips")),1)]),_:1}))]),_:1}),n(r,{strong:"",type:"primary",size:"small",loading:e(S),focusable:!1,onClick:t[7]||(t[7]=_=>y("save"))},{icon:a(()=>[n(Z)]),default:a(()=>[T(" "+x(e(u)("editor.main.saveButton")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["name"])):V("",!0)]),default:a(()=>[n(oe,{bordered:!e(v),style:{height:"100%","word-break":"unset"},"content-style":"padding: 0"},{default:a(()=>[e(f)?(w(),b(ee,{key:0,ref_key:"editor",ref:B,value:e(C),language:e(M),"word-wrap":e(E),minimap:e(z),"font-size":e(I),"find-box":e(L)},null,8,["value","language","word-wrap","minimap","font-size","find-box"])):(w(),b(ae,{key:1,class:"min-h-200px flex-jc-ac h-full",size:"huge",description:e(u)("common.selectFileEmptyDesc")},{icon:a(()=>[n(e(i),null,{default:a(()=>[n(ne)]),_:1})]),_:1},8,["description"])),n(te,{show:e(N)},null,8,["show"])]),_:1},8,["bordered"])]),_:1},512)}}});export{sn as default};
