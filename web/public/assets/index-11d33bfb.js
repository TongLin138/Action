import{G as se,x as s,C as le,aL as ie,a6 as w,a7 as b,a8 as a,a9 as n,u as e,aD as V,ax as re,aB as i,aM as I,aI as x,as as ue,aJ as W,al as c,aN as ce,am as pe,aO as _e,aC as de,aP as fe,aQ as me,aR as ge,aK as ve}from"./vendor-3ca7b8d8.js";import{_ as ye}from"./PageWrapper.vue_vue_type_style_index_0_lang-1d34266c.js";import{a as he,c as we,L as be}from"./index-19149e19.js";import{f as j,a as xe,_ as ke,b as ze,c as Ce,d as Ne,e as Be}from"./folderOpen-28b8bb39.js";import{_ as Ee,a as Ie}from"./shortcut-43f59817.js";import{_ as Se,a as Te}from"./find-replace-6c1228a0.js";import{_ as $e}from"./swap-outlined-2da29970.js";import{u as Oe}from"./useAppInject-44f70e5f.js";import{u as Fe}from"./useTransition-1ad89827.js";import{F as De}from"./fileTreeEnum-3de0f4c6.js";import{s as Le,g as Pe,a as Me}from"./file-6440000a.js";import{f as Ve}from"./index-3dc79821.js";import{f as We}from"./folderDisable-a9801b79.js";import"./sharp-arrow-back-ios-b43b17a4.js";import"./useDesign-5cc8148f.js";import"./propTypes-8a448afd.js";const on=se({__name:"index",setup(je){const{getIsMobile:v}=Oe(),{t:u}=he(),{message:S}=we(),L=s("fade-slide");Fe(L);const k=s([]),g=s({}),T=s(),z=s({content:"",language:""}),d=s(""),C=s(!v.value),N=s(v.value?"on":"off"),$=s(!1),B=s(!0),O=s(!1),E=s(v.value?13:15),F=s(!1),f=s(!1),y=async o=>{switch(o){case"findBox":F.value=!F.value,f.value=!1;break;case"wordWrap":N.value=N.value==="on"?"off":"on",f.value=!1;break;case"minimap":C.value=!C.value,f.value=!1;break;case"showEditorShortcutsInfo":T.value.showShortCuts=!0;break;case"save":$.value=!0;const t=e(T).getValue();try{await Le({content:t,path:g.value.path}),S.success(u("editor.main.savedSuccess"))}finally{$.value=!1,await P()}break}},P=async()=>{O.value=!0;const o=await Pe({type:De.CONFIG}),t=A(o);k.value=t,O.value=!1},A=o=>{const t=p=>{p.length&&p.forEach(l=>{if(l.type===0)Object.assign(l,{key:l.path,label:l.title,disabled:!0,prefix:()=>c(i,null,{default:()=>c(j)})}),t(l.children),l.children.length||(Object.assign(l,{children:null,disabled:!0}),l.prefix=()=>c(i,null,{default:()=>c(We)}));else{const r=l.name;if(r){const D=r.substring(r.lastIndexOf(".")+1),h=Ve[D]||{};Object.assign(l,{key:l.path,label:r,language:h.language||"plaintext",disabled:h.disabled||!1,prefix:()=>c(i,null,{default:()=>c(h.icon||Be)})})}}})};return t(o),o},R=(o,t,p)=>{if(p.node)switch(p.action){case"expand":p.node.prefix=()=>c(i,null,{default:()=>c(xe)});break;case"collapse":p.node.prefix=()=>c(i,null,{default:()=>c(j)});break}},U=({option:o})=>({async onClick(){!o.children&&!o.disabled&&(g.value=o,await M(o))}});async function M(o){B.value=!0;const t=await Me({path:encodeURI(o.key)});t?z.value={content:t,language:o.language}:(z.value={content:"",language:""},S.info(u("page.config.fileContentIsEmptyMsg"))),B.value=!1}function q(){if(k.value.length){for(const o of k.value)if(o.type===1&&o.name==="config.sh")return o}return{}}return le(d,o=>{o||(z.value={content:"",language:""})}),ie(async()=>{await P(),g.value=q(),g.value.path?(await M(g.value),d.value=g.value.path):S.error(u("page.config.mainConfigNotExistsMsg"),{keepAliveOnHover:!0}),B.value=!1}),(o,t)=>{const p=ce,l=ke,r=pe,D=ze,h=_e,m=de,G=Se,H=$e,J=Te,K=fe,Q=Ee,X=me,Y=Ie,Z=Ce,ee=Ne,ne=ge,ae=be,te=ve,oe=ye;return w(),b(oe,{ref:"pageWrapper","content-full":!0},{title:a(()=>[n(p,{value:e(d),"onUpdate:value":t[0]||(t[0]=_=>V(d)?d.value=_:null),size:"small",class:"min-w-190px",loading:e(O),"consistent-menu-width":!1,clearable:"",placeholder:e(u)("page.config.selectConfigFilePlaceholder"),options:e(k),"node-props":U,"on-update:expanded-keys":R},null,8,["value","loading","placeholder","options"])]),extra:a(()=>[e(d)?(w(),b(re,{key:0,name:e(L),mode:"out-in",appear:""},{default:a(()=>[n(m,{style:{width:"fix-content"}},{default:a(()=>[n(m,{style:{gap:"0"}},{default:a(()=>[n(K,{trigger:"manual",show:e(f),"show-arrow":!1,placement:"bottom"},{trigger:a(()=>[n(r,{strong:"",quaternary:"",size:"small",type:e(f)?"primary":"tertiary",style:{padding:"6px"},focusable:!1,onClick:t[1]||(t[1]=_=>f.value=!e(f))},{default:a(()=>[n(e(i),{size:"18"},{default:a(()=>[n(l,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1},8,["type"])]),default:a(()=>[n(m,{vertical:""},{default:a(()=>[n(m,{size:"small"},{default:a(()=>[n(e(i),{size:20},{default:a(()=>[n(D,{style:{"vertical-align":"-0.4em"}})]),_:1}),n(h,{value:e(E),"onUpdate:value":t[2]||(t[2]=_=>V(E)?E.value=_:null),min:12,max:40,"button-placement":"both",size:"small",class:"max-w-94px"},null,8,["value"])]),_:1}),n(m,{size:"small"},{default:a(()=>[n(e(i),{size:20},{default:a(()=>[n(G,{style:{"vertical-align":"-0.4em"}})]),_:1}),n(r,{strong:"",secondary:"",size:"small",style:{width:"94px"},onClick:t[3]||(t[3]=_=>y("findBox"))},{default:a(()=>[I(x(e(u)("editor.switch.findBtn")),1)]),_:1})]),_:1}),n(m,{size:"small"},{default:a(()=>[n(e(i),{size:20,color:e(N)==="on"?"var(--app-primary-color)":void 0},{default:a(()=>[n(H,{style:{"vertical-align":"-0.4em"}})]),_:1},8,["color"]),n(r,{strong:"",secondary:"",size:"small",style:{width:"94px"},onClick:t[4]||(t[4]=_=>y("wordWrap"))},{default:a(()=>[I(x(e(u)("editor.switch.wordWrapBtn")),1)]),_:1})]),_:1}),n(m,{size:"small"},{default:a(()=>[n(e(i),{size:20,color:e(C)?"var(--app-primary-color)":void 0},{default:a(()=>[n(J,{style:{"vertical-align":"-0.4em"}})]),_:1},8,["color"]),n(r,{strong:"",secondary:"",size:"small",style:{width:"94px"},onClick:t[5]||(t[5]=_=>y("minimap"))},{default:a(()=>[I(x(e(u)("editor.switch.minimapBtn")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["show"]),e(v)?W("",!0):(w(),b(X,{key:0,placement:"bottom",trigger:"hover",delay:500},{trigger:a(()=>[n(r,{strong:"",quaternary:"",size:"small",type:"tertiary",style:{padding:"6px"},focusable:!1,onClick:t[6]||(t[6]=_=>y("showEditorShortcutsInfo"))},{default:a(()=>[n(e(i),{size:"18"},{default:a(()=>[n(Q,{style:{"vertical-align":"baseline"}})]),_:1})]),_:1})]),default:a(()=>[ue("span",null,x(e(u)("editor.switch.shortcutsTips")),1)]),_:1}))]),_:1}),n(r,{strong:"",type:"primary",size:"small",loading:e($),focusable:!1,onClick:t[7]||(t[7]=_=>y("save"))},{icon:a(()=>[n(Y)]),default:a(()=>[I(" "+x(e(u)("editor.main.saveButton")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["name"])):W("",!0)]),default:a(()=>[n(te,{bordered:!e(v),style:{height:"100%","word-break":"unset"},"content-style":"padding: 0"},{default:a(()=>[e(d)?(w(),b(Z,{key:0,ref_key:"editor",ref:T,value:e(z),"word-wrap":e(N),minimap:e(C),"font-size":e(E),"find-box":e(F)},null,8,["value","word-wrap","minimap","font-size","find-box"])):(w(),b(ne,{key:1,class:"min-h-200px flex-jc-ac h-full",size:"huge",description:e(u)("common.selectFileEmptyDesc")},{icon:a(()=>[n(e(i),null,{default:a(()=>[n(ee)]),_:1})]),_:1},8,["description"])),n(ae,{show:e(B)},null,8,["show"])]),_:1},8,["bordered"])]),_:1},512)}}});export{on as default};
