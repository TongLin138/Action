import{a6 as l,aH as U,as as be,u as r,c9 as Re,ca as Se,cb as De,cc as je,cd as _e,s as W,a_ as Oe,c8 as Te,bj as ye,ce as $e,aO as Ue,cf as Ae,a$ as Le,b0 as Ge,cg as ze,ch as Ee,ci as qe,cj as Je,aN as We,b1 as He,b2 as Qe,ck as Ke,bB as Xe,bk as Ye,G as Ze,x as A,r as xe,bQ as et,h as O,ah as tt,C as oe,aL as nt,a7 as g,a8 as i,a9 as T,aa as ne,ab as de,aU as z,au as J,aG as L,at as ot,M as pe,aM as S,aI as D,bM as fe,cl as st,aJ as $,aw as me,bd as at,aQ as rt,aV as lt,aC as it,aW as ut,bD as ct,bE as dt,c4 as pt,bC as ft,bm as mt,am as gt,aB as bt,bn as _t,bF as yt,aS as kt,y as Nt}from"./vendor-3ca7b8d8.js";import{_ as Pt}from"./question-circle-outlined-bad04f4d.js";import{h as H,S as ht,f as ke,U as ge,e as Ne,a as vt,d as wt,V as Ct,W as Ft,_ as It,X as Bt,Y as Mt}from"./index-9b42ecb3.js";import{p as _}from"./propTypes-8a448afd.js";import{u as Vt}from"./useBreakpoint-c44ece78.js";const Rt={style:{display:"inline-block"},viewBox:"0 0 1024 1024",width:"1em",height:"1em"},St=be("path",{fill:"currentColor",d:"M890.5 755.3L537.9 269.2c-12.8-17.6-39-17.6-51.7 0L133.5 755.3A8 8 0 0 0 140 768h75c5.1 0 9.9-2.5 12.9-6.6L512 369.8l284.1 391.6c3 4.1 7.8 6.6 12.9 6.6h75c6.5 0 10.3-7.4 6.5-12.7z"},null,-1),Dt=[St];function jt(e,b){return l(),U("svg",Rt,Dt)}const Ot={name:"ant-design-up-outlined",render:jt},Tt={style:{display:"inline-block"},viewBox:"0 0 1024 1024",width:"1em",height:"1em"},$t=be("path",{fill:"currentColor",d:"M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2L227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"},null,-1),Ut=[$t];function At(e,b){return l(),U("svg",Tt,Ut)}const Lt={name:"ant-design-down-outlined",render:At};function Gt(e){return e?["NPicker","NSelect","NCheckbox","NRadio","NSwitch","NDatePicker","NTimePicker"].includes(e)?"请选择":"请输入":""}function zt(e,b,f=!0){switch(b){case"NDatePicker":case"NTimePicker":e.type=f?"string":"object";break;case"NUpload":case"NCheckboxGroup":case"NDateRangePicker":e.type="array";break;case"NInputNumber":e.type="number";break}}function Et({emit:e,getProps:b,formModel:f,getSchema:y,formElRef:F,defaultFormModel:V,handleFormValues:o}){async function m(){return r(F)?.validate()}async function u(k){k&&k.preventDefault();const{submitFunc:d}=r(b);if(d&&H(d)){await d(f);return}if(r(F))try{return await m(),e("submit",f),f}catch{return!1}}async function v(){await r(F)?.restoreValidation()}async function I(){const{resetFunc:k,submitOnReset:d}=r(b);if(k&&H(k)&&await k(),!r(F))return;r(y).forEach(j=>{Re(f,j.field,()=>_e(V.value,j.field)||null)}),await v();const R=o(f);e("reset",R),d&&await u()}function B(){return r(F)?o(f):{}}async function G(k){const d=r(y).map(N=>Se(N.field)?N.field[0]:N.field).filter(Boolean);Object.keys(k).forEach(N=>{const R=k[N];d.includes(N)&&(f[N]=De(R)?je(f[N],R):R)})}return{handleSubmit:u,validate:m,resetFields:I,getFieldsValue:B,clearValidate:v,setFieldsValue:G}}function qt({defaultFormModel:e,getSchema:b,formModel:f}){function y(V){if(!ht(V))return{};const o={};for(const m of Object.entries(V)){let[,u]=m;const[v]=m;!v||ke(u)&&u.length===0||H(u)||ge(u)||(Ne(u)&&(u=u.trim()),W(o,v,u))}return o}function F(){const V=r(b),o={},m=u=>{u.forEach(v=>{const{defaultValue:I,childrens:B}=v;ge(I)||(W(o,v.field,I),W(f,v.field,I)),B&&B?.length>0&&m(B)})};m(V),e.value=o}return{handleFormValues:y,initDefault:F}}const Jt={model:{type:Object,default:{}},disabled:_.bool.def(!1),require:_.bool.def(!1),rulesMessageJoinLabel:_.bool.def(!0),labelWidth:_.stringNumber.def(80),schemas:{type:[Array],default:()=>[]},inline:_.bool.def(!1),size:_.string.def("medium"),labelPlacement:_.string,isFull:_.bool.def(!0),showActionButtonGroup:_.bool.def(!0),showResetButton:_.bool.def(!0),resetButtonOptions:Object,showSubmitButton:_.bool.def(!0),submitButtonOptions:Object,showAdvancedButton:_.bool.def(!0),submitButtonText:_.string,resetButtonText:_.string,gridProps:Object,giProps:Object,formItemProps:Object,baseGridStyle:Object,collapsed:_.bool.def(!1),collapsedRows:_.number.def(1)},p=new Map;p.set("NInput",Oe);p.set("NDynamicInput",Te);p.set("NInputGroup",ye);p.set("NInputGroupLabel",$e);p.set("NInputNumber",Ue);p.set("NAutoComplete",Ae);p.set("NSelect",Le);p.set("NSwitch",Ge);p.set("NCascader",ze);p.set("NSlider",Ee);p.set("NRate",qe);p.set("NTransfer",Je);p.set("NTreeSelect",We);p.set("NDatePicker",He);p.set("NTimePicker",Qe);p.set("NColorPicker",Ke);p.set("NUpload",Xe);p.set("NDivider",Ye);const Wt=Ze({name:"BasicForm",props:{...Jt},emits:["reset","submit","register"],setup(e,{emit:b,attrs:f}){const{t:y}=vt(),{smaller:F,sizeEnum:V}=Vt(),o=A({}),m=xe({}),u=A({}),v=A(null),I=A(null),B=A(!1),G=A(!1),k=et(()=>F(V.MD).value?"top":"left"),d=O(()=>{const n=Object.assign({},e,r(u)),a={rules:{}};return(n.schemas||[]).forEach(P=>{const M=Be(P);W(a.rules,P.field,M)}),{...n,...r(a)}}),N=O(()=>{const{schemas:n}=r(d);return{schemas:n,model:r(m)}});function R(n){if(ke(n))return n.join(".");if(Ne(n))return n}function j(n){const{rulesMessageJoinLabel:a,label:c,component:P}=n,{rulesMessageJoinLabel:M}=e,w=Reflect.has(n,"rulesMessageJoinLabel")?a:M;return`${Gt(P)}${w?c??"":""}`}function E(n){const{component:a}=n;let c;switch(a){case"NInputTextarea":c="NInput";break;case"NInputPassword":c="NInput";break;case"NDateRangePicker":c="NDatePicker";break;case"NDatetimeRangePicker":c="NDatePicker";break;default:c=a}return p.get(c)}function Y(n){const{component:a,componentProps:c}=n;let P={};switch(a){case null:case void 0:break;case"NInputTextarea":P={type:"textarea"};break;case"NInputPassword":P={type:"password"};break;case"NDateRangePicker":P={type:"daterange"};break;case"NDatetimeRangePicker":P={type:"datetimerange"};break}const M=c??{};return{clearable:!0,placeholder:j(n),disabled:Q(n),...P,...M}}function Q(n){const{disabled:a}=n,{disabled:c}=r(d);return H(a)?a(N.value):a??c??!1}function Z(n){const{show:a=!0}=n;return H(a)?a(N.value):a}const x=O(()=>Object.assign({size:e.size,type:"default"},u.value.resetButtonOptions)),ee=O(()=>Object.assign({size:e.size,type:"primary"},u.value.submitButtonOptions)),t=O(()=>r(d).inline),s=O(()=>{const{gridProps:n}=r(d);return{responsive:"screen",collapsed:t.value?B.value:!1,cols:1,...n}});function te(n){const{giProps:a}=n,{giProps:c}=r(d);return{span:1,...c,...a}}const Pe=O(()=>{const{labelPlacement:n,...a}=r(d);return{...f,...e,...a,labelPlacement:n??k.value}}),K=O(()=>{const n=r(v)||r(d).schemas;for(const a of n){const{defaultValue:c,bindVal:P="value",bindUpdateVal:M="update:value"}=a;a.bindVal=P,a.bindUpdateVal=M,c&&(a.defaultValue=c)}return n}),{handleFormValues:he,initDefault:se}=qt({defaultFormModel:o,getSchema:K,formModel:m}),{handleSubmit:ae,validate:ve,resetFields:re,getFieldsValue:we,clearValidate:Ce,setFieldsValue:le}=Et({emit:b,getProps:d,formModel:m,getSchema:K,formElRef:I,defaultFormModel:o,handleFormValues:he});function Fe(){B.value=!B.value}async function Ie(n){u.value=Ft(r(u)||{},n)}function Be(n){const{rules:a=[],show:c,required:P,component:M}=n;let w=tt(a);const ie=["blur","input"],ue=j(n);function Ve(h,C){const X=h.message||ue;return C===void 0||Ct(C)||Array.isArray(C)&&C.length===0||typeof C=="string"&&C.trim()===""||typeof C=="object"&&Reflect.has(C,"checked")&&Reflect.has(C,"halfChecked")&&Array.isArray(C.checked)&&Array.isArray(C.halfChecked)&&C.checked.length===0&&C.halfChecked.length===0?Promise.reject(X):Promise.resolve()}(!w||w.length===0)&&P&&(w=[{required:P,validator:Ve,trigger:ie}]);const ce=w.findIndex(h=>Reflect.has(h,"required")&&!Reflect.has(h,"validator"));if(ce!==-1){const h=w[ce];wt(c)&&!c&&(h.required=!1),M&&(Reflect.has(h,"type")||zt(h,M),h.message=h.message||ue,h.trigger=ie,M.includes("NInput")&&(h.whitespace=!0))}const q=w.findIndex(h=>h.max);return q!==-1&&!w[q].validator&&(w[q].message=w[q].message||y("component.form.maxTip",[w[q].max])),w}const Me={getFieldsValue:we,setFieldsValue:le,resetFields:re,validate:ve,clearValidate:Ce,setProps:Ie,submit:ae};return oe(()=>K.value,n=>{r(G)||n?.length&&(se(),G.value=!0)}),oe(()=>r(d).model,n=>{n&&le(n)},{immediate:!0}),nt(()=>{se(),b("register",Me)}),{t:y,get:_e,set:W,formElRef:I,formModel:m,getGrid:s,getGridItem:te,getProps:d,getShow:Z,getFormItemPath:R,getBindValue:Pe,getSchema:K,getSubmitBtnOptions:ee,getResetBtnOptions:x,handleSubmit:ae,resetFields:re,isInline:t,getComponentProps:Y,getComp:E,unfoldToggle:Fe,componentMap:p}}});function Ht(e,b,f,y,F,V){const o=at,m=Pt,u=rt,v=lt,I=it,B=ut,G=ct,k=dt,d=pt,N=ye,R=ft,j=mt,E=gt,Y=Lt,Q=bt,Z=Ot,x=_t,ee=yt;return l(),g(ee,L(e.getBindValue,{ref:"formElRef",model:e.formModel,class:"mt-2"}),{default:i(()=>[T(x,ne(de(e.getGrid)),{default:i(()=>[(l(!0),U(z,null,J(e.getSchema,t=>(l(),U(z,{key:t.field},[e.getShow(t)?(l(),g(j,ne(L({key:0},e.getGridItem(t))),{default:i(()=>[T(R,L({label:t.label,path:e.getFormItemPath(t.field)},t.formItemProps),ot({default:i(()=>[t.slot?pe(e.$slots,t.slot,{key:0,model:e.formModel,field:t.field,value:e.get(e.formModel,t.field)},void 0,!0):t.component==="NCheckbox"?(l(),g(B,{key:1,value:e.formModel[t.field],"onUpdate:value":s=>e.formModel[t.field]=s},{default:i(()=>[T(I,null,{default:i(()=>[(l(!0),U(z,null,J(t?.componentProps?.options,s=>(l(),g(v,{key:s.value,value:s.value,label:s.label},null,8,["value","label"]))),128))]),_:2},1024)]),_:2},1032,["value","onUpdate:value"])):t.component==="NRadioGroup"?(l(),g(k,{key:2,value:e.formModel[t.field],"onUpdate:value":s=>e.formModel[t.field]=s},{default:i(()=>[T(I,ne(de(t?.componentProps?.spaceProps)),{default:i(()=>[(l(!0),U(z,null,J(t?.componentProps?.options,s=>(l(),g(G,{key:s.value,value:s.value},{default:i(()=>[S(D(s.label),1)]),_:2},1032,["value"]))),128))]),_:2},1040)]),_:2},1032,["value","onUpdate:value"])):t.component==="NRadioButtonGroup"?(l(),g(k,{key:3,value:e.formModel[t.field],"onUpdate:value":s=>e.formModel[t.field]=s},{default:i(()=>[(l(!0),U(z,null,J(t?.componentProps?.options,s=>(l(),g(d,{key:s.value,value:s.value},{default:i(()=>[S(D(s.label),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value"])):t.component==="NInputGroup"?(l(),g(N,{key:4},{default:i(()=>[(l(!0),U(z,null,J(t.childrens,s=>(l(),g(fe(e.getComp(s)),L({key:s.filed},e.getComponentProps(s),{value:e.get(e.formModel,s.field??t.field),class:{isFull:(s.isFull??t.isFull)!=!1&&e.getProps.isFull},"onUpdate:value":te=>e.set(e.formModel,s.field??t.field,te)}),{default:i(()=>[S(D(s?.defaultSlot),1)]),_:2},1040,["value","class","onUpdate:value"]))),128))]),_:2},1024)):(l(),g(fe(e.getComp(t)),L({key:5},e.getComponentProps(t),{[t.bindVal||""]:e.get(e.formModel,t.field),class:{isFull:t.isFull!=!1&&e.getProps.isFull}},{[st(t.bindUpdateVal)]:s=>e.set(e.formModel,t.field,s)}),null,16,["class"])),t.suffix?pe(e.$slots,t.suffix,{key:6,model:e.formModel,field:t.field,value:e.get(e.formModel,t.field)},void 0,!0):$("",!0)]),_:2},[t.subLabel||t.labelMessage?{name:"label",fn:i(()=>[S(D(t.label)+" ",1),t.subLabel?(l(),g(o,{key:0,depth:3,class:"mr-2"},{default:i(()=>[S(D(t.subLabel),1)]),_:2},1024)):$("",!0),t.labelMessage?(l(),g(u,{key:1,trigger:"hover",style:me(t.labelMessageStyle)},{trigger:i(()=>[T(m,{class:"text-18px cursor-pointer text-$app-text-color-3"})]),default:i(()=>[S(" "+D(t.labelMessage),1)]),_:2},1032,["style"])):$("",!0)]),key:"0"}:void 0]),1040,["label","path"])]),_:2},1040)):$("",!0)],64))),128)),e.getProps.showActionButtonGroup?(l(),g(j,{key:0,span:e.isInline?"":24,suffix:!!e.isInline},{default:i(({overflow:t})=>[T(I,{align:"center",justify:e.isInline?"end":"start",style:me({"margin-left":`${e.isInline?12:e.getProps.labelWidth}px`,"margin-bottom":"24px"})},{default:i(()=>[e.getProps.showSubmitButton?(l(),g(E,L({key:0},e.getSubmitBtnOptions,{onClick:e.handleSubmit}),{default:i(()=>[S(D(e.getProps.submitButtonText??e.t("common.queryText")),1)]),_:1},16,["onClick"])):$("",!0),e.getProps.showResetButton?(l(),g(E,L({key:1},e.getResetBtnOptions,{onClick:e.resetFields}),{default:i(()=>[S(D(e.getProps.resetButtonText??e.t("common.resetText")),1)]),_:1},16,["onClick"])):$("",!0),e.isInline&&e.getProps.showAdvancedButton?(l(),g(E,{key:2,type:"primary",text:"","icon-placement":"right",onClick:e.unfoldToggle},{icon:i(()=>[t?(l(),g(Q,{key:0,size:"14",class:"unfold-icon"},{default:i(()=>[T(Y)]),_:1})):(l(),g(Q,{key:1,size:"14",class:"unfold-icon"},{default:i(()=>[T(Z)]),_:1}))]),default:i(()=>[S(" "+D(t?"展开":"收起"),1)]),_:2},1032,["onClick"])):$("",!0)]),_:2},1032,["justify","style"])]),_:1},8,["span","suffix"])):$("",!0)]),_:3},16)]),_:3},16,["model"])}const xt=It(Wt,[["render",Ht],["__scopeId","data-v-99776a72"]]);function en(e){const b=A(null),f=A(!1);async function y(){const o=r(b);return o||console.error("The form instance has not been obtained, please make sure that the form has been rendered when performing the form operation!"),await Nt(),o}function F(o){kt(()=>{b.value=null,f.value=null}),!(r(f)&&Bt()&&o===r(b))&&(b.value=o,f.value=!0,oe(()=>e,()=>{e&&o.setProps(Mt(e))},{immediate:!0,deep:!0}))}return[F,{setProps:async o=>{await(await y()).setProps(o)},resetFields:async()=>{y().then(async o=>{await o.resetFields()})},clearValidate:async o=>{await(await y()).clearValidate(o)},getFieldsValue:()=>r(b)?.getFieldsValue(),setFieldsValue:async o=>{await(await y()).setFieldsValue(o)},submit:async()=>(await y()).submit(),validate:async o=>(await y()).validate(o)}]}export{xt as _,en as u};
